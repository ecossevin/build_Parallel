SUBROUTINE APL_ARPEGE (YDMF_PHYS_BASE_STATE, YDMF_PHYS_NEXT_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDCPG_GPAR,  &
& YDCPG_PHY0, YDMF_PHYS, YDCPG_DYN0, YDMF_PHYS_SURF, YDCPG_SL2, YDVARS, YDMODEL, YDDDH)
  
  !**** *APL_ARPEGE*  - Call ARPEGE physics
  
  !     Author.
  !     -------
  !      Philippe Marguinaud *METEO-FRANCE*
  !      Original : 28-04-2021
  
  !     Modifications.
  !     --------------
  !     13-Jul-2022 R. El Khatib Fix initialization of ZQGM
  ! End Modifications
  !-------------------------------------------------------------------------------
  
  USE GEOMETRY_MOD, ONLY: GEOMETRY
  USE MF_PHYS_TYPE_MOD, ONLY: MF_PHYS_TYPE
  USE CPG_TYPE_MOD, ONLY: CPG_MISC_TYPE, CPG_DYN_TYPE, CPG_GPAR_TYPE, CPG_PHY_TYPE
  USE CPG_SL2_TYPE_MOD, ONLY: CPG_SL2_TYPE
  USE CPG_OPTS_TYPE_MOD, ONLY: CPG_BNDS_TYPE, CPG_OPTS_TYPE
  USE MF_PHYS_SURFACE_TYPE_MOD, ONLY: MF_PHYS_SURF_TYPE
  USE FIELD_VARIABLES_MOD, ONLY: FIELD_VARIABLES
  USE MF_PHYS_BASE_STATE_TYPE_MOD, ONLY: MF_PHYS_BASE_STATE_TYPE
  USE MF_PHYS_NEXT_STATE_TYPE_MOD, ONLY: MF_PHYS_NEXT_STATE_TYPE
  USE TYPE_MODEL, ONLY: MODEL
  
  USE PARKIND1, ONLY: JPIM, JPRB
  USE YOMHOOK, ONLY: LHOOK, DR_HOOK, JPHOOK
  USE DDH_MIX, ONLY: TYP_DDH
  
  IMPLICIT NONE
  
  TYPE(MF_PHYS_BASE_STATE_TYPE), INTENT(IN) :: YDMF_PHYS_BASE_STATE
  TYPE(MF_PHYS_NEXT_STATE_TYPE), INTENT(INOUT) :: YDMF_PHYS_NEXT_STATE
  TYPE(GEOMETRY), INTENT(IN) :: YDGEOMETRY
  TYPE(CPG_BNDS_TYPE), INTENT(IN) :: YDCPG_BNDS
  TYPE(CPG_OPTS_TYPE), INTENT(IN) :: YDCPG_OPTS
  TYPE(CPG_MISC_TYPE), INTENT(INOUT) :: YDCPG_MISC
  TYPE(CPG_GPAR_TYPE), INTENT(INOUT) :: YDCPG_GPAR
  TYPE(CPG_PHY_TYPE), INTENT(IN) :: YDCPG_PHY0
  TYPE(MF_PHYS_TYPE), INTENT(INOUT) :: YDMF_PHYS
  TYPE(CPG_DYN_TYPE), INTENT(IN) :: YDCPG_DYN0
  TYPE(MF_PHYS_SURF_TYPE), INTENT(INOUT) :: YDMF_PHYS_SURF
  TYPE(CPG_SL2_TYPE), INTENT(INOUT) :: YDCPG_SL2
  TYPE(FIELD_VARIABLES), INTENT(INOUT) :: YDVARS
  TYPE(MODEL), INTENT(IN) :: YDMODEL
  TYPE(TYP_DDH), INTENT(INOUT) :: YDDDH
  
#include "accldia.intfb.h"
#include "acclph.intfb.h"
#include "acdnshf.intfb.h"
#include "acdrag.intfb.h"
#include "acdrme.intfb.h"
#include "acevadcape.intfb.h"
#include "achmt.intfb.h"
#include "achmtls.intfb.h"
#include "acpluis.intfb.h"
#include "acsol.intfb.h"
#include "actqsat.intfb.h"
#include "acvisih.intfb.h"
#include "aplpar_init.intfb.h"
#include "checkmv.intfb.h"
#include "cpphinp.intfb.h"
#include "cpqsol.intfb.h"
#include "mf_phys_bayrad.intfb.h"
#include "mf_phys_corwat.intfb.h"
#include "mf_phys_cvv.intfb.h"
#include "mf_phys_fpl_part1.intfb.h"
#include "mf_phys_fpl_part2.intfb.h"
#include "mf_phys_mocon.intfb.h"
#include "mf_phys_precips.intfb.h"
#include "mf_phys_save_phsurf_part1.intfb.h"
#include "mf_phys_save_phsurf_part2.intfb.h"
#include "mf_phys_transfer.intfb.h"
#include "ppwetpoint.intfb.h"
#include "qngcor.intfb.h"
#include "aplpar_flexdia.intfb.h"
#include "apl_arpege_oceanic_fluxes.intfb.h"
#include "apl_wind_gust.intfb.h"
#include "apl_arpege_shallow_convection_and_turbulence.intfb.h"
#include "apl_arpege_albedo_computation.intfb.h"
#include "apl_arpege_aerosols_for_radiation.intfb.h"
#include "apl_arpege_cloudiness.intfb.h"
#include "apl_arpege_radiation.intfb.h"
#include "apl_arpege_soil_hydro.intfb.h"
#include "apl_arpege_surface.intfb.h"
#include "apl_arpege_deep_convection.intfb.h"
#include "apl_arpege_precipitation.intfb.h"
#include "apl_arpege_hydro_budget.intfb.h"
#include "apl_arpege_surface_update.intfb.h"
#include "apl_arpege_atmosphere_update.intfb.h"
#include "apl_arpege_init.intfb.h"
#include "apl_arpege_init_surfex.intfb.h"
#include "apl_arpege_dprecips.intfb.h"
  
  
  CLASS(FIELD_4RB), POINTER :: YL_ZDIFEXT
  REAL(KIND=JPRB), POINTER :: ZDIFEXT(:, :, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_INLAB_CVPP
  INTEGER(KIND=JPIM), POINTER :: INLAB_CVPP(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZXTROV
  REAL(KIND=JPRB), POINTER :: ZXTROV(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZXUROV
  REAL(KIND=JPRB), POINTER :: ZXUROV(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZMRIPP
  REAL(KIND=JPRB), POINTER :: ZMRIPP(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZKTROV
  REAL(KIND=JPRB), POINTER :: ZKTROV(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZKUROV
  REAL(KIND=JPRB), POINTER :: ZKUROV(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZNBVNO
  REAL(KIND=JPRB), POINTER :: ZNBVNO(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZKQROV
  REAL(KIND=JPRB), POINTER :: ZKQROV(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZKQLROV
  REAL(KIND=JPRB), POINTER :: ZKQLROV(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZNEBS
  REAL(KIND=JPRB), POINTER :: ZNEBS(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZQLIS
  REAL(KIND=JPRB), POINTER :: ZQLIS(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZNEBS0
  REAL(KIND=JPRB), POINTER :: ZNEBS0(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZQLIS0
  REAL(KIND=JPRB), POINTER :: ZQLIS0(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZNEBC0
  REAL(KIND=JPRB), POINTER :: ZNEBC0(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZNEBDIFF
  REAL(KIND=JPRB), POINTER :: ZNEBDIFF(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZNEBCH
  REAL(KIND=JPRB), POINTER :: ZNEBCH(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZUNEBH
  REAL(KIND=JPRB), POINTER :: ZUNEBH(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZFPCOR
  REAL(KIND=JPRB), POINTER :: ZFPCOR(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZPOID
  REAL(KIND=JPRB), POINTER :: ZPOID(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZQV
  REAL(KIND=JPRB), POINTER :: ZQV(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZQI
  REAL(KIND=JPRB), POINTER :: ZQI(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZQL
  REAL(KIND=JPRB), POINTER :: ZQL(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZQR
  REAL(KIND=JPRB), POINTER :: ZQR(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZQS
  REAL(KIND=JPRB), POINTER :: ZQS(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZTENHA
  REAL(KIND=JPRB), POINTER :: ZTENHA(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZTENQVA
  REAL(KIND=JPRB), POINTER :: ZTENQVA(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZCP
  REAL(KIND=JPRB), POINTER :: ZCP(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZFPLSL
  REAL(KIND=JPRB), POINTER :: ZFPLSL(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZFPLSN
  REAL(KIND=JPRB), POINTER :: ZFPLSN(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZSEDIQL
  REAL(KIND=JPRB), POINTER :: ZSEDIQL(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZSEDIQI
  REAL(KIND=JPRB), POINTER :: ZSEDIQI(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZDIFCVPPQ
  REAL(KIND=JPRB), POINTER :: ZDIFCVPPQ(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZDIFCVPPS
  REAL(KIND=JPRB), POINTER :: ZDIFCVPPS(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZDIFCVPPU
  REAL(KIND=JPRB), POINTER :: ZDIFCVPPU(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZDIFCVPPV
  REAL(KIND=JPRB), POINTER :: ZDIFCVPPV(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZEDMFQ
  REAL(KIND=JPRB), POINTER :: ZEDMFQ(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZEDMFS
  REAL(KIND=JPRB), POINTER :: ZEDMFS(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZEDMFU
  REAL(KIND=JPRB), POINTER :: ZEDMFU(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZEDMFV
  REAL(KIND=JPRB), POINTER :: ZEDMFV(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZMF_UP
  REAL(KIND=JPRB), POINTER :: ZMF_UP(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZCONDCVPPL
  REAL(KIND=JPRB), POINTER :: ZCONDCVPPL(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZCONDCVPPI
  REAL(KIND=JPRB), POINTER :: ZCONDCVPPI(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZPRODTH_CVPP
  REAL(KIND=JPRB), POINTER :: ZPRODTH_CVPP(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZDE2MR
  REAL(KIND=JPRB), POINTER :: ZDE2MR(:, :, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZXDROV
  REAL(KIND=JPRB), POINTER :: ZXDROV(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZXHROV
  REAL(KIND=JPRB), POINTER :: ZXHROV(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZUGST
  REAL(KIND=JPRB), POINTER :: ZUGST(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZVGST
  REAL(KIND=JPRB), POINTER :: ZVGST(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZCDROV
  REAL(KIND=JPRB), POINTER :: ZCDROV(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZCHROV
  REAL(KIND=JPRB), POINTER :: ZCHROV(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZDQSTS
  REAL(KIND=JPRB), POINTER :: ZDQSTS(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZGWDCS
  REAL(KIND=JPRB), POINTER :: ZGWDCS(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZHQ
  REAL(KIND=JPRB), POINTER :: ZHQ(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZHU
  REAL(KIND=JPRB), POINTER :: ZHU(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZHTR
  REAL(KIND=JPRB), POINTER :: ZHTR(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZRTI
  REAL(KIND=JPRB), POINTER :: ZRTI(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZDPHI
  REAL(KIND=JPRB), POINTER :: ZDPHI(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZPRS
  REAL(KIND=JPRB), POINTER :: ZPRS(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSTAB
  REAL(KIND=JPRB), POINTER :: ZSTAB(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZWFC
  REAL(KIND=JPRB), POINTER :: ZWFC(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZWPMX
  REAL(KIND=JPRB), POINTER :: ZWPMX(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZWLMX
  REAL(KIND=JPRB), POINTER :: ZWLMX(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZWSEQ
  REAL(KIND=JPRB), POINTER :: ZWSEQ(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZWSMX
  REAL(KIND=JPRB), POINTER :: ZWSMX(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZWWILT
  REAL(KIND=JPRB), POINTER :: ZWWILT(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZC3
  REAL(KIND=JPRB), POINTER :: ZC3(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZCG
  REAL(KIND=JPRB), POINTER :: ZCG(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZCN
  REAL(KIND=JPRB), POINTER :: ZCN(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZNEIJG
  REAL(KIND=JPRB), POINTER :: ZNEIJG(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZNEIJV
  REAL(KIND=JPRB), POINTER :: ZNEIJV(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZPCLS
  REAL(KIND=JPRB), POINTER :: ZPCLS(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZBLH
  REAL(KIND=JPRB), POINTER :: ZBLH(:, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZQO3
  REAL(KIND=JPRB), POINTER :: ZQO3(:, :, :)
  CLASS(FIELD_4RB), POINTER :: YL_ZAER
  REAL(KIND=JPRB), POINTER :: ZAER(:, :, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZAERINDS
  REAL(KIND=JPRB), POINTER :: ZAERINDS(:, :, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZDPHIV
  REAL(KIND=JPRB), POINTER :: ZDPHIV(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZDPHIT
  REAL(KIND=JPRB), POINTER :: ZDPHIT(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZTRSOD
  REAL(KIND=JPRB), POINTER :: ZTRSOD(:, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZCEMTR
  REAL(KIND=JPRB), POINTER :: ZCEMTR(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZCTRSO
  REAL(KIND=JPRB), POINTER :: ZCTRSO(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZALBD
  REAL(KIND=JPRB), POINTER :: ZALBD(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZALBP
  REAL(KIND=JPRB), POINTER :: ZALBP(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZSFSWDIR
  REAL(KIND=JPRB), POINTER :: ZSFSWDIR(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZSFSWDIF
  REAL(KIND=JPRB), POINTER :: ZSFSWDIF(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZTRSODIR
  REAL(KIND=JPRB), POINTER :: ZTRSODIR(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZTRSODIF
  REAL(KIND=JPRB), POINTER :: ZTRSODIF(:, :, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSUDU
  REAL(KIND=JPRB), POINTER :: ZSUDU(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZTHETAVS
  REAL(KIND=JPRB), POINTER :: ZTHETAVS(:, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZGEOSLC
  REAL(KIND=JPRB), POINTER :: ZGEOSLC(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZTENT
  REAL(KIND=JPRB), POINTER :: ZTENT(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZTHETAV
  REAL(KIND=JPRB), POINTER :: ZTHETAV(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZCOEFN
  REAL(KIND=JPRB), POINTER :: ZCOEFN(:, :, :)
  
  ! LOCAL ARRAYS FOR ACVPPKF
  CLASS(FIELD_3RB), POINTER :: YL_ZQLI_CVPP
  REAL(KIND=JPRB), POINTER :: ZQLI_CVPP(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZNEB_CVPP
  REAL(KIND=JPRB), POINTER :: ZNEB_CVPP(:, :, :)
  
  ! Implicit coupling coefficients
  CLASS(FIELD_3RB), POINTER :: YL_ZCFBTH
  REAL(KIND=JPRB), POINTER :: ZCFBTH(:, :, :)
  REAL(KIND=JPRB) :: ZDTMSE
  REAL(KIND=JPRB) :: ZRHGMT
  REAL(KIND=JPRB) :: ZSTATI
  CLASS(FIELD_3RB), POINTER :: YL_ZCFATH
  REAL(KIND=JPRB), POINTER :: ZCFATH(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZCFAU
  REAL(KIND=JPRB), POINTER :: ZCFAU(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZCFBU
  REAL(KIND=JPRB), POINTER :: ZCFBU(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZCFBV
  REAL(KIND=JPRB), POINTER :: ZCFBV(:, :, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSRAIN
  REAL(KIND=JPRB), POINTER :: ZSRAIN(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSSNOW
  REAL(KIND=JPRB), POINTER :: ZSSNOW(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSGROUPEL
  REAL(KIND=JPRB), POINTER :: ZSGROUPEL(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZTSN
  REAL(KIND=JPRB), POINTER :: ZTSN(:, :)
  
  !         ACFLUSO (ECUME) local variable
  CLASS(FIELD_2RB), POINTER :: YL_ZCE
  REAL(KIND=JPRB), POINTER :: ZCE(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZCEROV
  REAL(KIND=JPRB), POINTER :: ZCEROV(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZCRTI
  REAL(KIND=JPRB), POINTER :: ZCRTI(:, :)
  
  !        New ACDIFV1 local variable
  CLASS(FIELD_3RB), POINTER :: YL_ZXURO
  REAL(KIND=JPRB), POINTER :: ZXURO(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZXQRO
  REAL(KIND=JPRB), POINTER :: ZXQRO(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZXTRO
  REAL(KIND=JPRB), POINTER :: ZXTRO(:, :, :)
  
  !        New ACNORGWD local variables
  CLASS(FIELD_3RB), POINTER :: YL_ZFLX_LOTT_GWU
  REAL(KIND=JPRB), POINTER :: ZFLX_LOTT_GWU(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZFLX_LOTT_GWV
  REAL(KIND=JPRB), POINTER :: ZFLX_LOTT_GWV(:, :, :)
  
  !    TKE+ for ACCLDIA
  CLASS(FIELD_3RB), POINTER :: YL_ZTKE1
  REAL(KIND=JPRB), POINTER :: ZTKE1(:, :, :)
  
  !   For ACVISIH
  CLASS(FIELD_3RB), POINTER :: YL_ZQGM
  REAL(KIND=JPRB), POINTER :: ZQGM(:, :, :)
  
  
  !        New ARP_GROUND_PARAM local variable
  CLASS(FIELD_3RB), POINTER :: YL_ZALPHA1
  REAL(KIND=JPRB), POINTER :: ZALPHA1(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZCOEFA
  REAL(KIND=JPRB), POINTER :: ZCOEFA(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZLVT
  REAL(KIND=JPRB), POINTER :: ZLVT(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZQICE
  REAL(KIND=JPRB), POINTER :: ZQICE(:, :, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZDIFWQ
  REAL(KIND=JPRB), POINTER :: ZDIFWQ(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZDIFWS
  REAL(KIND=JPRB), POINTER :: ZDIFWS(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSC_FEVI
  REAL(KIND=JPRB), POINTER :: ZSC_FEVI(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSC_FEVN
  REAL(KIND=JPRB), POINTER :: ZSC_FEVN(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSC_FCLL
  REAL(KIND=JPRB), POINTER :: ZSC_FCLL(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSC_FCLN
  REAL(KIND=JPRB), POINTER :: ZSC_FCLN(:, :)
  
  !           TRAJECTORY (For diffusion !) local VARIABLES
  CLASS(FIELD_3RB), POINTER :: YL_ZTRAJGWD
  REAL(KIND=JPRB), POINTER :: ZTRAJGWD(:, :, :)
  
  CLASS(FIELD_2RB), POINTER :: YL_ZAIPCMT
  REAL(KIND=JPRB), POINTER :: ZAIPCMT(:, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZQIC
  REAL(KIND=JPRB), POINTER :: ZQIC(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZQLC
  REAL(KIND=JPRB), POINTER :: ZQLC(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZQLI_CVP
  REAL(KIND=JPRB), POINTER :: ZQLI_CVP(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZQC_DET_PCMT
  REAL(KIND=JPRB), POINTER :: ZQC_DET_PCMT(:, :, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZDCAPE
  REAL(KIND=JPRB), POINTER :: ZDCAPE(:, :)
  
  ! ACRANEB/ACRANEB2 local variables
  CLASS(FIELD_2RB), POINTER :: YL_ZDECRD
  REAL(KIND=JPRB), POINTER :: ZDECRD(:, :)
  
  ! Precipitation type diagnostics
  CLASS(FIELD_2RB), POINTER :: YL_IMOC_CLPH
  INTEGER(KIND=JPIM), POINTER :: IMOC_CLPH(:, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZBAY_QRCONV
  REAL(KIND=JPRB), POINTER :: ZBAY_QRCONV(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZBAY_QSCONV
  REAL(KIND=JPRB), POINTER :: ZBAY_QSCONV(:, :, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZDSA_C1
  REAL(KIND=JPRB), POINTER :: ZDSA_C1(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZDSA_C2
  REAL(KIND=JPRB), POINTER :: ZDSA_C2(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZDSA_CPS
  REAL(KIND=JPRB), POINTER :: ZDSA_CPS(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZDSA_LHS
  REAL(KIND=JPRB), POINTER :: ZDSA_LHS(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZDSA_RS
  REAL(KIND=JPRB), POINTER :: ZDSA_RS(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_CDN
  REAL(KIND=JPRB), POINTER :: ZFLU_CDN(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_CD
  REAL(KIND=JPRB), POINTER :: ZFLU_CD(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_CH
  REAL(KIND=JPRB), POINTER :: ZFLU_CH(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_EMIS
  REAL(KIND=JPRB), POINTER :: ZFLU_EMIS(:, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZFLU_FEVI
  REAL(KIND=JPRB), POINTER :: ZFLU_FEVI(:, :, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_NEIJ
  REAL(KIND=JPRB), POINTER :: ZFLU_NEIJ(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_QSATS
  REAL(KIND=JPRB), POINTER :: ZFLU_QSATS(:, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZFLU_QSAT
  REAL(KIND=JPRB), POINTER :: ZFLU_QSAT(:, :, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_VEG
  REAL(KIND=JPRB), POINTER :: ZFLU_VEG(:, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZMSC_FRMQ
  REAL(KIND=JPRB), POINTER :: ZMSC_FRMQ(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZMSC_LH
  REAL(KIND=JPRB), POINTER :: ZMSC_LH(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZMSC_LSCPE
  REAL(KIND=JPRB), POINTER :: ZMSC_LSCPE(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZMSC_QW
  REAL(KIND=JPRB), POINTER :: ZMSC_QW(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZMSC_TW
  REAL(KIND=JPRB), POINTER :: ZMSC_TW(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FEFB1
  REAL(KIND=JPRB), POINTER :: ZPFL_FEFB1(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FEFB2
  REAL(KIND=JPRB), POINTER :: ZPFL_FEFB2(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FEFB3
  REAL(KIND=JPRB), POINTER :: ZPFL_FEFB3(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FPLCH
  REAL(KIND=JPRB), POINTER :: ZPFL_FPLCH(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FPLSH
  REAL(KIND=JPRB), POINTER :: ZPFL_FPLSH(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FTKEI
  REAL(KIND=JPRB), POINTER :: ZPFL_FTKEI(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FTKE
  REAL(KIND=JPRB), POINTER :: ZPFL_FTKE(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZPRC_DPRECIPS2
  REAL(KIND=JPRB), POINTER :: ZPRC_DPRECIPS2(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZPRC_DPRECIPS
  REAL(KIND=JPRB), POINTER :: ZPRC_DPRECIPS(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZRDG_CVGQ
  REAL(KIND=JPRB), POINTER :: ZRDG_CVGQ(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZRDG_LCVQ
  REAL(KIND=JPRB), POINTER :: ZRDG_LCVQ(:, :, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZRDG_MU0LU
  REAL(KIND=JPRB), POINTER :: ZRDG_MU0LU(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZRDG_MU0M
  REAL(KIND=JPRB), POINTER :: ZRDG_MU0M(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZRDG_MU0N
  REAL(KIND=JPRB), POINTER :: ZRDG_MU0N(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZRDG_MU0
  REAL(KIND=JPRB), POINTER :: ZRDG_MU0(:, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZSAV_DDAL
  REAL(KIND=JPRB), POINTER :: ZSAV_DDAL(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZSAV_DDOM
  REAL(KIND=JPRB), POINTER :: ZSAV_DDOM(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZSAV_ENTCH
  REAL(KIND=JPRB), POINTER :: ZSAV_ENTCH(:, :, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_FHPS
  REAL(KIND=JPRB), POINTER :: ZSAV_FHPS(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_GZ0F
  REAL(KIND=JPRB), POINTER :: ZSAV_GZ0F(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_GZ0HF
  REAL(KIND=JPRB), POINTER :: ZSAV_GZ0HF(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_HV
  REAL(KIND=JPRB), POINTER :: ZSAV_HV(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_PBLH
  REAL(KIND=JPRB), POINTER :: ZSAV_PBLH(:, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_QSH
  REAL(KIND=JPRB), POINTER :: ZSAV_QSH(:, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZSAV_UDAL
  REAL(KIND=JPRB), POINTER :: ZSAV_UDAL(:, :, :)
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_UDGRO
  REAL(KIND=JPRB), POINTER :: ZSAV_UDGRO(:, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZSAV_UDOM
  REAL(KIND=JPRB), POINTER :: ZSAV_UDOM(:, :, :)
  CLASS(FIELD_3RB), POINTER :: YL_ZSAV_UNEBH
  REAL(KIND=JPRB), POINTER :: ZSAV_UNEBH(:, :, :)
  
  INTEGER(KIND=JPIM) :: INSTEP_DEB
  INTEGER(KIND=JPIM) :: INSTEP_FIN
  INTEGER(KIND=JPIM) :: JLEV
  INTEGER(KIND=JPIM) :: JLON
  INTEGER(KIND=JPIM) :: JSPP
  LOGICAL :: LLCLS
  LOGICAL :: LLHMT
  LOGICAL :: LLREDPR
  REAL(KIND=JPRB) :: ZEPS0
  REAL(KIND=JPRB) :: ZEPSNEB
  REAL(KIND=JPRB) :: ZRVMD
  
  REAL(KIND=JPHOOK) :: ZHOOK_HANDLE
  
  REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
  REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
  REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GEMU_T0(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GELAM_T0(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_Q_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_Q_DL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_Q_DM(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVGQ_DL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVGQ_DM(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_PHY0_XYB_RDELP(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_DYN0_CTY_EVEL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVGQ_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_T(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_Q(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_MISC_RH(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PARG(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PD2(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PIVEG(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PLAI(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PSAB(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CT(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_U(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_V(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_MISC_QS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_GZ0(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_GZ0H(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PHV(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_QCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_RHCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_TCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_UCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_NUCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_NVCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_UGST(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VGST(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CLPH(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VEIN(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DRNSHF(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_RCORI_T0(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PGETRL(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRDU(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRDV(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCSQL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCSQN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLSL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLSN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPSL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPSN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPSL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPSN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQ(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQ(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPCL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPCN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPCL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPCN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCCQL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCCQN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQNG(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRMH(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRMU(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRMV(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLCL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLCN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CAPE(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_OROG_T0(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_MISC_QLI(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_MISC_QICE(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VISICLD(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VISIHYD(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_MXCLWC(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_L(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_I(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_TPWCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEVL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEVN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PEVA(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PPCL(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PPCN(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PPSL(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PPSN(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_PHY0_PREHYD(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSP_RR_PT_T0(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_MISC_QSOL(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVV_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVV_T1(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_RCONV_T1(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_SCONV_T1(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2(:, :, :)
  TYPE(STACK) :: YLSTACK
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE', 0, ZHOOK_HANDLE)
  IF (LHOOK) CALL DR_HOOK('CREATE_TEMPORARIES', 0, ZHOOK_HANDLE_FIELD_API)
  CALL FIELD_NEW(YL_ZDIFEXT, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_GCONF%YGFL%NGFL_EXT /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_INLAB_CVPP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXTROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXUROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMRIPP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZKTROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZKUROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNBVNO, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZKQROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZKQLROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEBS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQLIS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEBS0, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQLIS0, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEBC0, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEBDIFF, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEBCH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZUNEBH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFPCOR, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPOID, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQR, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTENHA, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTENQVA, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFPLSL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFPLSN, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSEDIQL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSEDIQI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDIFCVPPQ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDIFCVPPS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDIFCVPPU, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDIFCVPPV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZEDMFQ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZEDMFS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZEDMFU, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZEDMFV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMF_UP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCONDCVPPL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCONDCVPPI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPRODTH_CVPP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDE2MR, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXDROV, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXHROV, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZUGST, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZVGST, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCDROV, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCHROV, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDQSTS, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZGWDCS, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZHQ, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZHU, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZHTR, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZRTI, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDPHI, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPRS, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSTAB, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZWFC, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZWPMX, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZWLMX, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZWSEQ, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZWSMX, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZWWILT, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZC3, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCG, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCN, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEIJG, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEIJV, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPCLS, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZBLH, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQO3, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZAER, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, 6 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZAERINDS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDPHIV, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDPHIT, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTRSOD, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCEMTR, UBOUNDS=(/ YDCPG_OPTS%KLON, 1 /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCTRSO, UBOUNDS=(/ YDCPG_OPTS%KLON, 1 /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZALBD, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KSW /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZALBP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KSW /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSFSWDIR, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KSW /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSFSWDIF, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KSW /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTRSODIR, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KSW /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTRSODIF, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KSW /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSUDU, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTHETAVS, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZGEOSLC, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTENT, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTHETAV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCOEFN, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQLI_CVPP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEB_CVPP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCFBTH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCFATH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCFAU, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCFBU, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCFBV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSRAIN, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSSNOW, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSGROUPEL, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTSN, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCE, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCEROV, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCRTI, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXURO, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXQRO, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXTRO, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLX_LOTT_GWU, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLX_LOTT_GWV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTKE1, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQGM, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZALPHA1, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCOEFA, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZLVT, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQICE, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDIFWQ, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDIFWS, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSC_FEVI, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSC_FEVN, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSC_FCLL, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSC_FCLN, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTRAJGWD, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZAIPCMT, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQIC, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQLC, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQLI_CVP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQC_DET_PCMT, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDCAPE, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDECRD, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_IMOC_CLPH, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZBAY_QRCONV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZBAY_QSCONV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDSA_C1, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDSA_C2, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDSA_CPS, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDSA_LHS, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDSA_RS, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_CDN, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_CD, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_CH, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_EMIS, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_FEVI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KTSSG + 1 /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_NEIJ, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_QSATS, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_QSAT, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_VEG, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMSC_FRMQ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMSC_LH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMSC_LSCPE, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMSC_QW, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMSC_TW, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FEFB1, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FEFB2, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FEFB3, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FPLCH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FPLSH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FTKEI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FTKE, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPRC_DPRECIPS2, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%NDTPREC2 /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPRC_DPRECIPS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%NDTPREC /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZRDG_CVGQ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZRDG_LCVQ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZRDG_MU0LU, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZRDG_MU0M, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZRDG_MU0N, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZRDG_MU0, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_DDAL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_DDOM, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_ENTCH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_FHPS, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_GZ0F, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_GZ0HF, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_HV, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_PBLH, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_QSH, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_UDAL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_UDGRO, UBOUNDS=(/ YDCPG_OPTS%KLON /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_UDOM, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_UNEBH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG /), LBOUNDS=(/ 0, 1 /), PERSISTENT=.true.)
  IF (LHOOK) CALL DR_HOOK('CREATE_TEMPORARIES', 1, ZHOOK_HANDLE_FIELD_API)
  
  
  
  
  
  INSTEP_DEB = 1
  INSTEP_FIN = 1
  
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:CPPHINP')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%F_T0)
    Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%F_T0)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR(YDVARS%U%F_T0)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR(YDVARS%V%F_T0)
    Z_YDVARS_Q_T0 => GET_HOST_DATA_RDWR(YDVARS%Q%F_T0)
    Z_YDVARS_Q_DL => GET_HOST_DATA_RDWR(YDVARS%Q%F_DL)
    Z_YDVARS_Q_DM => GET_HOST_DATA_RDWR(YDVARS%Q%F_DM)
    Z_YDVARS_CVGQ_DL => GET_HOST_DATA_RDWR(YDVARS%CVGQ%F_DL)
    Z_YDVARS_CVGQ_DM => GET_HOST_DATA_RDWR(YDVARS%CVGQ%F_DM)
    Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR(YDCPG_PHY0%XYB%F_RDELP)
    Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR(YDCPG_DYN0%CTY%F_EVEL)
    Z_YDVARS_CVGQ_T0 => GET_HOST_DATA_RDWR(YDVARS%CVGQ%F_T0)
    ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
    ZRDG_MU0LU => GET_HOST_DATA_RDWR(YL_ZRDG_MU0LU)
    ZRDG_MU0M => GET_HOST_DATA_RDWR(YL_ZRDG_MU0M)
    ZRDG_MU0N => GET_HOST_DATA_RDWR(YL_ZRDG_MU0N)
    ZRDG_CVGQ => GET_HOST_DATA_RDWR(YL_ZRDG_CVGQ)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL CPPHINP(YDGEOMETRY, YDMODEL, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK),  &
      & Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_U_T0(:, :, JBLK), Z_YDVARS_V_T0(:, :, JBLK), Z_YDVARS_Q_T0(:, :, JBLK),  &
      & Z_YDVARS_Q_DL(:, :, JBLK), Z_YDVARS_Q_DM(:, :, JBLK), Z_YDVARS_CVGQ_DL(:, :, JBLK), Z_YDVARS_CVGQ_DM(:, :, JBLK),  &
      & Z_YDCPG_PHY0_XYB_RDELP(:, :, JBLK), Z_YDCPG_DYN0_CTY_EVEL(:, :, JBLK), Z_YDVARS_CVGQ_T0(:, :, JBLK),  &
      & YL_ZRDG_MU0(:, JBLK), YL_ZRDG_MU0LU(:, JBLK), YL_ZRDG_MU0M(:, JBLK), YL_ZRDG_MU0N(:, JBLK), ZRDG_CVGQ)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:CPPHINP')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%F_T0)
      Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%F_T0)
      Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR(YDVARS%U%F_T0)
      Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR(YDVARS%V%F_T0)
      Z_YDVARS_Q_T0 => GET_HOST_DATA_RDWR(YDVARS%Q%F_T0)
      Z_YDVARS_Q_DL => GET_HOST_DATA_RDWR(YDVARS%Q%F_DL)
      Z_YDVARS_Q_DM => GET_HOST_DATA_RDWR(YDVARS%Q%F_DM)
      Z_YDVARS_CVGQ_DL => GET_HOST_DATA_RDWR(YDVARS%CVGQ%F_DL)
      Z_YDVARS_CVGQ_DM => GET_HOST_DATA_RDWR(YDVARS%CVGQ%F_DM)
      Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR(YDCPG_PHY0%XYB%F_RDELP)
      Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR(YDCPG_DYN0%CTY%F_EVEL)
      Z_YDVARS_CVGQ_T0 => GET_HOST_DATA_RDWR(YDVARS%CVGQ%F_T0)
      ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
      ZRDG_MU0LU => GET_HOST_DATA_RDWR(YL_ZRDG_MU0LU)
      ZRDG_MU0M => GET_HOST_DATA_RDWR(YL_ZRDG_MU0M)
      ZRDG_MU0N => GET_HOST_DATA_RDWR(YL_ZRDG_MU0N)
      ZRDG_CVGQ => GET_HOST_DATA_RDWR(YL_ZRDG_CVGQ)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDVARS_GEOMETRY_GEMU_T0 => NULL()
    Z_YDVARS_GEOMETRY_GELAM_T0 => NULL()
    Z_YDVARS_U_T0 => NULL()
    Z_YDVARS_V_T0 => NULL()
    Z_YDVARS_Q_T0 => NULL()
    Z_YDVARS_Q_DL => NULL()
    Z_YDVARS_Q_DM => NULL()
    Z_YDVARS_CVGQ_DL => NULL()
    Z_YDVARS_CVGQ_DM => NULL()
    Z_YDCPG_PHY0_XYB_RDELP => NULL()
    Z_YDCPG_DYN0_CTY_EVEL => NULL()
    Z_YDVARS_CVGQ_T0 => NULL()
    ZRDG_MU0 => NULL()
    ZRDG_MU0LU => NULL()
    ZRDG_MU0M => NULL()
    ZRDG_MU0N => NULL()
    ZRDG_CVGQ => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  
  
  <PragmaRegion::>
    
    DO JLEV=1,YDCPG_OPTS%KFLEVG
      DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
        ZRDG_LCVQ(JLON, JLEV) = ZRDG_CVGQ(JLON, JLEV)
      END DO
    END DO
    
    DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
      ZFLU_QSATS(JLON) = 0.0_JPRB
    END DO
    
  
  CALL MF_PHYS_FPL_PART1(YDCPG_BNDS, YDCPG_OPTS, ZPFL_FPLCH, ZPFL_FPLSH, YDVARS%CPF%T0, YDVARS%SPF%T0, YDMODEL)
  
  IF (YDCPG_OPTS%LCONFX) THEN
    
    CALL MF_PHYS_SAVE_PHSURF_PART1(YDCPG_BNDS, YDCPG_OPTS, ZSAV_DDAL, ZSAV_DDOM, ZSAV_ENTCH, ZSAV_FHPS, ZSAV_GZ0F, ZSAV_GZ0HF,  &
    & ZSAV_HV, ZSAV_PBLH, ZSAV_QSH, ZSAV_UDAL, ZSAV_UDGRO, ZSAV_UDOM, ZSAV_UNEBH, YDMF_PHYS_SURF%GSD_VF%PZ0F,  &
    & YDMF_PHYS_SURF%GSD_VH%PPBLH, YDMF_PHYS_SURF%GSD_VH%PQSH, YDMF_PHYS_SURF%GSD_VH%PSPSH, YDMF_PHYS_SURF%GSD_VK%PUDGRO,  &
    & YDMF_PHYS_SURF%GSD_VV%PHV, YDMF_PHYS_SURF%GSD_VV%PZ0H, YDVARS%DAL%T0, YDVARS%DOM%T0, YDVARS%UAL%T0, YDVARS%UEN%T0,  &
    & YDVARS%UNEBH%T0, YDVARS%UOM%T0, YDMODEL)
    
  END IF
  
  
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:APLPAR_INIT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
    ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
    ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
    ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
    ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
    ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
    ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
    ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
    ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
    ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
    ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
    ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
    ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
    ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
    ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
    ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
    ZFLU_FEVI => GET_HOST_DATA_RDWR(YL_ZFLU_FEVI)
    ZPFL_FTKE => GET_HOST_DATA_RDWR(YL_ZPFL_FTKE)
    ZPFL_FTKEI => GET_HOST_DATA_RDWR(YL_ZPFL_FTKEI)
    ZPFL_FEFB1 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB1)
    ZPFL_FEFB2 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB2)
    ZPFL_FEFB3 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB3)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
    ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
    ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
    IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL APLPAR_INIT(YDCPG_OPTS%LAROME, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG,  &
      & YDMODEL%YRML_PHY_G%YRDPHY%NTSSG, YDCPG_OPTS%YRSURF_DIMS%YSP_SBD%NLEVS, Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK),  &
      & YL_ZMSC_FRMQ(:, :, JBLK), YL_ZDSA_CPS(:, JBLK), YL_ZDSA_LHS(:, JBLK), YL_ZDSA_RS(:, JBLK), YL_ZMSC_LH(:, :, JBLK),  &
      & YL_ZMSC_LSCPE(:, :, JBLK), YL_ZFLU_QSAT(:, :, JBLK), YL_ZMSC_QW(:, :, JBLK), YL_ZMSC_TW(:, :, JBLK),  &
      & YL_ZFLU_CD(:, JBLK), YL_ZFLU_CDN(:, JBLK), YL_ZFLU_CH(:, JBLK), YL_ZDSA_C1(:, JBLK), YL_ZDSA_C2(:, JBLK),  &
      & YL_ZFLU_EMIS(:, JBLK), YL_ZFLU_FEVI(:, :, JBLK), YL_ZPFL_FTKE(:, :, JBLK), YL_ZPFL_FTKEI(:, :, JBLK),  &
      & YL_ZPFL_FEFB1(:, :, JBLK), YL_ZPFL_FEFB2(:, :, JBLK), YL_ZPFL_FEFB3(:, :, JBLK), YL_ZFLU_NEIJ(:, JBLK),  &
      & YL_ZFLU_VEG(:, JBLK), YL_ZFLU_QSATS(:, JBLK), IMOC_CLPH)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:APLPAR_INIT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
      ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
      ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
      ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
      ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
      ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
      ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
      ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
      ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
      ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
      ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
      ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
      ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
      ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
      ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
      ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
      ZFLU_FEVI => GET_HOST_DATA_RDWR(YL_ZFLU_FEVI)
      ZPFL_FTKE => GET_HOST_DATA_RDWR(YL_ZPFL_FTKE)
      ZPFL_FTKEI => GET_HOST_DATA_RDWR(YL_ZPFL_FTKEI)
      ZPFL_FEFB1 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB1)
      ZPFL_FEFB2 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB2)
      ZPFL_FEFB3 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB3)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
      ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
      ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
      IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL()
    ZMSC_FRMQ => NULL()
    ZDSA_CPS => NULL()
    ZDSA_LHS => NULL()
    ZDSA_RS => NULL()
    ZMSC_LH => NULL()
    ZMSC_LSCPE => NULL()
    ZFLU_QSAT => NULL()
    ZMSC_QW => NULL()
    ZMSC_TW => NULL()
    ZFLU_CD => NULL()
    ZFLU_CDN => NULL()
    ZFLU_CH => NULL()
    ZDSA_C1 => NULL()
    ZDSA_C2 => NULL()
    ZFLU_EMIS => NULL()
    ZFLU_FEVI => NULL()
    ZPFL_FTKE => NULL()
    ZPFL_FTKEI => NULL()
    ZPFL_FEFB1 => NULL()
    ZPFL_FEFB2 => NULL()
    ZPFL_FEFB3 => NULL()
    ZFLU_NEIJ => NULL()
    ZFLU_VEG => NULL()
    ZFLU_QSATS => NULL()
    IMOC_CLPH => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  
  
  <PragmaRegion::>
    
    DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
      YDMF_PHYS_SURF%GSD_VF%PLSM(JLON) = REAL(NINT(YDMF_PHYS_SURF%GSD_VF%PLSM(JLON)), kind=JPRB)
    END DO
    
  
  ! Check magnitude of model variables.
  
  
  IF (YDMODEL%YRML_PHY_MF%YRPHY%LGCHECKMV) THEN
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:CHECKMV')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%F_T0)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%F_T0)
      ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL CHECKMV(YDCPG_OPTS%NINDAT, YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP, YDMODEL%YRML_PHY_MF%YRPHY0,  &
        & YDMODEL%YRML_PHY_MF%YRPHY2, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%NSTEP,  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK), YL_ZRDG_MU0(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(:, :, JBLK),  &
        & YDMF_PHYS_BASE_STATE%YGSP_RR%T)
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:CHECKMV')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%F_T0)
        Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%F_T0)
        ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDVARS_GEOMETRY_GELAM_T0 => NULL()
      Z_YDVARS_GEOMETRY_GEMU_T0 => NULL()
      ZRDG_MU0 => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_Q => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    
  END IF
  
  
  
  LLREDPR = .false.
  ZRVMD = YDMODEL%YRCST%RV - YDMODEL%YRCST%RD
  
  IF (YDCPG_OPTS%LCONFX) THEN
    ZDTMSE = 0.01_JPRB
    ZSTATI = YDMODEL%YRML_GCONF%YRRIP%RSTATI - ZDTMSE / 2._JPRB
  ELSE
    ZDTMSE = YDMODEL%YRML_PHY_MF%YRPHY2%TSPHY
    ZSTATI = YDMODEL%YRML_GCONF%YRRIP%RSTATI
  END IF
  ZRHGMT = REAL(YDMODEL%YRML_GCONF%YRRIP%RHGMT, kind=JPRB)
  
  
  CALL APL_ARPEGE_INIT(YDMODEL%YRCST, YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDMF_PHYS, YDMF_PHYS_SURF,  &
  & YDVARS, YDMODEL, IMOC_CLPH, INLAB_CVPP, ZAER, ZAERINDS, ZAIPCMT, ZALBD, ZALBP, ZALPHA1, ZCEMTR, ZCFATH, ZCFAU, ZCFBTH,  &
  & ZCFBU, ZCFBV, ZCOEFA, ZCONDCVPPI, ZCONDCVPPL, ZCTRSO, ZDECRD, ZDIFCVPPQ, ZDIFCVPPS, ZDIFCVPPU, ZDIFCVPPV, ZDIFWQ, ZDIFWS,  &
  & ZEDMFQ, ZEDMFS, ZEDMFU, ZEDMFV, ZEPS0, ZEPSNEB, ZFPCOR, ZKQLROV, ZKQROV, ZKTROV, ZKUROV, ZLVT, ZMF_UP, ZMRIPP, ZNEBC0,  &
  & ZNEBCH, ZNEBDIFF, ZNEBS, ZNEBS0, ZNEB_CVPP, ZPFL_FPLCH, ZPFL_FPLSH, ZPOID, ZPRODTH_CVPP, ZQC_DET_PCMT, ZQI, ZQIC, ZQICE,  &
  & ZQL, ZQLC, ZQLIS, ZQLIS0, ZQLI_CVP, ZQLI_CVPP, ZQO3, ZQR, ZQS, ZQV, ZSC_FCLL, ZSC_FCLN, ZSC_FEVI, ZSC_FEVN, ZSEDIQI,  &
  & ZSEDIQL, ZSFSWDIF, ZSFSWDIR, ZSUDU, ZTENHA, ZTENQVA, ZTENT, ZTRSOD, ZTRSODIF, ZTRSODIR, ZUNEBH, ZXDROV, ZXHROV, ZXQRO,  &
  & ZXTRO, ZXTROV, ZXURO, ZXUROV)
  
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACTQSAT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    ZGEOSLC => GET_HOST_DATA_RDWR(YL_ZGEOSLC)
    ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
    ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
    ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
    ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
    Z_YDCPG_MISC_RH => GET_HOST_DATA_RDWR(YDCPG_MISC%F_RH)
    ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL ACTQSAT(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
      & YDMODEL%YRML_PHY_MF%YRTOPH%NTQSAT, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK), YL_ZQV(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK),  &
      & YL_ZGEOSLC(:, :, JBLK), YL_ZMSC_LH(:, :, JBLK), YL_ZMSC_LSCPE(:, :, JBLK), YL_ZFLU_QSAT(:, :, JBLK),  &
      & YL_ZMSC_QW(:, :, JBLK), Z_YDCPG_MISC_RH(:, :, JBLK), ZMSC_TW)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACTQSAT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      ZGEOSLC => GET_HOST_DATA_RDWR(YL_ZGEOSLC)
      ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
      ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
      ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
      ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
      Z_YDCPG_MISC_RH => GET_HOST_DATA_RDWR(YDCPG_MISC%F_RH)
      ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
    ZQV => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    ZGEOSLC => NULL()
    ZMSC_LH => NULL()
    ZMSC_LSCPE => NULL()
    ZFLU_QSAT => NULL()
    ZMSC_QW => NULL()
    Z_YDCPG_MISC_RH => NULL()
    ZMSC_TW => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  
  
  
  IF (.not.YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN
    
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACSOL')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_ARG)
      Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_D2)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_IVEG)
      Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_LAI)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_A)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_R)
      Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_SAB)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
      ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
      ZC3 => GET_HOST_DATA_RDWR(YL_ZC3)
      ZCG => GET_HOST_DATA_RDWR(YL_ZCG)
      ZCN => GET_HOST_DATA_RDWR(YL_ZCN)
      Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CT)
      ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
      ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
      ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
      ZWPMX => GET_HOST_DATA_RDWR(YL_ZWPMX)
      ZWSEQ => GET_HOST_DATA_RDWR(YL_ZWSEQ)
      ZWSMX => GET_HOST_DATA_RDWR(YL_ZWSMX)
      ZWWILT => GET_HOST_DATA_RDWR(YL_ZWWILT)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL ACSOL(YDCPG_OPTS%YRCLI, YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY1, YDCPG_BNDS%KIDIA,  &
        & YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, Z_YDMF_PHYS_SURF_GSD_VV_PARG(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PD2(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PIVEG(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PLAI(:, JBLK),  &
        & YDMF_PHYS_BASE_STATE%YGSP_SG%A(:, 1), YDMF_PHYS_BASE_STATE%YGSP_SG%R(:, 1), Z_YDMF_PHYS_SURF_GSD_VV_PSAB(:, JBLK),  &
        & YDMF_PHYS_BASE_STATE%YGSP_SG%F(:, 1), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK), YDMF_PHYS_BASE_STATE%YGSP_SB%Q(:, 1), YDMF_PHYS_BASE_STATE%YGSP_SB%TL(:, 1),  &
        & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), LLHMT, YL_ZDSA_C1(:, JBLK),  &
        & YL_ZDSA_C2(:, JBLK), YL_ZC3(:, JBLK), YL_ZCG(:, JBLK), YL_ZCN(:, JBLK), Z_YDMF_PHYS_OUT_CT(:, JBLK),  &
        & YL_ZNEIJG(:, JBLK), YL_ZNEIJV(:, JBLK), YL_ZWFC(:, JBLK), YL_ZWPMX(:, JBLK), YL_ZWSEQ(:, JBLK), YL_ZWSMX(:, JBLK),  &
        & ZWWILT)
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACSOL')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_ARG)
        Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_D2)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
        Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_IVEG)
        Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_LAI)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_A)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_R)
        Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_SAB)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
        ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
        ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
        ZC3 => GET_HOST_DATA_RDWR(YL_ZC3)
        ZCG => GET_HOST_DATA_RDWR(YL_ZCG)
        ZCN => GET_HOST_DATA_RDWR(YL_ZCN)
        Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CT)
        ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
        ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
        ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
        ZWPMX => GET_HOST_DATA_RDWR(YL_ZWPMX)
        ZWSEQ => GET_HOST_DATA_RDWR(YL_ZWSEQ)
        ZWSMX => GET_HOST_DATA_RDWR(YL_ZWSMX)
        ZWWILT => GET_HOST_DATA_RDWR(YL_ZWWILT)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_VV_PARG => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PD2 => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PLAI => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PSAB => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL()
      ZDSA_C1 => NULL()
      ZDSA_C2 => NULL()
      ZC3 => NULL()
      ZCG => NULL()
      ZCN => NULL()
      Z_YDMF_PHYS_OUT_CT => NULL()
      ZNEIJG => NULL()
      ZNEIJV => NULL()
      ZWFC => NULL()
      ZWPMX => NULL()
      ZWSEQ => NULL()
      ZWSMX => NULL()
      ZWWILT => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    
    
  END IF
  
  
  CALL APL_ARPEGE_INIT_SURFEX(YDMF_PHYS_BASE_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDCPG_GPAR, YDMF_PHYS,  &
  & YDVARS, YDMODEL, ZALBD, ZALBP, ZFLU_EMIS, ZSGROUPEL, ZSRAIN, ZSSNOW, ZTSN)
  
  <PragmaRegion::>
    
    DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
      ZDPHIV(JLON) = YDMODEL%YRCST%RG*YDMODEL%YRML_PHY_MF%YRPHY2%HVCLS
      ZDPHIT(JLON) = YDMODEL%YRCST%RG*YDMODEL%YRML_PHY_MF%YRPHY2%HTCLS
    END DO
    
  
  LLCLS = .true.
  LLHMT = .true.
  IF (YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN
    
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACHMTLS')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
      ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
      Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
      ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
      ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
      ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
      ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
      ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
      ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
      ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
      ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL ACHMTLS(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG,  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK),  &
        & Z_YDCPG_MISC_QS(:, JBLK), YL_ZDPHIT(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_OUT_GZ0H(:, JBLK), LLCLS,  &
        & YL_ZNBVNO(:, :, JBLK), YL_ZMRIPP(:, :, JBLK), YL_ZDSA_CPS(:, JBLK), YL_ZGWDCS(:, JBLK), YL_ZDSA_LHS(:, JBLK),  &
        & YL_ZPCLS(:, JBLK), YL_ZFLU_CD(:, JBLK), ZFLU_CDN)
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACHMTLS')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
        ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
        Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
        Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
        ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
        ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
        ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
        ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
        ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
        ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
        ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
        ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDCPG_MISC_QS => NULL()
      ZDPHIT => NULL()
      Z_YDMF_PHYS_OUT_GZ0 => NULL()
      Z_YDMF_PHYS_OUT_GZ0H => NULL()
      ZNBVNO => NULL()
      ZMRIPP => NULL()
      ZDSA_CPS => NULL()
      ZGWDCS => NULL()
      ZDSA_LHS => NULL()
      ZPCLS => NULL()
      ZFLU_CD => NULL()
      ZFLU_CDN => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    
    
  ELSE
    
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACHMT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      ZPFL_FPLSH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLSH)
      ZPFL_FPLCH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLCH)
      ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
      ZDPHIV => GET_HOST_DATA_RDWR(YL_ZDPHIV)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_HV)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
      ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
      ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
      ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
      ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
      ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
      ZCDROV => GET_HOST_DATA_RDWR(YL_ZCDROV)
      ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
      ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
      ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
      ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
      ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
      Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
      ZHQ => GET_HOST_DATA_RDWR(YL_ZHQ)
      ZHU => GET_HOST_DATA_RDWR(YL_ZHU)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
      Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
      ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
      Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
      ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
      ZRTI => GET_HOST_DATA_RDWR(YL_ZRTI)
      ZSTAB => GET_HOST_DATA_RDWR(YL_ZSTAB)
      Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NUCLS)
      Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NVCLS)
      ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
      ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
      ZXDROV => GET_HOST_DATA_RDWR(YL_ZXDROV)
      ZXHROV => GET_HOST_DATA_RDWR(YL_ZXHROV)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL ACHMT(YDCPG_OPTS%YRCLI, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY0, YDMODEL%YRML_PHY_MF%YRPHY1,  &
        & YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG,  &
        & YDCPG_OPTS%YRSURF_DIMS%YSD_VVD%NUMFLDS >= 8 .and. YDMODEL%YRML_PHY_MF%YRPHY%LSOLV,  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK), YL_ZQV(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), YL_ZPFL_FPLSH(:, :, JBLK),  &
        & YL_ZPFL_FPLCH(:, :, JBLK), YL_ZDPHIT(:, JBLK), YL_ZDPHIV(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PHV(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), YL_ZNEIJG(:, JBLK), YL_ZNEIJV(:, JBLK), YDMF_PHYS_BASE_STATE%YGSP_SG%F(:, 1),  &
        & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK), YL_ZWFC(:, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), LLCLS, LLHMT,  &
        & YL_ZNBVNO(:, :, JBLK), YL_ZMRIPP(:, :, JBLK), YL_ZFLU_CD(:, JBLK), YL_ZFLU_CDN(:, JBLK), YL_ZCDROV(:, JBLK),  &
        & YL_ZFLU_CH(:, JBLK), YL_ZCHROV(:, JBLK), YL_ZDSA_CPS(:, JBLK), YL_ZDQSTS(:, JBLK), YL_ZGWDCS(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_OUT_GZ0H(:, JBLK), YL_ZHQ(:, JBLK), YL_ZHU(:, JBLK), YL_ZFLU_NEIJ(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_QCLS(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), YL_ZFLU_QSATS(:, JBLK), Z_YDMF_PHYS_OUT_RHCLS(:, JBLK),  &
        & YL_ZDSA_RS(:, JBLK), YL_ZRTI(:, JBLK), YL_ZSTAB(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_UCLS(:, JBLK), Z_YDMF_PHYS_OUT_VCLS(:, JBLK), Z_YDMF_PHYS_OUT_NUCLS(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_NVCLS(:, JBLK), YL_ZPCLS(:, JBLK), YL_ZFLU_VEG(:, JBLK), YL_ZXDROV(:, JBLK), YL_ZXHROV(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_UGST(:, JBLK), YDMF_PHYS%OUT%VGST)
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACHMT')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
        ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        ZPFL_FPLSH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLSH)
        ZPFL_FPLCH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLCH)
        ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
        ZDPHIV => GET_HOST_DATA_RDWR(YL_ZDPHIV)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
        Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
        Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_HV)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
        ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
        ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
        ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
        ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
        ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
        ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
        ZCDROV => GET_HOST_DATA_RDWR(YL_ZCDROV)
        ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
        ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
        ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
        ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
        ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
        Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
        Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
        ZHQ => GET_HOST_DATA_RDWR(YL_ZHQ)
        ZHU => GET_HOST_DATA_RDWR(YL_ZHU)
        ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
        Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
        ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
        Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
        ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
        ZRTI => GET_HOST_DATA_RDWR(YL_ZRTI)
        ZSTAB => GET_HOST_DATA_RDWR(YL_ZSTAB)
        Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
        Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
        Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
        Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NUCLS)
        Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NVCLS)
        ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
        ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
        ZXDROV => GET_HOST_DATA_RDWR(YL_ZXDROV)
        ZXHROV => GET_HOST_DATA_RDWR(YL_ZXHROV)
        Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
        Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
      ZQV => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      ZPFL_FPLSH => NULL()
      ZPFL_FPLCH => NULL()
      ZDPHIT => NULL()
      ZDPHIV => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      ZNEIJG => NULL()
      ZNEIJV => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL()
      ZWFC => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL()
      ZNBVNO => NULL()
      ZMRIPP => NULL()
      ZFLU_CD => NULL()
      ZFLU_CDN => NULL()
      ZCDROV => NULL()
      ZFLU_CH => NULL()
      ZCHROV => NULL()
      ZDSA_CPS => NULL()
      ZDQSTS => NULL()
      ZGWDCS => NULL()
      Z_YDMF_PHYS_OUT_GZ0 => NULL()
      Z_YDMF_PHYS_OUT_GZ0H => NULL()
      ZHQ => NULL()
      ZHU => NULL()
      ZFLU_NEIJ => NULL()
      Z_YDMF_PHYS_OUT_QCLS => NULL()
      Z_YDCPG_MISC_QS => NULL()
      ZFLU_QSATS => NULL()
      Z_YDMF_PHYS_OUT_RHCLS => NULL()
      ZDSA_RS => NULL()
      ZRTI => NULL()
      ZSTAB => NULL()
      Z_YDMF_PHYS_OUT_TCLS => NULL()
      Z_YDMF_PHYS_OUT_UCLS => NULL()
      Z_YDMF_PHYS_OUT_VCLS => NULL()
      Z_YDMF_PHYS_OUT_NUCLS => NULL()
      Z_YDMF_PHYS_OUT_NVCLS => NULL()
      ZPCLS => NULL()
      ZFLU_VEG => NULL()
      ZXDROV => NULL()
      ZXHROV => NULL()
      Z_YDMF_PHYS_OUT_UGST => NULL()
      Z_YDMF_PHYS_OUT_VGST => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    
    
  END IF
  
  
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACCLPH')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZTHETAV => GET_HOST_DATA_RDWR(YL_ZTHETAV)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
    ZTHETAVS => GET_HOST_DATA_RDWR(YL_ZTHETAVS)
    IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
    Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH)
    Z_YDMF_PHYS_OUT_VEIN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VEIN)
    ZUGST => GET_HOST_DATA_RDWR(YL_ZUGST)
    ZVGST => GET_HOST_DATA_RDWR(YL_ZVGST)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL ACCLPH(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY0, YDMODEL%YRML_PHY_MF%YRPHY2, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA,  &
      & YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, YL_ZTHETAV(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), YL_ZTHETAVS(:, JBLK), YL_IMOC_CLPH(:, JBLK),  &
      & Z_YDMF_PHYS_OUT_CLPH(:, JBLK), Z_YDMF_PHYS_OUT_VEIN(:, JBLK), YL_ZUGST(:, JBLK), ZVGST)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACCLPH')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZTHETAV => GET_HOST_DATA_RDWR(YL_ZTHETAV)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      ZTHETAVS => GET_HOST_DATA_RDWR(YL_ZTHETAVS)
      IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
      Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH)
      Z_YDMF_PHYS_OUT_VEIN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VEIN)
      ZUGST => GET_HOST_DATA_RDWR(YL_ZUGST)
      ZVGST => GET_HOST_DATA_RDWR(YL_ZVGST)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZTHETAV => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
    Z_YDMF_PHYS_BASE_STATE_U => NULL()
    Z_YDMF_PHYS_BASE_STATE_V => NULL()
    ZTHETAVS => NULL()
    IMOC_CLPH => NULL()
    Z_YDMF_PHYS_OUT_CLPH => NULL()
    Z_YDMF_PHYS_OUT_VEIN => NULL()
    ZUGST => NULL()
    ZVGST => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  
  
  CALL APL_ARPEGE_OCEANIC_FLUXES(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL, LLHMT,  &
  & ZCDROV, ZCEROV, ZCHROV, ZDPHIT, ZDPHIV, ZDSA_RS, ZFLU_CD, ZFLU_CDN, ZFLU_CH, ZFLU_QSATS)
  
  
  CALL APL_WIND_GUST(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDVARS, YDMODEL, IMOC_CLPH, ZBLH, ZDCAPE)
  
  
  CALL APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDMF_PHYS,  &
  & YDMODEL, YDDDH, INLAB_CVPP, ZCDROV, ZCHROV, ZCOEFN, ZCONDCVPPI, ZCONDCVPPL, ZDIFCVPPQ, ZDIFCVPPS,  &
  & YDMODEL%YRML_PHY_MF%YRPHY0%REPS, ZFLU_CD, ZFLU_CH, ZKQLROV, ZKQROV, ZKTROV, ZKUROV, ZMSC_LSCPE, ZNBVNO, ZNEBS, ZNEBS0,  &
  & ZNEB_CVPP, ZPFL_FPLCH, ZPFL_FTKE, ZPFL_FTKEI, ZPRODTH_CVPP, ZQI, ZQIC, ZQL, ZQLC, ZQLIS, ZQLIS0, ZQLI_CVPP, ZQV, ZTKE1,  &
  & ZXTROV, ZXUROV)
  
  CALL APL_ARPEGE_ALBEDO_COMPUTATION(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL, ZALBD,  &
  & ZALBP, ZEPS0, ZFLU_EMIS, ZFLU_NEIJ, ZRDG_MU0)
  
  CALL APL_ARPEGE_AEROSOLS_FOR_RADIATION(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS_SURF, YDMODEL, ZAER, ZAERINDS)
  
  CALL APL_ARPEGE_CLOUDINESS(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDMF_PHYS, YDVARS, YDMODEL, LLREDPR,  &
  & ZAIPCMT, ZBLH, ZDECRD, ZFLU_QSAT, ZMSC_QW, ZNEBC0, ZNEBCH, ZNEBS, ZNEBS0, ZNEB_CVPP, ZPFL_FPLCH, ZQI, ZQL, ZQLIS, ZQLIS0,  &
  & ZQLI_CVP, ZQLI_CVPP, ZQV, ZUNEBH, YDGEOMETRY%YRSTA)
  
  CALL APL_ARPEGE_RADIATION(YDMF_PHYS_BASE_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDCPG_GPAR, YDMF_PHYS,  &
  & YDMF_PHYS_SURF, YDVARS, YDMODEL, ZAER, ZAERINDS, ZALBD, ZALBP, ZCEMTR, ZCTRSO, ZFLU_EMIS, ZFLU_QSAT, ZQO3, ZQR, ZQS, ZQV,  &
  & ZRDG_MU0, ZRDG_MU0LU, ZRDG_MU0M, ZSFSWDIF, ZSFSWDIR, ZSUDU, ZTENT, ZTRSOD, ZTRSODIF, ZTRSODIR)
  
  CALL APL_ARPEGE_SOIL_HYDRO(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL, ZCHROV,  &
  & ZFLU_NEIJ, ZFLU_QSAT, ZFLU_QSATS, ZFLU_VEG, ZGWDCS, ZHQ, ZHTR, ZHU, ZQV, ZWFC, ZWLMX, ZWWILT)
  
  CALL APL_ARPEGE_SURFACE(YDMF_PHYS_BASE_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDCPG_GPAR, YDMF_PHYS,  &
  & YDMF_PHYS_SURF, YDVARS, YDMODEL, ZALBD, ZALBP, ZALPHA1, ZCDROV, ZCEROV, ZCFATH, ZCFAU, ZCFBTH, ZCFBU, ZCFBV, ZCHROV, ZCOEFA,  &
  & ZCOEFN, ZCP, ZDIFEXT, ZDIFWQ, ZDIFWS, ZDQSTS, ZDSA_CPS, ZDSA_LHS, ZDTMSE, ZEDMFQ, ZEDMFS, ZEDMFU, ZEDMFV, ZFLU_CD, ZFLU_CDN,  &
  & ZFLU_EMIS, ZFLU_FEVI, ZFLU_NEIJ, ZFLU_QSATS, ZFLU_VEG, ZHQ, ZHTR, ZHU, ZKQLROV, ZKQROV, ZKTROV, ZKUROV, ZLVT, ZMF_UP,  &
  & ZNEBCH, ZNEBDIFF, ZNEBS, ZPOID, ZQI, ZQICE, ZQL, ZQV, ZRDG_MU0, ZRDG_MU0N, ZRHGMT, ZSC_FCLL, ZSC_FCLN, ZSC_FEVI, ZSC_FEVN,  &
  & ZSFSWDIF, ZSFSWDIR, ZSGROUPEL, ZSRAIN, ZSSNOW, ZSTATI, ZTSN, ZXDROV, ZXHROV, ZXQRO, ZXTRO, ZXTROV, ZXURO, ZXUROV)
  
  ! The deep convection will see the shallow part from KFB as it is with Louis scheme and the modified RI
  
  <PragmaRegion::>
    
    DO JLEV=YDCPG_OPTS%KTDIA,YDCPG_OPTS%KFLEVG
      DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
        YDMF_PHYS%OUT%DIFTQ(JLON, JLEV) = YDMF_PHYS%OUT%DIFTQ(JLON, JLEV) + ZDIFCVPPQ(JLON, JLEV)
        YDMF_PHYS%OUT%DIFTS(JLON, JLEV) = YDMF_PHYS%OUT%DIFTS(JLON, JLEV) + ZDIFCVPPS(JLON, JLEV)
        YDMF_PHYS%OUT%STRTU(JLON, JLEV) = YDMF_PHYS%OUT%STRTU(JLON, JLEV) + ZDIFCVPPU(JLON, JLEV)
        YDMF_PHYS%OUT%STRTV(JLON, JLEV) = YDMF_PHYS%OUT%STRTV(JLON, JLEV) + ZDIFCVPPV(JLON, JLEV)
      END DO
    END DO
    
  
  ! Additional diagnostics of radiative fluxes (PFRTHDS and PFRSOPT)
  
  <PragmaRegion::>
    
    !DEC$ IVDEP
    DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
      IF (.not.YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) YDMF_PHYS%OUT%FRTHDS(JLON) = YDMF_PHYS%OUT%FRTH(JLON, YDCPG_OPTS%KFLEVG, 1) / ZFLU_EMIS(JLON) +  &
      & YDMODEL%YRCST%RSIGMA*YDMF_PHYS_BASE_STATE%YGSP_RR%T(JLON)**4
      IF (ZRDG_MU0(JLON) <= 0.0_JPRB) THEN
        YDMF_PHYS%OUT%FRSOPT(JLON) = 0.0_JPRB
      ELSE
        YDMF_PHYS%OUT%FRSOPT(JLON) = YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRDG_MU0(JLON)
      END IF
    END DO
    
  
  ! Additional diagnostic of the derivative of the non solar surface; heat flux with respect to surface temperature
  
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACDRAG')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
    ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
    Z_YDMF_PHYS_OUT_DRNSHF => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DRNSHF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
    Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%RCORI%F_T0)
    Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_GETRL)
    ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
    Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDU)
    Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDV)
    ZTRAJGWD => GET_HOST_DATA_RDWR(YL_ZTRAJGWD)
    ZNEBS => GET_HOST_DATA_RDWR(YL_ZNEBS)
    ZQLIS => GET_HOST_DATA_RDWR(YL_ZQLIS)
    ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL ACDNSHF(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY1, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA,  &
      & YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, YL_ZFLU_EMIS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK),  &
      & YL_ZFLU_NEIJ(:, JBLK), YL_ZQV(:, :, JBLK), Z_YDCPG_MISC_QS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK),  &
      & YL_ZCHROV(:, JBLK), YL_ZDQSTS(:, JBLK), YDMF_PHYS%OUT%DRNSHF)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACDRAG')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
      ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
      Z_YDMF_PHYS_OUT_DRNSHF => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DRNSHF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%RCORI%F_T0)
      Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_GETRL)
      ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
      Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
      Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
      Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDU)
      Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDV)
      ZTRAJGWD => GET_HOST_DATA_RDWR(YL_ZTRAJGWD)
      ZNEBS => GET_HOST_DATA_RDWR(YL_ZNEBS)
      ZQLIS => GET_HOST_DATA_RDWR(YL_ZQLIS)
      ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
      Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
      Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
      Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
      Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZFLU_EMIS => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
    ZFLU_NEIJ => NULL()
    ZQV => NULL()
    Z_YDCPG_MISC_QS => NULL()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
    ZCHROV => NULL()
    ZDQSTS => NULL()
    Z_YDMF_PHYS_OUT_DRNSHF => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL()
    ZNBVNO => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL()
    Z_YDMF_PHYS_BASE_STATE_U => NULL()
    Z_YDMF_PHYS_BASE_STATE_V => NULL()
    Z_YDVARS_GEOMETRY_RCORI_T0 => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => NULL()
    ZGWDCS => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => NULL()
    Z_YDMF_PHYS_OUT_STRDU => NULL()
    Z_YDMF_PHYS_OUT_STRDV => NULL()
    ZTRAJGWD => NULL()
    ZNEBS => NULL()
    ZQLIS => NULL()
    ZMSC_QW => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_OUT_FCSQL => NULL()
    Z_YDMF_PHYS_OUT_FCSQN => NULL()
    Z_YDMF_PHYS_OUT_FPLSL => NULL()
    Z_YDMF_PHYS_OUT_FPLSN => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSL => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSN => NULL()
    Z_YDMF_PHYS_OUT_FPFPSL => NULL()
    Z_YDMF_PHYS_OUT_FPFPSN => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  
  
  CALL APL_ARPEGE_DEEP_CONVECTION(YDMF_PHYS_BASE_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDCPG_DYN0,  &
  & YDMF_PHYS_SURF, YDVARS, YDMODEL, ZFPCOR, ZQV, ZTENHA, ZTENQVA, ZTENT)
  
  CALL APL_ARPEGE_PRECIPITATION(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDMF_PHYS_SURF, YDVARS, YDMODEL,  &
  & ZFLU_NEIJ, ZNEBS, ZNEB_CVPP, ZQC_DET_PCMT, ZQI, ZQL, ZQLIS, ZQLI_CVPP, ZQR, ZQS, ZQV, ZSEDIQI, ZSEDIQL, ZTENHA, ZTENQVA,  &
  & YDGEOMETRY%YRSTA)
  
  
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:QNGCOR')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    ZQL => GET_HOST_DATA_RDWR(YL_ZQL)
    ZQI => GET_HOST_DATA_RDWR(YL_ZQI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQN)
    Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQL)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQN)
    Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQL)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCQNG)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL QNGCOR(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY2, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
      & YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, YL_ZQV(:, :, JBLK), YL_ZQL(:, :, JBLK), YL_ZQI(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFCQ(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_DIFCQN(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFCQL(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_DIFTQN(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFTQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPSL(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_FPEVPSN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPCL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPCN(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_FPFPSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPFPCL(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_FPFPCN(:, :, JBLK), Z_YDMF_PHYS_OUT_FCCQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FCCQN(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_FCSQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:, :, JBLK), YDMF_PHYS%OUT%FCQNG)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:QNGCOR')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZQL => GET_HOST_DATA_RDWR(YL_ZQL)
      ZQI => GET_HOST_DATA_RDWR(YL_ZQI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
      Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQ)
      Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQN)
      Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQL)
      Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ)
      Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQN)
      Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQL)
      Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
      Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
      Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCL)
      Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCN)
      Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
      Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
      Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCL)
      Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCN)
      Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQL)
      Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQN)
      Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
      Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
      Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCQNG)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZQV => NULL()
    ZQL => NULL()
    ZQI => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL()
    Z_YDMF_PHYS_OUT_DIFCQ => NULL()
    Z_YDMF_PHYS_OUT_DIFCQN => NULL()
    Z_YDMF_PHYS_OUT_DIFCQL => NULL()
    Z_YDMF_PHYS_OUT_DIFTQ => NULL()
    Z_YDMF_PHYS_OUT_DIFTQN => NULL()
    Z_YDMF_PHYS_OUT_DIFTQL => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSL => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSN => NULL()
    Z_YDMF_PHYS_OUT_FPEVPCL => NULL()
    Z_YDMF_PHYS_OUT_FPEVPCN => NULL()
    Z_YDMF_PHYS_OUT_FPFPSL => NULL()
    Z_YDMF_PHYS_OUT_FPFPSN => NULL()
    Z_YDMF_PHYS_OUT_FPFPCL => NULL()
    Z_YDMF_PHYS_OUT_FPFPCN => NULL()
    Z_YDMF_PHYS_OUT_FCCQL => NULL()
    Z_YDMF_PHYS_OUT_FCCQN => NULL()
    Z_YDMF_PHYS_OUT_FCSQL => NULL()
    Z_YDMF_PHYS_OUT_FCSQN => NULL()
    Z_YDMF_PHYS_OUT_FCQNG => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  
  
  ! Bilan hydrique du sol
  
  CALL APL_ARPEGE_HYDRO_BUDGET(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_GPAR, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL,  &
  & ZC3, ZCN, ZDSA_C1, ZDSA_C2, ZFLU_FEVI, ZFLU_NEIJ, ZFLU_VEG, ZFPLSL, ZFPLSN, ZWFC, ZWLMX, ZWPMX, ZWSEQ, ZWSMX)
  
  ! Drag mesospherique pour un modele possedant des niveaux au-dessus de 50 km (i.e. dans la mesosphere)
  
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACDRME')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRMH)
    ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
    Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMU)
    Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMV)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL ACDRME(YDMODEL%YRCST, YDGEOMETRY%YRSTA, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRML_PHY_MF%YRTOPH, YDCPG_BNDS%KIDIA,  &
      & YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTDRME, YDCPG_OPTS%KFLEVG,  &
      & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), YL_ZQV(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), Z_YDMF_PHYS_OUT_FRMH(:, :, JBLK), YL_ZMSC_FRMQ(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_STRMU(:, :, JBLK), YDMF_PHYS%OUT%STRMV)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACDRME')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRMH)
      ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
      Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMU)
      Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMV)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    ZQV => NULL()
    Z_YDMF_PHYS_BASE_STATE_U => NULL()
    Z_YDMF_PHYS_BASE_STATE_V => NULL()
    Z_YDMF_PHYS_OUT_FRMH => NULL()
    ZMSC_FRMQ => NULL()
    Z_YDMF_PHYS_OUT_STRMU => NULL()
    Z_YDMF_PHYS_OUT_STRMV => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  
  
  <PragmaRegion::>
    
    ! DDH flexibles pour les champs de surface variables/flux/tendances.
    
    
  
  IF (YDMODEL%YRML_PHY_MF%YRPHY2%LRAFTKE) THEN
    
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACEVADCAPE')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      ZDCAPE => GET_HOST_DATA_RDWR(YL_ZDCAPE)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CAPE)
      ZTKE1 => GET_HOST_DATA_RDWR(YL_ZTKE1)
      Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%OROG%F_T0)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
      ZBLH => GET_HOST_DATA_RDWR(YL_ZBLH)
      IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL ACEVADCAPE(YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_OUT_FPLSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPLCL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), ZDCAPE)
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACEVADCAPE')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
        Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
        Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
        Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        ZDCAPE => GET_HOST_DATA_RDWR(YL_ZDCAPE)
        Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
        Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CAPE)
        ZTKE1 => GET_HOST_DATA_RDWR(YL_ZTKE1)
        Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%OROG%F_T0)
        Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
        Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
        ZBLH => GET_HOST_DATA_RDWR(YL_ZBLH)
        IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_FPLSL => NULL()
      Z_YDMF_PHYS_OUT_FPLSN => NULL()
      Z_YDMF_PHYS_OUT_FPLCL => NULL()
      Z_YDMF_PHYS_OUT_FPLCN => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      ZDCAPE => NULL()
      Z_YDMF_PHYS_OUT_UCLS => NULL()
      Z_YDMF_PHYS_OUT_VCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_OUT_CAPE => NULL()
      ZTKE1 => NULL()
      Z_YDVARS_GEOMETRY_OROG_T0 => NULL()
      Z_YDMF_PHYS_OUT_UGST => NULL()
      Z_YDMF_PHYS_OUT_VGST => NULL()
      ZBLH => NULL()
      IMOC_CLPH => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    
    
  END IF
  
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACVISIH')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QLI)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QICE)
    ZQR => GET_HOST_DATA_RDWR(YL_ZQR)
    ZQS => GET_HOST_DATA_RDWR(YL_ZQS)
    ZQGM => GET_HOST_DATA_RDWR(YL_ZQGM)
    Z_YDMF_PHYS_OUT_VISICLD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISICLD)
    Z_YDMF_PHYS_OUT_VISIHYD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISIHYD)
    Z_YDMF_PHYS_OUT_MXCLWC => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_MXCLWC)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL ACVISIH(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY%YRDVISI, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
      & YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK), Z_YDCPG_MISC_QLI(:, :, JBLK),  &
      & Z_YDCPG_MISC_QICE(:, :, JBLK), YL_ZQR(:, :, JBLK), YL_ZQS(:, :, JBLK), YL_ZQGM(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_VISICLD(:, JBLK), Z_YDMF_PHYS_OUT_VISIHYD(:, JBLK), YDMF_PHYS%OUT%MXCLWC)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACVISIH')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QLI)
      Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QICE)
      ZQR => GET_HOST_DATA_RDWR(YL_ZQR)
      ZQS => GET_HOST_DATA_RDWR(YL_ZQS)
      ZQGM => GET_HOST_DATA_RDWR(YL_ZQGM)
      Z_YDMF_PHYS_OUT_VISICLD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISICLD)
      Z_YDMF_PHYS_OUT_VISIHYD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISIHYD)
      Z_YDMF_PHYS_OUT_MXCLWC => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_MXCLWC)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
    Z_YDCPG_MISC_QLI => NULL()
    Z_YDCPG_MISC_QICE => NULL()
    ZQR => NULL()
    ZQS => NULL()
    ZQGM => NULL()
    Z_YDMF_PHYS_OUT_VISICLD => NULL()
    Z_YDMF_PHYS_OUT_VISIHYD => NULL()
    Z_YDMF_PHYS_OUT_MXCLWC => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  
  
  ! Convert from flux [kg/m2/s] to density [kg/m3] using old RTTOV-SCATT
  !  a    b         ! RR = a * LWC^b, [RR]=mm/h, [LWC]=g/m^3
  ! 20.89 1.15      ! rain
  ! 29.51 1.10      ! snow
  
  <PragmaRegion::>
    
    DO JLEV=1,YDCPG_OPTS%KFLEVG
      DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
        ZBAY_QRCONV(JLON, JLEV) = 0.001_JPRB*((ABS(YDMF_PHYS%OUT%FPLCL(JLON, JLEV))*YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFRAIN(1)) &
        & **YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFRAIN(2))
        ZBAY_QSCONV(JLON, JLEV) = 0.001_JPRB*((ABS(YDMF_PHYS%OUT%FPLCN(JLON, JLEV))*YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFSNOW(1)) &
        & **YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFSNOW(2))
      END DO
    END DO
    
  
  ! Convert density [kg/m3] to mixing ratio [kg/kg]
  ! R_dry (dry air constant)
  
  <PragmaRegion::>
    
    DO JLEV=1,YDCPG_OPTS%KFLEVG
      DO JLON=YDCPG_BNDS%KIDIA,YDCPG_BNDS%KFDIA
        ZDE2MR(JLON, JLEV) =  &
        & YDMODEL%YRCST%RD*YDMF_PHYS_BASE_STATE%T(JLON, JLEV) / YDMF_PHYS_BASE_STATE%YCPG_PHY%PREHYDF(JLON, JLEV)
        ZBAY_QRCONV(JLON, JLEV) = ZBAY_QRCONV(JLON, JLEV)*ZDE2MR(JLON, JLEV)
        ZBAY_QSCONV(JLON, JLEV) = ZBAY_QSCONV(JLON, JLEV)*ZDE2MR(JLON, JLEV)
      END DO
    END DO
    
  
  ! Precipitation Type
  
  ! Compute wet-bulb temperature at 2 meters (suppose homogeneity of qv/ql/qi )
  
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:PPWETPOINT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
    Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_L)
    Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_I)
    Z_YDMF_PHYS_OUT_TPWCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TPWCLS)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL PPWETPOINT(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
      & YL_ZPCLS(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK), YDMF_PHYS_BASE_STATE%Q(:, YDCPG_OPTS%KFLEVG),  &
      & YDMF_PHYS_BASE_STATE%L(:, YDCPG_OPTS%KFLEVG), YDMF_PHYS_BASE_STATE%I(:, YDCPG_OPTS%KFLEVG), YDMF_PHYS%OUT%TPWCLS)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:PPWETPOINT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
      Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
      Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_L)
      Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_I)
      Z_YDMF_PHYS_OUT_TPWCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TPWCLS)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZPCLS => NULL()
    Z_YDMF_PHYS_OUT_TCLS => NULL()
    Z_YDMF_PHYS_BASE_STATE_Q => NULL()
    Z_YDMF_PHYS_BASE_STATE_L => NULL()
    Z_YDMF_PHYS_BASE_STATE_I => NULL()
    Z_YDMF_PHYS_OUT_TPWCLS => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  
  
  CALL APL_ARPEGE_DPRECIPS(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDVARS, YDMODEL, ZPRC_DPRECIPS,  &
  & ZPRC_DPRECIPS2)
  
  CALL MF_PHYS_MOCON(YDCPG_BNDS, YDCPG_OPTS, ZRDG_LCVQ, IMOC_CLPH, YDMF_PHYS, YDMF_PHYS_BASE_STATE)
  
  ! Store surface water flux P and E for water conservation
  IF (YDCPG_OPTS%LCORWAT) THEN
    
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:None')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVL)
      Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVN)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_SURF_GSD_VH_PEVA => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_EVA)
      Z_YDMF_PHYS_SURF_GSD_VH_PPCL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCL)
      Z_YDMF_PHYS_SURF_GSD_VH_PPCN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCN)
      Z_YDMF_PHYS_SURF_GSD_VH_PPSL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSL)
      Z_YDMF_PHYS_SURF_GSD_VH_PPSN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSN)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL MF_PHYS_CORWAT(YDCPG_BNDS, YDCPG_OPTS, Z_YDMF_PHYS_OUT_FEVL(:, :, JBLK), Z_YDMF_PHYS_OUT_FEVN(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPLCL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLSL(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPLSN(:, :, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PEVA(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PPCL(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VH_PPCN(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PPSL(:, JBLK), YDMF_PHYS_SURF%GSD_VH%PPSN)
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:None')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVL)
        Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVN)
        Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
        Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
        Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
        Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
        Z_YDMF_PHYS_SURF_GSD_VH_PEVA => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_EVA)
        Z_YDMF_PHYS_SURF_GSD_VH_PPCL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCL)
        Z_YDMF_PHYS_SURF_GSD_VH_PPCN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCN)
        Z_YDMF_PHYS_SURF_GSD_VH_PPSL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSL)
        Z_YDMF_PHYS_SURF_GSD_VH_PPSN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSN)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_FEVL => NULL()
      Z_YDMF_PHYS_OUT_FEVN => NULL()
      Z_YDMF_PHYS_OUT_FPLCL => NULL()
      Z_YDMF_PHYS_OUT_FPLCN => NULL()
      Z_YDMF_PHYS_OUT_FPLSL => NULL()
      Z_YDMF_PHYS_OUT_FPLSN => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PEVA => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PPCL => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PPCN => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PPSL => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PPSN => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    
    
  END IF
  
  ! Surface specific humidity necessary to compute the vertical advection of q in the case "delta m=1" (unlagged physics only).
  
  IF (YDMODEL%YRML_PHY_MF%YRPHY%NDPSFI == 1) THEN
    
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:None')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDWR(YDCPG_PHY0%F_PREHYD)
      Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSP_RR%F_T_T0)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
      ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
      Z_YDCPG_MISC_QSOL => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QSOL)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL CPQSOL(YDMODEL%YRCST, YDGEOMETRY%YRDIMV, YDMODEL%YRML_PHY_MF%YRPHY, YDCPG_OPTS%KLON, YDCPG_BNDS%KIDIA,  &
        & YDCPG_BNDS%KFDIA, Z_YDCPG_PHY0_PREHYD(:, :, JBLK), Z_YDMF_PHYS_SURF_GSP_RR_PT_T0(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK),  &
        & YL_ZFLU_QSATS(:, JBLK), YDCPG_MISC%QSOL)
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:None')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDWR(YDCPG_PHY0%F_PREHYD)
        Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSP_RR%F_T_T0)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
        ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
        Z_YDCPG_MISC_QSOL => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QSOL)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_PHY0_PREHYD => NULL()
      Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => NULL()
      Z_YDCPG_MISC_QS => NULL()
      ZFLU_QSATS => NULL()
      Z_YDCPG_MISC_QSOL => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    
    
  END IF
  
  CALL APL_ARPEGE_ATMOSPHERE_UPDATE(YDMF_PHYS_BASE_STATE, YDMF_PHYS_NEXT_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC,  &
  & YDMF_PHYS, YDCPG_DYN0, YDMF_PHYS_SURF, YDVARS, YDMODEL, YDDDH, ZDIFEXT, ZDSA_CPS, ZMSC_FRMQ, ZPFL_FEFB1, ZPFL_FEFB2,  &
  & ZPFL_FEFB3, ZPFL_FTKE, ZPFL_FTKEI)
  
  CALL MF_PHYS_FPL_PART2(YDCPG_BNDS, YDCPG_OPTS, ZPFL_FPLCH, ZPFL_FPLSH, YDVARS%CPF%T1, YDVARS%SPF%T1, YDMODEL)
  
  CALL MF_PHYS_TRANSFER(YDCPG_BNDS, YDCPG_OPTS, YDVARS, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_GCONF%YGFL)
  
  CALL APL_ARPEGE_SURFACE_UPDATE(YDCPG_BNDS, YDCPG_OPTS, YDCPG_GPAR, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL, YDCPG_OPTS%LCONFX,  &
  & YDCPG_OPTS%ZDTPHY, ZDSA_C1, ZDSA_C2, ZFLU_FEVI, ZFLU_VEG)
  
  IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVPGY) THEN
    
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:None')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_CVV_T0 => GET_HOST_DATA_RDWR(YDVARS%CVV%F_T0)
      Z_YDVARS_CVV_T1 => GET_HOST_DATA_RDWR(YDVARS%CVV%F_T1)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL MF_PHYS_CVV(YDCPG_BNDS, YDCPG_OPTS, Z_YDVARS_CVV_T0(:, :, JBLK), YDVARS%CVV%T1)
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:None')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDVARS_CVV_T0 => GET_HOST_DATA_RDWR(YDVARS%CVV%F_T0)
        Z_YDVARS_CVV_T1 => GET_HOST_DATA_RDWR(YDVARS%CVV%F_T1)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_CVV_T0 => NULL()
      Z_YDVARS_CVV_T1 => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:None:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    
    
  END IF
  
  ! Restore the initial value of some pseudo-historical surface buffers if relevant.
  
  IF (YDCPG_OPTS%LCONFX) THEN
    
    CALL MF_PHYS_SAVE_PHSURF_PART2(YDCPG_BNDS, YDCPG_OPTS, ZSAV_DDAL, ZSAV_DDOM, ZSAV_ENTCH, ZSAV_FHPS, ZSAV_GZ0F, ZSAV_GZ0HF,  &
    & ZSAV_HV, ZSAV_PBLH, ZSAV_QSH, ZSAV_UDAL, ZSAV_UDGRO, ZSAV_UDOM, ZSAV_UNEBH, YDMF_PHYS_SURF%GSD_VF%PZ0F,  &
    & YDMF_PHYS_SURF%GSD_VH%PPBLH, YDMF_PHYS_SURF%GSD_VH%PQSH, YDMF_PHYS_SURF%GSD_VH%PSPSH, YDMF_PHYS_SURF%GSD_VK%PUDGRO,  &
    & YDMF_PHYS_SURF%GSD_VV%PHV, YDMF_PHYS_SURF%GSD_VV%PZ0H, YDVARS%DAL%T0, YDVARS%DOM%T0, YDVARS%UAL%T0, YDVARS%UEN%T0,  &
    & YDVARS%UNEBH%T0, YDVARS%UOM%T0, YDMODEL)
    
  END IF
  
  ! Store horizontal exchange coefficients (3D turbulence) to SL2 buffers
  
  
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:BAYRAD')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
    Z_YDVARS_RCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%RCONV%F_T1)
    Z_YDVARS_SCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%SCONV%F_T1)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL MF_PHYS_BAYRAD(YDCPG_BNDS, YDCPG_OPTS, YL_ZBAY_QRCONV(:, :, JBLK), YL_ZBAY_QSCONV(:, :, JBLK),  &
      & Z_YDVARS_RCONV_T1(:, :, JBLK), Z_YDVARS_SCONV_T1(:, :, JBLK), YDMODEL)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:BAYRAD')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
      ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
      Z_YDVARS_RCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%RCONV%F_T1)
      Z_YDVARS_SCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%SCONV%F_T1)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => NULL()
    ZBAY_QSCONV => NULL()
    Z_YDVARS_RCONV_T1 => NULL()
    Z_YDVARS_SCONV_T1 => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  
  
  
  <PragmaRegion::>
    
    IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDR) THEN
      DO JLEV=1,YDCPG_OPTS%YRSURF_DIMS%YSD_DID%NLEVS
        YDMF_PHYS_SURF%GSD_DI%PXEDR(:, JLEV) = YDMF_PHYS%OUT%EDR(:, JLEV)
      END DO
    END IF
    
  
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:PRECIPS')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZPRC_DPRECIPS => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS)
    ZPRC_DPRECIPS2 => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS2)
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK ) FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL MF_PHYS_PRECIPS(YDCPG_BNDS, YDCPG_OPTS, YL_ZPRC_DPRECIPS(:, :, JBLK), YL_ZPRC_DPRECIPS2(:, :, JBLK),  &
      & Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP(:, :, JBLK), Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2(:, :, JBLK), YDMODEL)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:PRECIPS')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZPRC_DPRECIPS => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS)
      ZPRC_DPRECIPS2 => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS2)
      Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
      Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZPRC_DPRECIPS => NULL()
    ZPRC_DPRECIPS2 => NULL()
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => NULL()
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  
  
  
  IF (LHOOK) CALL DR_HOOK('DELETE_TEMPORARIES', 0, ZHOOK_HANDLE_FIELD_API)
  IF (ASSOCIATED(YL_ZDIFEXT)) CALL FIELD_DELETE(YL_ZDIFEXT)
  IF (ASSOCIATED(YL_INLAB_CVPP)) CALL FIELD_DELETE(YL_INLAB_CVPP)
  IF (ASSOCIATED(YL_ZXTROV)) CALL FIELD_DELETE(YL_ZXTROV)
  IF (ASSOCIATED(YL_ZXUROV)) CALL FIELD_DELETE(YL_ZXUROV)
  IF (ASSOCIATED(YL_ZMRIPP)) CALL FIELD_DELETE(YL_ZMRIPP)
  IF (ASSOCIATED(YL_ZKTROV)) CALL FIELD_DELETE(YL_ZKTROV)
  IF (ASSOCIATED(YL_ZKUROV)) CALL FIELD_DELETE(YL_ZKUROV)
  IF (ASSOCIATED(YL_ZNBVNO)) CALL FIELD_DELETE(YL_ZNBVNO)
  IF (ASSOCIATED(YL_ZKQROV)) CALL FIELD_DELETE(YL_ZKQROV)
  IF (ASSOCIATED(YL_ZKQLROV)) CALL FIELD_DELETE(YL_ZKQLROV)
  IF (ASSOCIATED(YL_ZNEBS)) CALL FIELD_DELETE(YL_ZNEBS)
  IF (ASSOCIATED(YL_ZQLIS)) CALL FIELD_DELETE(YL_ZQLIS)
  IF (ASSOCIATED(YL_ZNEBS0)) CALL FIELD_DELETE(YL_ZNEBS0)
  IF (ASSOCIATED(YL_ZQLIS0)) CALL FIELD_DELETE(YL_ZQLIS0)
  IF (ASSOCIATED(YL_ZNEBC0)) CALL FIELD_DELETE(YL_ZNEBC0)
  IF (ASSOCIATED(YL_ZNEBDIFF)) CALL FIELD_DELETE(YL_ZNEBDIFF)
  IF (ASSOCIATED(YL_ZNEBCH)) CALL FIELD_DELETE(YL_ZNEBCH)
  IF (ASSOCIATED(YL_ZUNEBH)) CALL FIELD_DELETE(YL_ZUNEBH)
  IF (ASSOCIATED(YL_ZFPCOR)) CALL FIELD_DELETE(YL_ZFPCOR)
  IF (ASSOCIATED(YL_ZPOID)) CALL FIELD_DELETE(YL_ZPOID)
  IF (ASSOCIATED(YL_ZQV)) CALL FIELD_DELETE(YL_ZQV)
  IF (ASSOCIATED(YL_ZQI)) CALL FIELD_DELETE(YL_ZQI)
  IF (ASSOCIATED(YL_ZQL)) CALL FIELD_DELETE(YL_ZQL)
  IF (ASSOCIATED(YL_ZQR)) CALL FIELD_DELETE(YL_ZQR)
  IF (ASSOCIATED(YL_ZQS)) CALL FIELD_DELETE(YL_ZQS)
  IF (ASSOCIATED(YL_ZTENHA)) CALL FIELD_DELETE(YL_ZTENHA)
  IF (ASSOCIATED(YL_ZTENQVA)) CALL FIELD_DELETE(YL_ZTENQVA)
  IF (ASSOCIATED(YL_ZCP)) CALL FIELD_DELETE(YL_ZCP)
  IF (ASSOCIATED(YL_ZFPLSL)) CALL FIELD_DELETE(YL_ZFPLSL)
  IF (ASSOCIATED(YL_ZFPLSN)) CALL FIELD_DELETE(YL_ZFPLSN)
  IF (ASSOCIATED(YL_ZSEDIQL)) CALL FIELD_DELETE(YL_ZSEDIQL)
  IF (ASSOCIATED(YL_ZSEDIQI)) CALL FIELD_DELETE(YL_ZSEDIQI)
  IF (ASSOCIATED(YL_ZDIFCVPPQ)) CALL FIELD_DELETE(YL_ZDIFCVPPQ)
  IF (ASSOCIATED(YL_ZDIFCVPPS)) CALL FIELD_DELETE(YL_ZDIFCVPPS)
  IF (ASSOCIATED(YL_ZDIFCVPPU)) CALL FIELD_DELETE(YL_ZDIFCVPPU)
  IF (ASSOCIATED(YL_ZDIFCVPPV)) CALL FIELD_DELETE(YL_ZDIFCVPPV)
  IF (ASSOCIATED(YL_ZEDMFQ)) CALL FIELD_DELETE(YL_ZEDMFQ)
  IF (ASSOCIATED(YL_ZEDMFS)) CALL FIELD_DELETE(YL_ZEDMFS)
  IF (ASSOCIATED(YL_ZEDMFU)) CALL FIELD_DELETE(YL_ZEDMFU)
  IF (ASSOCIATED(YL_ZEDMFV)) CALL FIELD_DELETE(YL_ZEDMFV)
  IF (ASSOCIATED(YL_ZMF_UP)) CALL FIELD_DELETE(YL_ZMF_UP)
  IF (ASSOCIATED(YL_ZCONDCVPPL)) CALL FIELD_DELETE(YL_ZCONDCVPPL)
  IF (ASSOCIATED(YL_ZCONDCVPPI)) CALL FIELD_DELETE(YL_ZCONDCVPPI)
  IF (ASSOCIATED(YL_ZPRODTH_CVPP)) CALL FIELD_DELETE(YL_ZPRODTH_CVPP)
  IF (ASSOCIATED(YL_ZDE2MR)) CALL FIELD_DELETE(YL_ZDE2MR)
  IF (ASSOCIATED(YL_ZXDROV)) CALL FIELD_DELETE(YL_ZXDROV)
  IF (ASSOCIATED(YL_ZXHROV)) CALL FIELD_DELETE(YL_ZXHROV)
  IF (ASSOCIATED(YL_ZUGST)) CALL FIELD_DELETE(YL_ZUGST)
  IF (ASSOCIATED(YL_ZVGST)) CALL FIELD_DELETE(YL_ZVGST)
  IF (ASSOCIATED(YL_ZCDROV)) CALL FIELD_DELETE(YL_ZCDROV)
  IF (ASSOCIATED(YL_ZCHROV)) CALL FIELD_DELETE(YL_ZCHROV)
  IF (ASSOCIATED(YL_ZDQSTS)) CALL FIELD_DELETE(YL_ZDQSTS)
  IF (ASSOCIATED(YL_ZGWDCS)) CALL FIELD_DELETE(YL_ZGWDCS)
  IF (ASSOCIATED(YL_ZHQ)) CALL FIELD_DELETE(YL_ZHQ)
  IF (ASSOCIATED(YL_ZHU)) CALL FIELD_DELETE(YL_ZHU)
  IF (ASSOCIATED(YL_ZHTR)) CALL FIELD_DELETE(YL_ZHTR)
  IF (ASSOCIATED(YL_ZRTI)) CALL FIELD_DELETE(YL_ZRTI)
  IF (ASSOCIATED(YL_ZDPHI)) CALL FIELD_DELETE(YL_ZDPHI)
  IF (ASSOCIATED(YL_ZPRS)) CALL FIELD_DELETE(YL_ZPRS)
  IF (ASSOCIATED(YL_ZSTAB)) CALL FIELD_DELETE(YL_ZSTAB)
  IF (ASSOCIATED(YL_ZWFC)) CALL FIELD_DELETE(YL_ZWFC)
  IF (ASSOCIATED(YL_ZWPMX)) CALL FIELD_DELETE(YL_ZWPMX)
  IF (ASSOCIATED(YL_ZWLMX)) CALL FIELD_DELETE(YL_ZWLMX)
  IF (ASSOCIATED(YL_ZWSEQ)) CALL FIELD_DELETE(YL_ZWSEQ)
  IF (ASSOCIATED(YL_ZWSMX)) CALL FIELD_DELETE(YL_ZWSMX)
  IF (ASSOCIATED(YL_ZWWILT)) CALL FIELD_DELETE(YL_ZWWILT)
  IF (ASSOCIATED(YL_ZC3)) CALL FIELD_DELETE(YL_ZC3)
  IF (ASSOCIATED(YL_ZCG)) CALL FIELD_DELETE(YL_ZCG)
  IF (ASSOCIATED(YL_ZCN)) CALL FIELD_DELETE(YL_ZCN)
  IF (ASSOCIATED(YL_ZNEIJG)) CALL FIELD_DELETE(YL_ZNEIJG)
  IF (ASSOCIATED(YL_ZNEIJV)) CALL FIELD_DELETE(YL_ZNEIJV)
  IF (ASSOCIATED(YL_ZPCLS)) CALL FIELD_DELETE(YL_ZPCLS)
  IF (ASSOCIATED(YL_ZBLH)) CALL FIELD_DELETE(YL_ZBLH)
  IF (ASSOCIATED(YL_ZQO3)) CALL FIELD_DELETE(YL_ZQO3)
  IF (ASSOCIATED(YL_ZAER)) CALL FIELD_DELETE(YL_ZAER)
  IF (ASSOCIATED(YL_ZAERINDS)) CALL FIELD_DELETE(YL_ZAERINDS)
  IF (ASSOCIATED(YL_ZDPHIV)) CALL FIELD_DELETE(YL_ZDPHIV)
  IF (ASSOCIATED(YL_ZDPHIT)) CALL FIELD_DELETE(YL_ZDPHIT)
  IF (ASSOCIATED(YL_ZTRSOD)) CALL FIELD_DELETE(YL_ZTRSOD)
  IF (ASSOCIATED(YL_ZCEMTR)) CALL FIELD_DELETE(YL_ZCEMTR)
  IF (ASSOCIATED(YL_ZCTRSO)) CALL FIELD_DELETE(YL_ZCTRSO)
  IF (ASSOCIATED(YL_ZALBD)) CALL FIELD_DELETE(YL_ZALBD)
  IF (ASSOCIATED(YL_ZALBP)) CALL FIELD_DELETE(YL_ZALBP)
  IF (ASSOCIATED(YL_ZSFSWDIR)) CALL FIELD_DELETE(YL_ZSFSWDIR)
  IF (ASSOCIATED(YL_ZSFSWDIF)) CALL FIELD_DELETE(YL_ZSFSWDIF)
  IF (ASSOCIATED(YL_ZTRSODIR)) CALL FIELD_DELETE(YL_ZTRSODIR)
  IF (ASSOCIATED(YL_ZTRSODIF)) CALL FIELD_DELETE(YL_ZTRSODIF)
  IF (ASSOCIATED(YL_ZSUDU)) CALL FIELD_DELETE(YL_ZSUDU)
  IF (ASSOCIATED(YL_ZTHETAVS)) CALL FIELD_DELETE(YL_ZTHETAVS)
  IF (ASSOCIATED(YL_ZGEOSLC)) CALL FIELD_DELETE(YL_ZGEOSLC)
  IF (ASSOCIATED(YL_ZTENT)) CALL FIELD_DELETE(YL_ZTENT)
  IF (ASSOCIATED(YL_ZTHETAV)) CALL FIELD_DELETE(YL_ZTHETAV)
  IF (ASSOCIATED(YL_ZCOEFN)) CALL FIELD_DELETE(YL_ZCOEFN)
  IF (ASSOCIATED(YL_ZQLI_CVPP)) CALL FIELD_DELETE(YL_ZQLI_CVPP)
  IF (ASSOCIATED(YL_ZNEB_CVPP)) CALL FIELD_DELETE(YL_ZNEB_CVPP)
  IF (ASSOCIATED(YL_ZCFBTH)) CALL FIELD_DELETE(YL_ZCFBTH)
  IF (ASSOCIATED(YL_ZCFATH)) CALL FIELD_DELETE(YL_ZCFATH)
  IF (ASSOCIATED(YL_ZCFAU)) CALL FIELD_DELETE(YL_ZCFAU)
  IF (ASSOCIATED(YL_ZCFBU)) CALL FIELD_DELETE(YL_ZCFBU)
  IF (ASSOCIATED(YL_ZCFBV)) CALL FIELD_DELETE(YL_ZCFBV)
  IF (ASSOCIATED(YL_ZSRAIN)) CALL FIELD_DELETE(YL_ZSRAIN)
  IF (ASSOCIATED(YL_ZSSNOW)) CALL FIELD_DELETE(YL_ZSSNOW)
  IF (ASSOCIATED(YL_ZSGROUPEL)) CALL FIELD_DELETE(YL_ZSGROUPEL)
  IF (ASSOCIATED(YL_ZTSN)) CALL FIELD_DELETE(YL_ZTSN)
  IF (ASSOCIATED(YL_ZCE)) CALL FIELD_DELETE(YL_ZCE)
  IF (ASSOCIATED(YL_ZCEROV)) CALL FIELD_DELETE(YL_ZCEROV)
  IF (ASSOCIATED(YL_ZCRTI)) CALL FIELD_DELETE(YL_ZCRTI)
  IF (ASSOCIATED(YL_ZXURO)) CALL FIELD_DELETE(YL_ZXURO)
  IF (ASSOCIATED(YL_ZXQRO)) CALL FIELD_DELETE(YL_ZXQRO)
  IF (ASSOCIATED(YL_ZXTRO)) CALL FIELD_DELETE(YL_ZXTRO)
  IF (ASSOCIATED(YL_ZFLX_LOTT_GWU)) CALL FIELD_DELETE(YL_ZFLX_LOTT_GWU)
  IF (ASSOCIATED(YL_ZFLX_LOTT_GWV)) CALL FIELD_DELETE(YL_ZFLX_LOTT_GWV)
  IF (ASSOCIATED(YL_ZTKE1)) CALL FIELD_DELETE(YL_ZTKE1)
  IF (ASSOCIATED(YL_ZQGM)) CALL FIELD_DELETE(YL_ZQGM)
  IF (ASSOCIATED(YL_ZALPHA1)) CALL FIELD_DELETE(YL_ZALPHA1)
  IF (ASSOCIATED(YL_ZCOEFA)) CALL FIELD_DELETE(YL_ZCOEFA)
  IF (ASSOCIATED(YL_ZLVT)) CALL FIELD_DELETE(YL_ZLVT)
  IF (ASSOCIATED(YL_ZQICE)) CALL FIELD_DELETE(YL_ZQICE)
  IF (ASSOCIATED(YL_ZDIFWQ)) CALL FIELD_DELETE(YL_ZDIFWQ)
  IF (ASSOCIATED(YL_ZDIFWS)) CALL FIELD_DELETE(YL_ZDIFWS)
  IF (ASSOCIATED(YL_ZSC_FEVI)) CALL FIELD_DELETE(YL_ZSC_FEVI)
  IF (ASSOCIATED(YL_ZSC_FEVN)) CALL FIELD_DELETE(YL_ZSC_FEVN)
  IF (ASSOCIATED(YL_ZSC_FCLL)) CALL FIELD_DELETE(YL_ZSC_FCLL)
  IF (ASSOCIATED(YL_ZSC_FCLN)) CALL FIELD_DELETE(YL_ZSC_FCLN)
  IF (ASSOCIATED(YL_ZTRAJGWD)) CALL FIELD_DELETE(YL_ZTRAJGWD)
  IF (ASSOCIATED(YL_ZAIPCMT)) CALL FIELD_DELETE(YL_ZAIPCMT)
  IF (ASSOCIATED(YL_ZQIC)) CALL FIELD_DELETE(YL_ZQIC)
  IF (ASSOCIATED(YL_ZQLC)) CALL FIELD_DELETE(YL_ZQLC)
  IF (ASSOCIATED(YL_ZQLI_CVP)) CALL FIELD_DELETE(YL_ZQLI_CVP)
  IF (ASSOCIATED(YL_ZQC_DET_PCMT)) CALL FIELD_DELETE(YL_ZQC_DET_PCMT)
  IF (ASSOCIATED(YL_ZDCAPE)) CALL FIELD_DELETE(YL_ZDCAPE)
  IF (ASSOCIATED(YL_ZDECRD)) CALL FIELD_DELETE(YL_ZDECRD)
  IF (ASSOCIATED(YL_IMOC_CLPH)) CALL FIELD_DELETE(YL_IMOC_CLPH)
  IF (ASSOCIATED(YL_ZBAY_QRCONV)) CALL FIELD_DELETE(YL_ZBAY_QRCONV)
  IF (ASSOCIATED(YL_ZBAY_QSCONV)) CALL FIELD_DELETE(YL_ZBAY_QSCONV)
  IF (ASSOCIATED(YL_ZDSA_C1)) CALL FIELD_DELETE(YL_ZDSA_C1)
  IF (ASSOCIATED(YL_ZDSA_C2)) CALL FIELD_DELETE(YL_ZDSA_C2)
  IF (ASSOCIATED(YL_ZDSA_CPS)) CALL FIELD_DELETE(YL_ZDSA_CPS)
  IF (ASSOCIATED(YL_ZDSA_LHS)) CALL FIELD_DELETE(YL_ZDSA_LHS)
  IF (ASSOCIATED(YL_ZDSA_RS)) CALL FIELD_DELETE(YL_ZDSA_RS)
  IF (ASSOCIATED(YL_ZFLU_CDN)) CALL FIELD_DELETE(YL_ZFLU_CDN)
  IF (ASSOCIATED(YL_ZFLU_CD)) CALL FIELD_DELETE(YL_ZFLU_CD)
  IF (ASSOCIATED(YL_ZFLU_CH)) CALL FIELD_DELETE(YL_ZFLU_CH)
  IF (ASSOCIATED(YL_ZFLU_EMIS)) CALL FIELD_DELETE(YL_ZFLU_EMIS)
  IF (ASSOCIATED(YL_ZFLU_FEVI)) CALL FIELD_DELETE(YL_ZFLU_FEVI)
  IF (ASSOCIATED(YL_ZFLU_NEIJ)) CALL FIELD_DELETE(YL_ZFLU_NEIJ)
  IF (ASSOCIATED(YL_ZFLU_QSATS)) CALL FIELD_DELETE(YL_ZFLU_QSATS)
  IF (ASSOCIATED(YL_ZFLU_QSAT)) CALL FIELD_DELETE(YL_ZFLU_QSAT)
  IF (ASSOCIATED(YL_ZFLU_VEG)) CALL FIELD_DELETE(YL_ZFLU_VEG)
  IF (ASSOCIATED(YL_ZMSC_FRMQ)) CALL FIELD_DELETE(YL_ZMSC_FRMQ)
  IF (ASSOCIATED(YL_ZMSC_LH)) CALL FIELD_DELETE(YL_ZMSC_LH)
  IF (ASSOCIATED(YL_ZMSC_LSCPE)) CALL FIELD_DELETE(YL_ZMSC_LSCPE)
  IF (ASSOCIATED(YL_ZMSC_QW)) CALL FIELD_DELETE(YL_ZMSC_QW)
  IF (ASSOCIATED(YL_ZMSC_TW)) CALL FIELD_DELETE(YL_ZMSC_TW)
  IF (ASSOCIATED(YL_ZPFL_FEFB1)) CALL FIELD_DELETE(YL_ZPFL_FEFB1)
  IF (ASSOCIATED(YL_ZPFL_FEFB2)) CALL FIELD_DELETE(YL_ZPFL_FEFB2)
  IF (ASSOCIATED(YL_ZPFL_FEFB3)) CALL FIELD_DELETE(YL_ZPFL_FEFB3)
  IF (ASSOCIATED(YL_ZPFL_FPLCH)) CALL FIELD_DELETE(YL_ZPFL_FPLCH)
  IF (ASSOCIATED(YL_ZPFL_FPLSH)) CALL FIELD_DELETE(YL_ZPFL_FPLSH)
  IF (ASSOCIATED(YL_ZPFL_FTKEI)) CALL FIELD_DELETE(YL_ZPFL_FTKEI)
  IF (ASSOCIATED(YL_ZPFL_FTKE)) CALL FIELD_DELETE(YL_ZPFL_FTKE)
  IF (ASSOCIATED(YL_ZPRC_DPRECIPS2)) CALL FIELD_DELETE(YL_ZPRC_DPRECIPS2)
  IF (ASSOCIATED(YL_ZPRC_DPRECIPS)) CALL FIELD_DELETE(YL_ZPRC_DPRECIPS)
  IF (ASSOCIATED(YL_ZRDG_CVGQ)) CALL FIELD_DELETE(YL_ZRDG_CVGQ)
  IF (ASSOCIATED(YL_ZRDG_LCVQ)) CALL FIELD_DELETE(YL_ZRDG_LCVQ)
  IF (ASSOCIATED(YL_ZRDG_MU0LU)) CALL FIELD_DELETE(YL_ZRDG_MU0LU)
  IF (ASSOCIATED(YL_ZRDG_MU0M)) CALL FIELD_DELETE(YL_ZRDG_MU0M)
  IF (ASSOCIATED(YL_ZRDG_MU0N)) CALL FIELD_DELETE(YL_ZRDG_MU0N)
  IF (ASSOCIATED(YL_ZRDG_MU0)) CALL FIELD_DELETE(YL_ZRDG_MU0)
  IF (ASSOCIATED(YL_ZSAV_DDAL)) CALL FIELD_DELETE(YL_ZSAV_DDAL)
  IF (ASSOCIATED(YL_ZSAV_DDOM)) CALL FIELD_DELETE(YL_ZSAV_DDOM)
  IF (ASSOCIATED(YL_ZSAV_ENTCH)) CALL FIELD_DELETE(YL_ZSAV_ENTCH)
  IF (ASSOCIATED(YL_ZSAV_FHPS)) CALL FIELD_DELETE(YL_ZSAV_FHPS)
  IF (ASSOCIATED(YL_ZSAV_GZ0F)) CALL FIELD_DELETE(YL_ZSAV_GZ0F)
  IF (ASSOCIATED(YL_ZSAV_GZ0HF)) CALL FIELD_DELETE(YL_ZSAV_GZ0HF)
  IF (ASSOCIATED(YL_ZSAV_HV)) CALL FIELD_DELETE(YL_ZSAV_HV)
  IF (ASSOCIATED(YL_ZSAV_PBLH)) CALL FIELD_DELETE(YL_ZSAV_PBLH)
  IF (ASSOCIATED(YL_ZSAV_QSH)) CALL FIELD_DELETE(YL_ZSAV_QSH)
  IF (ASSOCIATED(YL_ZSAV_UDAL)) CALL FIELD_DELETE(YL_ZSAV_UDAL)
  IF (ASSOCIATED(YL_ZSAV_UDGRO)) CALL FIELD_DELETE(YL_ZSAV_UDGRO)
  IF (ASSOCIATED(YL_ZSAV_UDOM)) CALL FIELD_DELETE(YL_ZSAV_UDOM)
  IF (ASSOCIATED(YL_ZSAV_UNEBH)) CALL FIELD_DELETE(YL_ZSAV_UNEBH)
  IF (LHOOK) CALL DR_HOOK('DELETE_TEMPORARIES', 1, ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE', 1, ZHOOK_HANDLE)
  
END SUBROUTINE APL_ARPEGE
