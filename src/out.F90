SUBROUTINE APL_ARPEGE (YDMF_PHYS_BASE_STATE, YDMF_PHYS_NEXT_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDCPG_GPAR,  &
& YDCPG_PHY0, YDMF_PHYS, YDCPG_DYN0, YDMF_PHYS_SURF, YDCPG_SL2, YDVARS, YDMODEL, YDDDH)
  
  !**** *APL_ARPEGE*  - Call ARPEGE physics
  
  !     Author.
  !     -------
  !      Philippe Marguinaud *METEO-FRANCE*
  !      Original : 28-04-2021
  
  !     Modifications.
  !     --------------
  !     13-Jul-2022 R. El Khatib Fix initialization of ZQGM
  ! End Modifications
  !-------------------------------------------------------------------------------
  
#include "mf_phys_precips_openacc.intfb.h"
  USE ACPY_MOD
  USE STACK_MOD
  USE YOMPARALLELMETHOD
  USE FIELD_ACCESS_MODULE
  USE FIELD_FACTORY_MODULE
  USE FIELD_MODULE
#include "stack.h"
  USE GEOMETRY_MOD, ONLY: GEOMETRY
  USE MF_PHYS_TYPE_MOD, ONLY: MF_PHYS_TYPE
  USE CPG_TYPE_MOD, ONLY: CPG_MISC_TYPE, CPG_DYN_TYPE, CPG_GPAR_TYPE, CPG_PHY_TYPE
  USE CPG_SL2_TYPE_MOD, ONLY: CPG_SL2_TYPE
  USE CPG_OPTS_TYPE_MOD, ONLY: CPG_BNDS_TYPE, CPG_OPTS_TYPE
  USE MF_PHYS_SURFACE_TYPE_MOD, ONLY: MF_PHYS_SURF_TYPE
  USE FIELD_VARIABLES_MOD, ONLY: FIELD_VARIABLES
  USE MF_PHYS_BASE_STATE_TYPE_MOD, ONLY: MF_PHYS_BASE_STATE_TYPE
  USE MF_PHYS_NEXT_STATE_TYPE_MOD, ONLY: MF_PHYS_NEXT_STATE_TYPE
  USE TYPE_MODEL, ONLY: MODEL
  
  USE PARKIND1, ONLY: JPIM, JPRB
  USE YOMHOOK, ONLY: LHOOK, DR_HOOK, JPHOOK
  USE DDH_MIX, ONLY: TYP_DDH
  
  IMPLICIT NONE
  
  TYPE(MF_PHYS_BASE_STATE_TYPE), INTENT(IN) :: YDMF_PHYS_BASE_STATE
  TYPE(MF_PHYS_NEXT_STATE_TYPE), INTENT(INOUT) :: YDMF_PHYS_NEXT_STATE
  TYPE(GEOMETRY), INTENT(IN) :: YDGEOMETRY
  TYPE(CPG_BNDS_TYPE), INTENT(IN) :: YDCPG_BNDS
  TYPE(CPG_OPTS_TYPE), INTENT(IN) :: YDCPG_OPTS
  TYPE(CPG_MISC_TYPE), INTENT(INOUT) :: YDCPG_MISC
  TYPE(CPG_GPAR_TYPE), INTENT(INOUT) :: YDCPG_GPAR
  TYPE(CPG_PHY_TYPE), INTENT(IN) :: YDCPG_PHY0
  TYPE(MF_PHYS_TYPE), INTENT(INOUT) :: YDMF_PHYS
  TYPE(CPG_DYN_TYPE), INTENT(IN) :: YDCPG_DYN0
  TYPE(MF_PHYS_SURF_TYPE), INTENT(INOUT) :: YDMF_PHYS_SURF
  TYPE(CPG_SL2_TYPE), INTENT(INOUT) :: YDCPG_SL2
  TYPE(FIELD_VARIABLES), INTENT(INOUT) :: YDVARS
  TYPE(MODEL), INTENT(IN) :: YDMODEL
  TYPE(TYP_DDH), INTENT(INOUT) :: YDDDH
  
#include "accldia.intfb.h"
#include "acclph.intfb.h"
#include "acdnshf.intfb.h"
#include "acdrag.intfb.h"
#include "acdrme.intfb.h"
#include "acevadcape.intfb.h"
#include "achmt.intfb.h"
#include "achmtls.intfb.h"
#include "acpluis.intfb.h"
#include "acsol.intfb.h"
#include "actqsat.intfb.h"
#include "acvisih.intfb.h"
#include "aplpar_init.intfb.h"
#include "checkmv.intfb.h"
#include "cpphinp.intfb.h"
#include "cpqsol.intfb.h"
#include "mf_phys_bayrad.intfb.h"
#include "mf_phys_corwat.intfb.h"
#include "mf_phys_cvv.intfb.h"
#include "mf_phys_fpl_part1_parallel.intfb.h"
#include "mf_phys_fpl_part2_parallel.intfb.h"
#include "mf_phys_mocon_parallel.intfb.h"
#include "mf_phys_precips.intfb.h"
#include "mf_phys_save_phsurf_part1_parallel.intfb.h"
#include "mf_phys_save_phsurf_part2_parallel.intfb.h"
#include "mf_phys_transfer_parallel.intfb.h"
#include "ppwetpoint.intfb.h"
#include "qngcor.intfb.h"
#include "aplpar_flexdia_parallel.intfb.h"
#include "apl_arpege_oceanic_fluxes_parallel.intfb.h"
#include "apl_wind_gust_parallel.intfb.h"
#include "apl_arpege_shallow_convection_and_turbulence_parallel.intfb.h"
#include "apl_arpege_albedo_computation_parallel.intfb.h"
#include "apl_arpege_aerosols_for_radiation_parallel.intfb.h"
#include "apl_arpege_cloudiness_parallel.intfb.h"
#include "apl_arpege_radiation_parallel.intfb.h"
#include "apl_arpege_soil_hydro_parallel.intfb.h"
#include "apl_arpege_surface_parallel.intfb.h"
#include "apl_arpege_deep_convection_parallel.intfb.h"
#include "apl_arpege_precipitation_parallel.intfb.h"
#include "apl_arpege_hydro_budget_parallel.intfb.h"
#include "apl_arpege_surface_update_parallel.intfb.h"
#include "apl_arpege_atmosphere_update_parallel.intfb.h"
#include "apl_arpege_init_parallel.intfb.h"
#include "apl_arpege_init_surfex_parallel.intfb.h"
#include "apl_arpege_dprecips_parallel.intfb.h"
  
  
  CLASS(FIELD_4RB), POINTER :: YL_ZDIFEXT => NULL()
  REAL(KIND=JPRB), POINTER :: ZDIFEXT(:, :, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_INLAB_CVPP => NULL()
  INTEGER(KIND=JPIM), POINTER :: INLAB_CVPP(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZXTROV => NULL()
  REAL(KIND=JPRB), POINTER :: ZXTROV(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZXUROV => NULL()
  REAL(KIND=JPRB), POINTER :: ZXUROV(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZMRIPP => NULL()
  REAL(KIND=JPRB), POINTER :: ZMRIPP(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZKTROV => NULL()
  REAL(KIND=JPRB), POINTER :: ZKTROV(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZKUROV => NULL()
  REAL(KIND=JPRB), POINTER :: ZKUROV(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZNBVNO => NULL()
  REAL(KIND=JPRB), POINTER :: ZNBVNO(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZKQROV => NULL()
  REAL(KIND=JPRB), POINTER :: ZKQROV(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZKQLROV => NULL()
  REAL(KIND=JPRB), POINTER :: ZKQLROV(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZNEBS => NULL()
  REAL(KIND=JPRB), POINTER :: ZNEBS(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZQLIS => NULL()
  REAL(KIND=JPRB), POINTER :: ZQLIS(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZNEBS0 => NULL()
  REAL(KIND=JPRB), POINTER :: ZNEBS0(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZQLIS0 => NULL()
  REAL(KIND=JPRB), POINTER :: ZQLIS0(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZNEBC0 => NULL()
  REAL(KIND=JPRB), POINTER :: ZNEBC0(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZNEBDIFF => NULL()
  REAL(KIND=JPRB), POINTER :: ZNEBDIFF(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZNEBCH => NULL()
  REAL(KIND=JPRB), POINTER :: ZNEBCH(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZUNEBH => NULL()
  REAL(KIND=JPRB), POINTER :: ZUNEBH(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZFPCOR => NULL()
  REAL(KIND=JPRB), POINTER :: ZFPCOR(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZPOID => NULL()
  REAL(KIND=JPRB), POINTER :: ZPOID(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZQV => NULL()
  REAL(KIND=JPRB), POINTER :: ZQV(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZQI => NULL()
  REAL(KIND=JPRB), POINTER :: ZQI(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZQL => NULL()
  REAL(KIND=JPRB), POINTER :: ZQL(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZQR => NULL()
  REAL(KIND=JPRB), POINTER :: ZQR(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZQS => NULL()
  REAL(KIND=JPRB), POINTER :: ZQS(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZTENHA => NULL()
  REAL(KIND=JPRB), POINTER :: ZTENHA(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZTENQVA => NULL()
  REAL(KIND=JPRB), POINTER :: ZTENQVA(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZCP => NULL()
  REAL(KIND=JPRB), POINTER :: ZCP(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZFPLSL => NULL()
  REAL(KIND=JPRB), POINTER :: ZFPLSL(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZFPLSN => NULL()
  REAL(KIND=JPRB), POINTER :: ZFPLSN(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZSEDIQL => NULL()
  REAL(KIND=JPRB), POINTER :: ZSEDIQL(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZSEDIQI => NULL()
  REAL(KIND=JPRB), POINTER :: ZSEDIQI(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZDIFCVPPQ => NULL()
  REAL(KIND=JPRB), POINTER :: ZDIFCVPPQ(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZDIFCVPPS => NULL()
  REAL(KIND=JPRB), POINTER :: ZDIFCVPPS(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZDIFCVPPU => NULL()
  REAL(KIND=JPRB), POINTER :: ZDIFCVPPU(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZDIFCVPPV => NULL()
  REAL(KIND=JPRB), POINTER :: ZDIFCVPPV(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZEDMFQ => NULL()
  REAL(KIND=JPRB), POINTER :: ZEDMFQ(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZEDMFS => NULL()
  REAL(KIND=JPRB), POINTER :: ZEDMFS(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZEDMFU => NULL()
  REAL(KIND=JPRB), POINTER :: ZEDMFU(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZEDMFV => NULL()
  REAL(KIND=JPRB), POINTER :: ZEDMFV(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZMF_UP => NULL()
  REAL(KIND=JPRB), POINTER :: ZMF_UP(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZCONDCVPPL => NULL()
  REAL(KIND=JPRB), POINTER :: ZCONDCVPPL(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZCONDCVPPI => NULL()
  REAL(KIND=JPRB), POINTER :: ZCONDCVPPI(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZPRODTH_CVPP => NULL()
  REAL(KIND=JPRB), POINTER :: ZPRODTH_CVPP(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZDE2MR => NULL()
  REAL(KIND=JPRB), POINTER :: ZDE2MR(:, :, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZXDROV => NULL()
  REAL(KIND=JPRB), POINTER :: ZXDROV(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZXHROV => NULL()
  REAL(KIND=JPRB), POINTER :: ZXHROV(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZUGST => NULL()
  REAL(KIND=JPRB), POINTER :: ZUGST(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZVGST => NULL()
  REAL(KIND=JPRB), POINTER :: ZVGST(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZCDROV => NULL()
  REAL(KIND=JPRB), POINTER :: ZCDROV(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZCHROV => NULL()
  REAL(KIND=JPRB), POINTER :: ZCHROV(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZDQSTS => NULL()
  REAL(KIND=JPRB), POINTER :: ZDQSTS(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZGWDCS => NULL()
  REAL(KIND=JPRB), POINTER :: ZGWDCS(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZHQ => NULL()
  REAL(KIND=JPRB), POINTER :: ZHQ(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZHU => NULL()
  REAL(KIND=JPRB), POINTER :: ZHU(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZHTR => NULL()
  REAL(KIND=JPRB), POINTER :: ZHTR(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZRTI => NULL()
  REAL(KIND=JPRB), POINTER :: ZRTI(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZDPHI => NULL()
  REAL(KIND=JPRB), POINTER :: ZDPHI(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZPRS => NULL()
  REAL(KIND=JPRB), POINTER :: ZPRS(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSTAB => NULL()
  REAL(KIND=JPRB), POINTER :: ZSTAB(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZWFC => NULL()
  REAL(KIND=JPRB), POINTER :: ZWFC(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZWPMX => NULL()
  REAL(KIND=JPRB), POINTER :: ZWPMX(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZWLMX => NULL()
  REAL(KIND=JPRB), POINTER :: ZWLMX(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZWSEQ => NULL()
  REAL(KIND=JPRB), POINTER :: ZWSEQ(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZWSMX => NULL()
  REAL(KIND=JPRB), POINTER :: ZWSMX(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZWWILT => NULL()
  REAL(KIND=JPRB), POINTER :: ZWWILT(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZC3 => NULL()
  REAL(KIND=JPRB), POINTER :: ZC3(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZCG => NULL()
  REAL(KIND=JPRB), POINTER :: ZCG(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZCN => NULL()
  REAL(KIND=JPRB), POINTER :: ZCN(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZNEIJG => NULL()
  REAL(KIND=JPRB), POINTER :: ZNEIJG(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZNEIJV => NULL()
  REAL(KIND=JPRB), POINTER :: ZNEIJV(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZPCLS => NULL()
  REAL(KIND=JPRB), POINTER :: ZPCLS(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZBLH => NULL()
  REAL(KIND=JPRB), POINTER :: ZBLH(:, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZQO3 => NULL()
  REAL(KIND=JPRB), POINTER :: ZQO3(:, :, :) => NULL()
  CLASS(FIELD_4RB), POINTER :: YL_ZAER => NULL()
  REAL(KIND=JPRB), POINTER :: ZAER(:, :, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZAERINDS => NULL()
  REAL(KIND=JPRB), POINTER :: ZAERINDS(:, :, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZDPHIV => NULL()
  REAL(KIND=JPRB), POINTER :: ZDPHIV(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZDPHIT => NULL()
  REAL(KIND=JPRB), POINTER :: ZDPHIT(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZTRSOD => NULL()
  REAL(KIND=JPRB), POINTER :: ZTRSOD(:, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZCEMTR => NULL()
  REAL(KIND=JPRB), POINTER :: ZCEMTR(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZCTRSO => NULL()
  REAL(KIND=JPRB), POINTER :: ZCTRSO(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZALBD => NULL()
  REAL(KIND=JPRB), POINTER :: ZALBD(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZALBP => NULL()
  REAL(KIND=JPRB), POINTER :: ZALBP(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZSFSWDIR => NULL()
  REAL(KIND=JPRB), POINTER :: ZSFSWDIR(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZSFSWDIF => NULL()
  REAL(KIND=JPRB), POINTER :: ZSFSWDIF(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZTRSODIR => NULL()
  REAL(KIND=JPRB), POINTER :: ZTRSODIR(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZTRSODIF => NULL()
  REAL(KIND=JPRB), POINTER :: ZTRSODIF(:, :, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSUDU => NULL()
  REAL(KIND=JPRB), POINTER :: ZSUDU(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZTHETAVS => NULL()
  REAL(KIND=JPRB), POINTER :: ZTHETAVS(:, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZGEOSLC => NULL()
  REAL(KIND=JPRB), POINTER :: ZGEOSLC(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZTENT => NULL()
  REAL(KIND=JPRB), POINTER :: ZTENT(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZTHETAV => NULL()
  REAL(KIND=JPRB), POINTER :: ZTHETAV(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZCOEFN => NULL()
  REAL(KIND=JPRB), POINTER :: ZCOEFN(:, :, :) => NULL()
  
  ! LOCAL ARRAYS FOR ACVPPKF
  CLASS(FIELD_3RB), POINTER :: YL_ZQLI_CVPP => NULL()
  REAL(KIND=JPRB), POINTER :: ZQLI_CVPP(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZNEB_CVPP => NULL()
  REAL(KIND=JPRB), POINTER :: ZNEB_CVPP(:, :, :) => NULL()
  
  ! Implicit coupling coefficients
  CLASS(FIELD_3RB), POINTER :: YL_ZCFBTH => NULL()
  REAL(KIND=JPRB), POINTER :: ZCFBTH(:, :, :) => NULL()
  REAL(KIND=JPRB) :: ZDTMSE
  REAL(KIND=JPRB) :: ZRHGMT
  REAL(KIND=JPRB) :: ZSTATI
  CLASS(FIELD_3RB), POINTER :: YL_ZCFATH => NULL()
  REAL(KIND=JPRB), POINTER :: ZCFATH(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZCFAU => NULL()
  REAL(KIND=JPRB), POINTER :: ZCFAU(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZCFBU => NULL()
  REAL(KIND=JPRB), POINTER :: ZCFBU(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZCFBV => NULL()
  REAL(KIND=JPRB), POINTER :: ZCFBV(:, :, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSRAIN => NULL()
  REAL(KIND=JPRB), POINTER :: ZSRAIN(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSSNOW => NULL()
  REAL(KIND=JPRB), POINTER :: ZSSNOW(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSGROUPEL => NULL()
  REAL(KIND=JPRB), POINTER :: ZSGROUPEL(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZTSN => NULL()
  REAL(KIND=JPRB), POINTER :: ZTSN(:, :) => NULL()
  
  !         ACFLUSO (ECUME) local variable
  REAL(KIND=JPRB) :: ZCE(YDCPG_OPTS%KLON)
  CLASS(FIELD_2RB), POINTER :: YL_ZCEROV => NULL()
  REAL(KIND=JPRB), POINTER :: ZCEROV(:, :) => NULL()
  REAL(KIND=JPRB) :: ZCRTI(YDCPG_OPTS%KLON)
  
  !        New ACDIFV1 local variable
  CLASS(FIELD_3RB), POINTER :: YL_ZXURO => NULL()
  REAL(KIND=JPRB), POINTER :: ZXURO(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZXQRO => NULL()
  REAL(KIND=JPRB), POINTER :: ZXQRO(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZXTRO => NULL()
  REAL(KIND=JPRB), POINTER :: ZXTRO(:, :, :) => NULL()
  
  !        New ACNORGWD local variables
  CLASS(FIELD_3RB), POINTER :: YL_ZFLX_LOTT_GWU => NULL()
  REAL(KIND=JPRB), POINTER :: ZFLX_LOTT_GWU(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZFLX_LOTT_GWV => NULL()
  REAL(KIND=JPRB), POINTER :: ZFLX_LOTT_GWV(:, :, :) => NULL()
  
  !    TKE+ for ACCLDIA
  CLASS(FIELD_3RB), POINTER :: YL_ZTKE1 => NULL()
  REAL(KIND=JPRB), POINTER :: ZTKE1(:, :, :) => NULL()
  
  !   For ACVISIH
  CLASS(FIELD_3RB), POINTER :: YL_ZQGM => NULL()
  REAL(KIND=JPRB), POINTER :: ZQGM(:, :, :) => NULL()
  
  
  !        New ARP_GROUND_PARAM local variable
  CLASS(FIELD_3RB), POINTER :: YL_ZALPHA1 => NULL()
  REAL(KIND=JPRB), POINTER :: ZALPHA1(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZCOEFA => NULL()
  REAL(KIND=JPRB), POINTER :: ZCOEFA(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZLVT => NULL()
  REAL(KIND=JPRB), POINTER :: ZLVT(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZQICE => NULL()
  REAL(KIND=JPRB), POINTER :: ZQICE(:, :, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZDIFWQ => NULL()
  REAL(KIND=JPRB), POINTER :: ZDIFWQ(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZDIFWS => NULL()
  REAL(KIND=JPRB), POINTER :: ZDIFWS(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSC_FEVI => NULL()
  REAL(KIND=JPRB), POINTER :: ZSC_FEVI(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSC_FEVN => NULL()
  REAL(KIND=JPRB), POINTER :: ZSC_FEVN(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSC_FCLL => NULL()
  REAL(KIND=JPRB), POINTER :: ZSC_FCLL(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSC_FCLN => NULL()
  REAL(KIND=JPRB), POINTER :: ZSC_FCLN(:, :) => NULL()
  
  !           TRAJECTORY (For diffusion !) local VARIABLES
  CLASS(FIELD_3RB), POINTER :: YL_ZTRAJGWD => NULL()
  REAL(KIND=JPRB), POINTER :: ZTRAJGWD(:, :, :) => NULL()
  
  CLASS(FIELD_2RB), POINTER :: YL_ZAIPCMT => NULL()
  REAL(KIND=JPRB), POINTER :: ZAIPCMT(:, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZQIC => NULL()
  REAL(KIND=JPRB), POINTER :: ZQIC(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZQLC => NULL()
  REAL(KIND=JPRB), POINTER :: ZQLC(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZQLI_CVP => NULL()
  REAL(KIND=JPRB), POINTER :: ZQLI_CVP(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZQC_DET_PCMT => NULL()
  REAL(KIND=JPRB), POINTER :: ZQC_DET_PCMT(:, :, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZDCAPE => NULL()
  REAL(KIND=JPRB), POINTER :: ZDCAPE(:, :) => NULL()
  
  ! ACRANEB/ACRANEB2 local variables
  CLASS(FIELD_2RB), POINTER :: YL_ZDECRD => NULL()
  REAL(KIND=JPRB), POINTER :: ZDECRD(:, :) => NULL()
  
  ! Precipitation type diagnostics
  CLASS(FIELD_2RB), POINTER :: YL_IMOC_CLPH => NULL()
  INTEGER(KIND=JPIM), POINTER :: IMOC_CLPH(:, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZBAY_QRCONV => NULL()
  REAL(KIND=JPRB), POINTER :: ZBAY_QRCONV(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZBAY_QSCONV => NULL()
  REAL(KIND=JPRB), POINTER :: ZBAY_QSCONV(:, :, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZDSA_C1 => NULL()
  REAL(KIND=JPRB), POINTER :: ZDSA_C1(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZDSA_C2 => NULL()
  REAL(KIND=JPRB), POINTER :: ZDSA_C2(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZDSA_CPS => NULL()
  REAL(KIND=JPRB), POINTER :: ZDSA_CPS(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZDSA_LHS => NULL()
  REAL(KIND=JPRB), POINTER :: ZDSA_LHS(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZDSA_RS => NULL()
  REAL(KIND=JPRB), POINTER :: ZDSA_RS(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_CDN => NULL()
  REAL(KIND=JPRB), POINTER :: ZFLU_CDN(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_CD => NULL()
  REAL(KIND=JPRB), POINTER :: ZFLU_CD(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_CH => NULL()
  REAL(KIND=JPRB), POINTER :: ZFLU_CH(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_EMIS => NULL()
  REAL(KIND=JPRB), POINTER :: ZFLU_EMIS(:, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZFLU_FEVI => NULL()
  REAL(KIND=JPRB), POINTER :: ZFLU_FEVI(:, :, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_NEIJ => NULL()
  REAL(KIND=JPRB), POINTER :: ZFLU_NEIJ(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_QSATS => NULL()
  REAL(KIND=JPRB), POINTER :: ZFLU_QSATS(:, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZFLU_QSAT => NULL()
  REAL(KIND=JPRB), POINTER :: ZFLU_QSAT(:, :, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZFLU_VEG => NULL()
  REAL(KIND=JPRB), POINTER :: ZFLU_VEG(:, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZMSC_FRMQ => NULL()
  REAL(KIND=JPRB), POINTER :: ZMSC_FRMQ(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZMSC_LH => NULL()
  REAL(KIND=JPRB), POINTER :: ZMSC_LH(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZMSC_LSCPE => NULL()
  REAL(KIND=JPRB), POINTER :: ZMSC_LSCPE(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZMSC_QW => NULL()
  REAL(KIND=JPRB), POINTER :: ZMSC_QW(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZMSC_TW => NULL()
  REAL(KIND=JPRB), POINTER :: ZMSC_TW(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FEFB1 => NULL()
  REAL(KIND=JPRB), POINTER :: ZPFL_FEFB1(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FEFB2 => NULL()
  REAL(KIND=JPRB), POINTER :: ZPFL_FEFB2(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FEFB3 => NULL()
  REAL(KIND=JPRB), POINTER :: ZPFL_FEFB3(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FPLCH => NULL()
  REAL(KIND=JPRB), POINTER :: ZPFL_FPLCH(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FPLSH => NULL()
  REAL(KIND=JPRB), POINTER :: ZPFL_FPLSH(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FTKEI => NULL()
  REAL(KIND=JPRB), POINTER :: ZPFL_FTKEI(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZPFL_FTKE => NULL()
  REAL(KIND=JPRB), POINTER :: ZPFL_FTKE(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZPRC_DPRECIPS2 => NULL()
  REAL(KIND=JPRB), POINTER :: ZPRC_DPRECIPS2(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZPRC_DPRECIPS => NULL()
  REAL(KIND=JPRB), POINTER :: ZPRC_DPRECIPS(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZRDG_CVGQ => NULL()
  REAL(KIND=JPRB), POINTER :: ZRDG_CVGQ(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZRDG_LCVQ => NULL()
  REAL(KIND=JPRB), POINTER :: ZRDG_LCVQ(:, :, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZRDG_MU0LU => NULL()
  REAL(KIND=JPRB), POINTER :: ZRDG_MU0LU(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZRDG_MU0M => NULL()
  REAL(KIND=JPRB), POINTER :: ZRDG_MU0M(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZRDG_MU0N => NULL()
  REAL(KIND=JPRB), POINTER :: ZRDG_MU0N(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZRDG_MU0 => NULL()
  REAL(KIND=JPRB), POINTER :: ZRDG_MU0(:, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZSAV_DDAL => NULL()
  REAL(KIND=JPRB), POINTER :: ZSAV_DDAL(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZSAV_DDOM => NULL()
  REAL(KIND=JPRB), POINTER :: ZSAV_DDOM(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZSAV_ENTCH => NULL()
  REAL(KIND=JPRB), POINTER :: ZSAV_ENTCH(:, :, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_FHPS => NULL()
  REAL(KIND=JPRB), POINTER :: ZSAV_FHPS(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_GZ0F => NULL()
  REAL(KIND=JPRB), POINTER :: ZSAV_GZ0F(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_GZ0HF => NULL()
  REAL(KIND=JPRB), POINTER :: ZSAV_GZ0HF(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_HV => NULL()
  REAL(KIND=JPRB), POINTER :: ZSAV_HV(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_PBLH => NULL()
  REAL(KIND=JPRB), POINTER :: ZSAV_PBLH(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_QSH => NULL()
  REAL(KIND=JPRB), POINTER :: ZSAV_QSH(:, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZSAV_UDAL => NULL()
  REAL(KIND=JPRB), POINTER :: ZSAV_UDAL(:, :, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZSAV_UDGRO => NULL()
  REAL(KIND=JPRB), POINTER :: ZSAV_UDGRO(:, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZSAV_UDOM => NULL()
  REAL(KIND=JPRB), POINTER :: ZSAV_UDOM(:, :, :) => NULL()
  CLASS(FIELD_3RB), POINTER :: YL_ZSAV_UNEBH => NULL()
  REAL(KIND=JPRB), POINTER :: ZSAV_UNEBH(:, :, :) => NULL()
  
  INTEGER(KIND=JPIM) :: INSTEP_DEB
  INTEGER(KIND=JPIM) :: INSTEP_FIN
  INTEGER(KIND=JPIM) :: JLEV
  INTEGER(KIND=JPIM) :: JLON
  INTEGER(KIND=JPIM) :: JSPP
  LOGICAL :: LLCLS
  LOGICAL :: LLHMT
  LOGICAL :: LLREDPR
  REAL(KIND=JPRB) :: ZEPS0
  REAL(KIND=JPRB) :: ZEPSNEB
  REAL(KIND=JPRB) :: ZRVMD
  
  REAL(KIND=JPHOOK) :: ZHOOK_HANDLE
  TYPE(CPG_BNDS_TYPE), INTENT(IN) :: YLCPG_BNDS
  TYPE(STACK) :: YLSTACK
  INTEGER(KIND=JPIM) :: JBLK
  REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
  REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
  REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_DYN0_CTY_EVEL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_Q_DM(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVGQ_DM(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_Q_DL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_PHY0_XYB_RDELP(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVGQ_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GEMU_T0(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GELAM_T0(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVGQ_DL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_Q_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_T(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_Q(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_MISC_RH(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PLAI(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PIVEG(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CT(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PSAB(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PARG(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PD2(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_GZ0(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_MISC_QS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_V(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_GZ0H(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_U(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_NUCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_RHCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_UGST(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_UCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_TCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_QCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VGST(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_NVCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PHV(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VEIN(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CLPH(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTS(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRTU(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRTV(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQ(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRTH(:, :, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRTHDS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRSOPT(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRDU(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCSQN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PGETRL(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPSL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCSQL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPSL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPSN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPSN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLSL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_RCORI_T0(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLSN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DRNSHF(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRDV(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPCN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPCN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPCL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCCQL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLSG(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQ(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPCL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCCQN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQNG(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_MISC_NEB(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_MISC_QLI(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRMU(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_IRAD_T1(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_LRAD_T1(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_MISC_QICE(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRMH(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_A_T1(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRMV(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLCL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLCN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CAPE(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_OROG_T0(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VISIHYD(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VISICLD(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_MXCLWC(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_L(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_TPWCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_I(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PPCN(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEVL(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PPSL(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PPSN(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PEVA(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEVN(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PPCL(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_PHY0_PREHYD(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSP_RR_PT_T0(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDCPG_MISC_QSOL(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVV_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVV_T1(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_SCONV_T1(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_RCONV_T1(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_DI_PXEDR(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_EDR(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_SPF_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_CPF_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_DOM_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PPBLH(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_UNEBH_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PQSH(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_UAL_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VK_PUDGRO(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PSPSH(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_DAL_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_UEN_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_UOM_T0(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_CPF_T1(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDVARS_SPF_T1(:, :, :)
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE', 0, ZHOOK_HANDLE)
  IF (LHOOK) CALL DR_HOOK('CREATE_TEMPORARIES', 0, ZHOOK_HANDLE_FIELD_API)
  
  CALL FIELD_NEW(YL_ZRDG_MU0LU, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZRDG_CVGQ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZRDG_MU0, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZRDG_MU0M, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZRDG_MU0N, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZRDG_LCVQ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_QSATS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMSC_LSCPE, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FEFB2, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMSC_LH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDSA_C2, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FEFB3, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_IMOC_CLPH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDSA_C1, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FEFB1, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_CH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_NEIJ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_CD, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMSC_FRMQ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_EMIS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDSA_LHS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FTKEI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_VEG, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDSA_RS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMSC_QW, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FTKE, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_CDN, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_FEVI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KTSSG + 1, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLU_QSAT, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDSA_CPS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMSC_TW, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZGEOSLC, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEIJV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZWSMX, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCN, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCG, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZWFC, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZC3, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEIJG, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZWWILT, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZWSEQ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZWPMX, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDPHIV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDPHIT, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPCLS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMRIPP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNBVNO, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZGWDCS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDPHI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZRTI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPRS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FPLSH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZHU, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCDROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDQSTS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPFL_FPLCH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSTAB, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZHQ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXDROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCHROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXHROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTHETAV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZBLH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTHETAVS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZVGST, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZUGST, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDIFCVPPU, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDIFCVPPS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDIFCVPPV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDIFCVPPQ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEBS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTRAJGWD, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQLIS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFPLSL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSEDIQI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLX_LOTT_GWV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSEDIQL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFPLSN, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFLX_LOTT_GWU, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZFPCOR, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTKE1, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDCAPE, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQGM, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQR, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZBAY_QRCONV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZBAY_QSCONV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDE2MR, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPRC_DPRECIPS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%NDTPREC, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPRC_DPRECIPS2, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%NDTPREC2, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_PBLH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_HV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_QSH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_ENTCH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_GZ0HF, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_FHPS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_UDAL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_UDOM, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_UNEBH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_DDAL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_GZ0F, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_DDOM, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 1 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSAV_UDGRO, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTENHA, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZLVT, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCFBU, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSFSWDIR, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KSW, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCFATH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZAERINDS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSC_FEVN, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCONDCVPPL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEB_CVPP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCEMTR, UBOUNDS=(/ YDCPG_OPTS%KLON, 1, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZUNEBH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZKQROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZEDMFQ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTENQVA, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCFAU, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXQRO, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXTRO, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCTRSO, UBOUNDS=(/ YDCPG_OPTS%KLON, 1, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEBCH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSC_FEVI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZALBP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KSW, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTRSODIR, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KSW, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZAIPCMT, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQIC, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSC_FCLL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTRSOD, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTENT, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXUROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZEDMFS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZMF_UP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQLI_CVPP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZKUROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCONDCVPPI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTRSODIF, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KSW, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_INLAB_CVPP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQLI_CVP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQLIS0, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZEDMFV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZEDMFU, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZKQLROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDECRD, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDIFWS, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCFBV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXURO, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPRODTH_CVPP, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQLC, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZALPHA1, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCOEFA, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEBDIFF, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSFSWDIF, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KSW, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCFBTH, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEBS0, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDIFWQ, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZALBD, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KSW, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZKTROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZNEBC0, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZPOID, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZAER, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, 6, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSUDU, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQO3, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQICE, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZQC_DET_PCMT, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZXTROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), LBOUNDS=(/ 0, 0 /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSC_FCLN, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSGROUPEL, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSSNOW, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZTSN, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZSRAIN, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCEROV, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCOEFN, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZHTR, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZWLMX, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZDIFEXT,  &
  & UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_GCONF%YGFL%NGFL_EXT, YDCPG_OPTS%KGPBLKS /), PERSISTENT=.true.)
  IF (LHOOK) CALL DR_HOOK('CREATE_TEMPORARIES', 1, ZHOOK_HANDLE_FIELD_API)
  
  
  
  
  
  INSTEP_DEB = 1
  INSTEP_FIN = 1
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:CPPHINP')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0LU => GET_HOST_DATA_RDWR(YL_ZRDG_MU0LU)
    ZRDG_CVGQ => GET_HOST_DATA_RDWR(YL_ZRDG_CVGQ)
    ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
    ZRDG_MU0M => GET_HOST_DATA_RDWR(YL_ZRDG_MU0M)
    ZRDG_MU0N => GET_HOST_DATA_RDWR(YL_ZRDG_MU0N)
    Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR(YDCPG_DYN0%CTY%F_EVEL)
    Z_YDVARS_Q_DM => GET_HOST_DATA_RDWR(YDVARS%Q%FDM)
    Z_YDVARS_CVGQ_DM => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FDM)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR(YDVARS%U%FT0)
    Z_YDVARS_Q_DL => GET_HOST_DATA_RDWR(YDVARS%Q%FDL)
    Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR(YDCPG_PHY0%XYB%F_RDELP)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR(YDVARS%V%FT0)
    Z_YDVARS_CVGQ_T0 => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FT0)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%FT0)
    Z_YDVARS_CVGQ_DL => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FDL)
    Z_YDVARS_Q_T0 => GET_HOST_DATA_RDWR(YDVARS%Q%FT0)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL CPPHINP(YDGEOMETRY, YDMODEL, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK),  &
      & Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_U_T0(:, :, JBLK), Z_YDVARS_V_T0(:, :, JBLK), Z_YDVARS_Q_T0(:, :, JBLK),  &
      & Z_YDVARS_Q_DL(:, :, JBLK), Z_YDVARS_Q_DM(:, :, JBLK), Z_YDVARS_CVGQ_DL(:, :, JBLK), Z_YDVARS_CVGQ_DM(:, :, JBLK),  &
      & Z_YDCPG_PHY0_XYB_RDELP(:, :, JBLK), Z_YDCPG_DYN0_CTY_EVEL(:, :, JBLK), Z_YDVARS_CVGQ_T0(:, :, JBLK), ZRDG_MU0(:, JBLK),  &
      & ZRDG_MU0LU(:, JBLK), ZRDG_MU0M(:, JBLK), ZRDG_MU0N(:, JBLK), ZRDG_CVGQ(:, :, JBLK))
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:CPPHINP')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_MU0LU => GET_HOST_DATA_RDWR(YL_ZRDG_MU0LU)
      ZRDG_CVGQ => GET_HOST_DATA_RDWR(YL_ZRDG_CVGQ)
      ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
      ZRDG_MU0M => GET_HOST_DATA_RDWR(YL_ZRDG_MU0M)
      ZRDG_MU0N => GET_HOST_DATA_RDWR(YL_ZRDG_MU0N)
      Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR(YDCPG_DYN0%CTY%F_EVEL)
      Z_YDVARS_Q_DM => GET_HOST_DATA_RDWR(YDVARS%Q%FDM)
      Z_YDVARS_CVGQ_DM => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FDM)
      Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR(YDVARS%U%FT0)
      Z_YDVARS_Q_DL => GET_HOST_DATA_RDWR(YDVARS%Q%FDL)
      Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR(YDCPG_PHY0%XYB%F_RDELP)
      Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR(YDVARS%V%FT0)
      Z_YDVARS_CVGQ_T0 => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FT0)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%FT0)
      Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%FT0)
      Z_YDVARS_CVGQ_DL => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FDL)
      Z_YDVARS_Q_T0 => GET_HOST_DATA_RDWR(YDVARS%Q%FT0)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0LU => NULL()
    ZRDG_CVGQ => NULL()
    ZRDG_MU0 => NULL()
    ZRDG_MU0M => NULL()
    ZRDG_MU0N => NULL()
    Z_YDCPG_DYN0_CTY_EVEL => NULL()
    Z_YDVARS_Q_DM => NULL()
    Z_YDVARS_CVGQ_DM => NULL()
    Z_YDVARS_U_T0 => NULL()
    Z_YDVARS_Q_DL => NULL()
    Z_YDCPG_PHY0_XYB_RDELP => NULL()
    Z_YDVARS_V_T0 => NULL()
    Z_YDVARS_CVGQ_T0 => NULL()
    Z_YDVARS_GEOMETRY_GEMU_T0 => NULL()
    Z_YDVARS_GEOMETRY_GELAM_T0 => NULL()
    Z_YDVARS_CVGQ_DL => NULL()
    Z_YDVARS_Q_T0 => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:CPPHINP')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0LU => GET_HOST_DATA_RDWR(YL_ZRDG_MU0LU)
    ZRDG_CVGQ => GET_HOST_DATA_RDWR(YL_ZRDG_CVGQ)
    ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
    ZRDG_MU0M => GET_HOST_DATA_RDWR(YL_ZRDG_MU0M)
    ZRDG_MU0N => GET_HOST_DATA_RDWR(YL_ZRDG_MU0N)
    Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR(YDCPG_DYN0%CTY%F_EVEL)
    Z_YDVARS_Q_DM => GET_HOST_DATA_RDWR(YDVARS%Q%FDM)
    Z_YDVARS_CVGQ_DM => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FDM)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR(YDVARS%U%FT0)
    Z_YDVARS_Q_DL => GET_HOST_DATA_RDWR(YDVARS%Q%FDL)
    Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR(YDCPG_PHY0%XYB%F_RDELP)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR(YDVARS%V%FT0)
    Z_YDVARS_CVGQ_T0 => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FT0)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%FT0)
    Z_YDVARS_CVGQ_DL => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FDL)
    Z_YDVARS_Q_T0 => GET_HOST_DATA_RDWR(YDVARS%Q%FT0)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL CPPHINP_OPENACC(YDGEOMETRY, YDMODEL, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK),  &
        & Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_U_T0(:, :, JBLK), Z_YDVARS_V_T0(:, :, JBLK), Z_YDVARS_Q_T0(:, :, JBLK),  &
        & Z_YDVARS_Q_DL(:, :, JBLK), Z_YDVARS_Q_DM(:, :, JBLK), Z_YDVARS_CVGQ_DL(:, :, JBLK), Z_YDVARS_CVGQ_DM(:, :, JBLK),  &
        & Z_YDCPG_PHY0_XYB_RDELP(:, :, JBLK), Z_YDCPG_DYN0_CTY_EVEL(:, :, JBLK), Z_YDVARS_CVGQ_T0(:, :, JBLK),  &
        & ZRDG_MU0(:, JBLK), ZRDG_MU0LU(:, JBLK), ZRDG_MU0M(:, JBLK), ZRDG_MU0N(:, JBLK), ZRDG_CVGQ(:, :, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:CPPHINP')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_MU0LU => GET_HOST_DATA_RDWR(YL_ZRDG_MU0LU)
      ZRDG_CVGQ => GET_HOST_DATA_RDWR(YL_ZRDG_CVGQ)
      ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
      ZRDG_MU0M => GET_HOST_DATA_RDWR(YL_ZRDG_MU0M)
      ZRDG_MU0N => GET_HOST_DATA_RDWR(YL_ZRDG_MU0N)
      Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR(YDCPG_DYN0%CTY%F_EVEL)
      Z_YDVARS_Q_DM => GET_HOST_DATA_RDWR(YDVARS%Q%FDM)
      Z_YDVARS_CVGQ_DM => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FDM)
      Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR(YDVARS%U%FT0)
      Z_YDVARS_Q_DL => GET_HOST_DATA_RDWR(YDVARS%Q%FDL)
      Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR(YDCPG_PHY0%XYB%F_RDELP)
      Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR(YDVARS%V%FT0)
      Z_YDVARS_CVGQ_T0 => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FT0)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%FT0)
      Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%FT0)
      Z_YDVARS_CVGQ_DL => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FDL)
      Z_YDVARS_Q_T0 => GET_HOST_DATA_RDWR(YDVARS%Q%FT0)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0LU => NULL()
    ZRDG_CVGQ => NULL()
    ZRDG_MU0 => NULL()
    ZRDG_MU0M => NULL()
    ZRDG_MU0N => NULL()
    Z_YDCPG_DYN0_CTY_EVEL => NULL()
    Z_YDVARS_Q_DM => NULL()
    Z_YDVARS_CVGQ_DM => NULL()
    Z_YDVARS_U_T0 => NULL()
    Z_YDVARS_Q_DL => NULL()
    Z_YDCPG_PHY0_XYB_RDELP => NULL()
    Z_YDVARS_V_T0 => NULL()
    Z_YDVARS_CVGQ_T0 => NULL()
    Z_YDVARS_GEOMETRY_GEMU_T0 => NULL()
    Z_YDVARS_GEOMETRY_GELAM_T0 => NULL()
    Z_YDVARS_CVGQ_DL => NULL()
    Z_YDVARS_Q_T0 => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:CPPHINP')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0LU => GET_DEVICE_DATA_RDWR(YL_ZRDG_MU0LU)
    ZRDG_CVGQ => GET_DEVICE_DATA_RDWR(YL_ZRDG_CVGQ)
    ZRDG_MU0 => GET_DEVICE_DATA_RDWR(YL_ZRDG_MU0)
    ZRDG_MU0M => GET_DEVICE_DATA_RDWR(YL_ZRDG_MU0M)
    ZRDG_MU0N => GET_DEVICE_DATA_RDWR(YL_ZRDG_MU0N)
    Z_YDCPG_DYN0_CTY_EVEL => GET_DEVICE_DATA_RDWR(YDCPG_DYN0%CTY%F_EVEL)
    Z_YDVARS_Q_DM => GET_DEVICE_DATA_RDWR(YDVARS%Q%FDM)
    Z_YDVARS_CVGQ_DM => GET_DEVICE_DATA_RDWR(YDVARS%CVGQ%FDM)
    Z_YDVARS_U_T0 => GET_DEVICE_DATA_RDWR(YDVARS%U%FT0)
    Z_YDVARS_Q_DL => GET_DEVICE_DATA_RDWR(YDVARS%Q%FDL)
    Z_YDCPG_PHY0_XYB_RDELP => GET_DEVICE_DATA_RDWR(YDCPG_PHY0%XYB%F_RDELP)
    Z_YDVARS_V_T0 => GET_DEVICE_DATA_RDWR(YDVARS%V%FT0)
    Z_YDVARS_CVGQ_T0 => GET_DEVICE_DATA_RDWR(YDVARS%CVGQ%FT0)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_DEVICE_DATA_RDWR(YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_GEOMETRY_GELAM_T0 => GET_DEVICE_DATA_RDWR(YDVARS%GEOMETRY%GELAM%FT0)
    Z_YDVARS_CVGQ_DL => GET_DEVICE_DATA_RDWR(YDVARS%CVGQ%FDL)
    Z_YDVARS_Q_T0 => GET_DEVICE_DATA_RDWR(YDVARS%Q%FT0)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZRDG_MU0LU, ZRDG_CVGQ, ZRDG_MU0, ZRDG_MU0M,  &
!$ACC & ZRDG_MU0N, Z_YDCPG_DYN0_CTY_EVEL, Z_YDVARS_Q_DM, Z_YDVARS_CVGQ_DM, Z_YDVARS_U_T0, Z_YDVARS_Q_DL, Z_YDCPG_PHY0_XYB_RDELP,  &
!$ACC & Z_YDVARS_V_T0, Z_YDVARS_CVGQ_T0, Z_YDVARS_GEOMETRY_GEMU_T0, Z_YDVARS_GEOMETRY_GELAM_T0, Z_YDVARS_CVGQ_DL, Z_YDVARS_Q_T0,  &
!$ACC & ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL CPPHINP_OPENACC(YDGEOMETRY, YDMODEL, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK),  &
        & Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_U_T0(:, :, JBLK), Z_YDVARS_V_T0(:, :, JBLK), Z_YDVARS_Q_T0(:, :, JBLK),  &
        & Z_YDVARS_Q_DL(:, :, JBLK), Z_YDVARS_Q_DM(:, :, JBLK), Z_YDVARS_CVGQ_DL(:, :, JBLK), Z_YDVARS_CVGQ_DM(:, :, JBLK),  &
        & Z_YDCPG_PHY0_XYB_RDELP(:, :, JBLK), Z_YDCPG_DYN0_CTY_EVEL(:, :, JBLK), Z_YDVARS_CVGQ_T0(:, :, JBLK),  &
        & ZRDG_MU0(:, JBLK), ZRDG_MU0LU(:, JBLK), ZRDG_MU0M(:, JBLK), ZRDG_MU0N(:, JBLK), ZRDG_CVGQ(:, :, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:CPPHINP')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_MU0LU => GET_HOST_DATA_RDWR(YL_ZRDG_MU0LU)
      ZRDG_CVGQ => GET_HOST_DATA_RDWR(YL_ZRDG_CVGQ)
      ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
      ZRDG_MU0M => GET_HOST_DATA_RDWR(YL_ZRDG_MU0M)
      ZRDG_MU0N => GET_HOST_DATA_RDWR(YL_ZRDG_MU0N)
      Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR(YDCPG_DYN0%CTY%F_EVEL)
      Z_YDVARS_Q_DM => GET_HOST_DATA_RDWR(YDVARS%Q%FDM)
      Z_YDVARS_CVGQ_DM => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FDM)
      Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR(YDVARS%U%FT0)
      Z_YDVARS_Q_DL => GET_HOST_DATA_RDWR(YDVARS%Q%FDL)
      Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR(YDCPG_PHY0%XYB%F_RDELP)
      Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR(YDVARS%V%FT0)
      Z_YDVARS_CVGQ_T0 => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FT0)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%FT0)
      Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%FT0)
      Z_YDVARS_CVGQ_DL => GET_HOST_DATA_RDWR(YDVARS%CVGQ%FDL)
      Z_YDVARS_Q_T0 => GET_HOST_DATA_RDWR(YDVARS%Q%FT0)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0LU => NULL()
    ZRDG_CVGQ => NULL()
    ZRDG_MU0 => NULL()
    ZRDG_MU0M => NULL()
    ZRDG_MU0N => NULL()
    Z_YDCPG_DYN0_CTY_EVEL => NULL()
    Z_YDVARS_Q_DM => NULL()
    Z_YDVARS_CVGQ_DM => NULL()
    Z_YDVARS_U_T0 => NULL()
    Z_YDVARS_Q_DL => NULL()
    Z_YDCPG_PHY0_XYB_RDELP => NULL()
    Z_YDVARS_V_T0 => NULL()
    Z_YDVARS_CVGQ_T0 => NULL()
    Z_YDVARS_GEOMETRY_GEMU_T0 => NULL()
    Z_YDVARS_GEOMETRY_GELAM_T0 => NULL()
    Z_YDVARS_CVGQ_DL => NULL()
    Z_YDVARS_Q_T0 => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CPPHINP', 1, ZHOOK_HANDLE_PARALLEL)
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ZRDG_LCVQ')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_CVGQ => GET_HOST_DATA_RDWR(YL_ZRDG_CVGQ)
    ZRDG_LCVQ => GET_HOST_DATA_RDWR(YL_ZRDG_LCVQ)
    ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ZRDG_LCVQ')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_CVGQ => GET_HOST_DATA_RDWR(YL_ZRDG_CVGQ)
      ZRDG_LCVQ => GET_HOST_DATA_RDWR(YL_ZRDG_LCVQ)
      ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_CVGQ => NULL()
    ZRDG_LCVQ => NULL()
    ZFLU_QSATS => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:ZRDG_LCVQ')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_CVGQ => GET_HOST_DATA_RDWR(YL_ZRDG_CVGQ)
    ZRDG_LCVQ => GET_HOST_DATA_RDWR(YL_ZRDG_LCVQ)
    ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ZRDG_LCVQ')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_CVGQ => GET_HOST_DATA_RDWR(YL_ZRDG_CVGQ)
      ZRDG_LCVQ => GET_HOST_DATA_RDWR(YL_ZRDG_LCVQ)
      ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_CVGQ => NULL()
    ZRDG_LCVQ => NULL()
    ZFLU_QSATS => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:ZRDG_LCVQ')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_CVGQ => GET_DEVICE_DATA_RDWR(YL_ZRDG_CVGQ)
    ZRDG_LCVQ => GET_DEVICE_DATA_RDWR(YL_ZRDG_LCVQ)
    ZFLU_QSATS => GET_DEVICE_DATA_RDWR(YL_ZFLU_QSATS)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZRDG_CVGQ, ZRDG_LCVQ, ZFLU_QSATS, ) PRIVATE( JBLK )  &
!$ACC & VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ZRDG_LCVQ')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_CVGQ => GET_HOST_DATA_RDWR(YL_ZRDG_CVGQ)
      ZRDG_LCVQ => GET_HOST_DATA_RDWR(YL_ZRDG_LCVQ)
      ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_CVGQ => NULL()
    ZRDG_LCVQ => NULL()
    ZFLU_QSATS => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZRDG_LCVQ', 1, ZHOOK_HANDLE_PARALLEL)
  
  CALL MF_PHYS_FPL_PART1_PARALLEL(YDCPG_BNDS, YDCPG_OPTS, YL_ZPFL_FPLCH, YL_ZPFL_FPLSH, YDVARS%CPF%FT0, YDVARS%SPF%FT0, YDMODEL)
  
  IF (YDCPG_OPTS%LCONFX) THEN
    
    CALL MF_PHYS_SAVE_PHSURF_PART1_PARALLEL(YDCPG_BNDS, YDCPG_OPTS, YL_ZSAV_DDAL, YL_ZSAV_DDOM, YL_ZSAV_ENTCH, YL_ZSAV_FHPS,  &
    & YL_ZSAV_GZ0F, YL_ZSAV_GZ0HF, YL_ZSAV_HV, YL_ZSAV_PBLH, YL_ZSAV_QSH, YL_ZSAV_UDAL, YL_ZSAV_UDGRO, YL_ZSAV_UDOM,  &
    & YL_ZSAV_UNEBH, YDMF_PHYS_SURF%GSD_VF%F_Z0F, YDMF_PHYS_SURF%GSD_VH%F_PBLH, YDMF_PHYS_SURF%GSD_VH%F_QSH,  &
    & YDMF_PHYS_SURF%GSD_VH%F_SPSH, YDMF_PHYS_SURF%GSD_VK%F_UDGRO, YDMF_PHYS_SURF%GSD_VV%F_HV, YDMF_PHYS_SURF%GSD_VV%F_Z0H,  &
    & YDVARS%DAL%FT0, YDVARS%DOM%FT0, YDVARS%UAL%FT0, YDVARS%UEN%FT0, YDVARS%UNEBH%FT0, YDVARS%UOM%FT0, YDMODEL)
    
  END IF
  
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:APLPAR_INIT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
    ZPFL_FEFB2 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB2)
    ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
    ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
    ZPFL_FEFB3 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB3)
    IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
    ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
    ZPFL_FEFB1 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB1)
    ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
    ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
    ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
    ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
    ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
    ZPFL_FTKEI => GET_HOST_DATA_RDWR(YL_ZPFL_FTKEI)
    ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
    ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
    ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
    ZPFL_FTKE => GET_HOST_DATA_RDWR(YL_ZPFL_FTKE)
    ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
    ZFLU_FEVI => GET_HOST_DATA_RDWR(YL_ZFLU_FEVI)
    ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
    ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
    ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
    ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL APLPAR_INIT(YDCPG_OPTS%LAROME, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG,  &
      & YDMODEL%YRML_PHY_G%YRDPHY%NTSSG, YDCPG_OPTS%YRSURF_DIMS%YSP_SBD%NLEVS, Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK),  &
      & ZMSC_FRMQ(:, :, JBLK), ZDSA_CPS(:, JBLK), ZDSA_LHS(:, JBLK), ZDSA_RS(:, JBLK), ZMSC_LH(:, :, JBLK),  &
      & ZMSC_LSCPE(:, :, JBLK), ZFLU_QSAT(:, :, JBLK), ZMSC_QW(:, :, JBLK), ZMSC_TW(:, :, JBLK), ZFLU_CD(:, JBLK),  &
      & ZFLU_CDN(:, JBLK), ZFLU_CH(:, JBLK), ZDSA_C1(:, JBLK), ZDSA_C2(:, JBLK), ZFLU_EMIS(:, JBLK), ZFLU_FEVI(:, :, JBLK),  &
      & ZPFL_FTKE(:, :, JBLK), ZPFL_FTKEI(:, :, JBLK), ZPFL_FEFB1(:, :, JBLK), ZPFL_FEFB2(:, :, JBLK), ZPFL_FEFB3(:, :, JBLK),  &
      & ZFLU_NEIJ(:, JBLK), ZFLU_VEG(:, JBLK), ZFLU_QSATS(:, JBLK), IMOC_CLPH(:, JBLK))
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:APLPAR_INIT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
      ZPFL_FEFB2 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB2)
      ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
      ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
      ZPFL_FEFB3 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB3)
      IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
      ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
      ZPFL_FEFB1 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB1)
      ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
      ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
      ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
      ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
      ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
      ZPFL_FTKEI => GET_HOST_DATA_RDWR(YL_ZPFL_FTKEI)
      ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
      ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
      ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
      ZPFL_FTKE => GET_HOST_DATA_RDWR(YL_ZPFL_FTKE)
      ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
      ZFLU_FEVI => GET_HOST_DATA_RDWR(YL_ZFLU_FEVI)
      ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
      ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
      ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
      ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZMSC_LSCPE => NULL()
    ZPFL_FEFB2 => NULL()
    ZMSC_LH => NULL()
    ZDSA_C2 => NULL()
    ZPFL_FEFB3 => NULL()
    IMOC_CLPH => NULL()
    ZDSA_C1 => NULL()
    ZPFL_FEFB1 => NULL()
    ZFLU_CH => NULL()
    ZFLU_NEIJ => NULL()
    ZFLU_CD => NULL()
    ZMSC_FRMQ => NULL()
    ZFLU_EMIS => NULL()
    ZDSA_LHS => NULL()
    ZPFL_FTKEI => NULL()
    ZFLU_VEG => NULL()
    ZDSA_RS => NULL()
    ZMSC_QW => NULL()
    ZPFL_FTKE => NULL()
    ZFLU_CDN => NULL()
    ZFLU_FEVI => NULL()
    ZFLU_QSAT => NULL()
    ZFLU_QSATS => NULL()
    ZDSA_CPS => NULL()
    ZMSC_TW => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:APLPAR_INIT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
    ZPFL_FEFB2 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB2)
    ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
    ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
    ZPFL_FEFB3 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB3)
    IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
    ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
    ZPFL_FEFB1 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB1)
    ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
    ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
    ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
    ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
    ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
    ZPFL_FTKEI => GET_HOST_DATA_RDWR(YL_ZPFL_FTKEI)
    ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
    ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
    ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
    ZPFL_FTKE => GET_HOST_DATA_RDWR(YL_ZPFL_FTKE)
    ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
    ZFLU_FEVI => GET_HOST_DATA_RDWR(YL_ZFLU_FEVI)
    ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
    ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
    ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
    ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL APLPAR_INIT_OPENACC(YDCPG_OPTS%LAROME, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG,  &
        & YDMODEL%YRML_PHY_G%YRDPHY%NTSSG, YDCPG_OPTS%YRSURF_DIMS%YSP_SBD%NLEVS, Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK),  &
        & ZMSC_FRMQ(:, :, JBLK), ZDSA_CPS(:, JBLK), ZDSA_LHS(:, JBLK), ZDSA_RS(:, JBLK), ZMSC_LH(:, :, JBLK),  &
        & ZMSC_LSCPE(:, :, JBLK), ZFLU_QSAT(:, :, JBLK), ZMSC_QW(:, :, JBLK), ZMSC_TW(:, :, JBLK), ZFLU_CD(:, JBLK),  &
        & ZFLU_CDN(:, JBLK), ZFLU_CH(:, JBLK), ZDSA_C1(:, JBLK), ZDSA_C2(:, JBLK), ZFLU_EMIS(:, JBLK), ZFLU_FEVI(:, :, JBLK),  &
        & ZPFL_FTKE(:, :, JBLK), ZPFL_FTKEI(:, :, JBLK), ZPFL_FEFB1(:, :, JBLK), ZPFL_FEFB2(:, :, JBLK), ZPFL_FEFB3(:, :, JBLK),  &
        & ZFLU_NEIJ(:, JBLK), ZFLU_VEG(:, JBLK), ZFLU_QSATS(:, JBLK), IMOC_CLPH(:, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:APLPAR_INIT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
      ZPFL_FEFB2 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB2)
      ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
      ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
      ZPFL_FEFB3 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB3)
      IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
      ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
      ZPFL_FEFB1 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB1)
      ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
      ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
      ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
      ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
      ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
      ZPFL_FTKEI => GET_HOST_DATA_RDWR(YL_ZPFL_FTKEI)
      ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
      ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
      ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
      ZPFL_FTKE => GET_HOST_DATA_RDWR(YL_ZPFL_FTKE)
      ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
      ZFLU_FEVI => GET_HOST_DATA_RDWR(YL_ZFLU_FEVI)
      ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
      ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
      ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
      ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZMSC_LSCPE => NULL()
    ZPFL_FEFB2 => NULL()
    ZMSC_LH => NULL()
    ZDSA_C2 => NULL()
    ZPFL_FEFB3 => NULL()
    IMOC_CLPH => NULL()
    ZDSA_C1 => NULL()
    ZPFL_FEFB1 => NULL()
    ZFLU_CH => NULL()
    ZFLU_NEIJ => NULL()
    ZFLU_CD => NULL()
    ZMSC_FRMQ => NULL()
    ZFLU_EMIS => NULL()
    ZDSA_LHS => NULL()
    ZPFL_FTKEI => NULL()
    ZFLU_VEG => NULL()
    ZDSA_RS => NULL()
    ZMSC_QW => NULL()
    ZPFL_FTKE => NULL()
    ZFLU_CDN => NULL()
    ZFLU_FEVI => NULL()
    ZFLU_QSAT => NULL()
    ZFLU_QSATS => NULL()
    ZDSA_CPS => NULL()
    ZMSC_TW => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:APLPAR_INIT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZMSC_LSCPE => GET_DEVICE_DATA_RDWR(YL_ZMSC_LSCPE)
    ZPFL_FEFB2 => GET_DEVICE_DATA_RDWR(YL_ZPFL_FEFB2)
    ZMSC_LH => GET_DEVICE_DATA_RDWR(YL_ZMSC_LH)
    ZDSA_C2 => GET_DEVICE_DATA_RDWR(YL_ZDSA_C2)
    ZPFL_FEFB3 => GET_DEVICE_DATA_RDWR(YL_ZPFL_FEFB3)
    IMOC_CLPH => GET_DEVICE_DATA_RDWR(YL_IMOC_CLPH)
    ZDSA_C1 => GET_DEVICE_DATA_RDWR(YL_ZDSA_C1)
    ZPFL_FEFB1 => GET_DEVICE_DATA_RDWR(YL_ZPFL_FEFB1)
    ZFLU_CH => GET_DEVICE_DATA_RDWR(YL_ZFLU_CH)
    ZFLU_NEIJ => GET_DEVICE_DATA_RDWR(YL_ZFLU_NEIJ)
    ZFLU_CD => GET_DEVICE_DATA_RDWR(YL_ZFLU_CD)
    ZMSC_FRMQ => GET_DEVICE_DATA_RDWR(YL_ZMSC_FRMQ)
    ZFLU_EMIS => GET_DEVICE_DATA_RDWR(YL_ZFLU_EMIS)
    ZDSA_LHS => GET_DEVICE_DATA_RDWR(YL_ZDSA_LHS)
    ZPFL_FTKEI => GET_DEVICE_DATA_RDWR(YL_ZPFL_FTKEI)
    ZFLU_VEG => GET_DEVICE_DATA_RDWR(YL_ZFLU_VEG)
    ZDSA_RS => GET_DEVICE_DATA_RDWR(YL_ZDSA_RS)
    ZMSC_QW => GET_DEVICE_DATA_RDWR(YL_ZMSC_QW)
    ZPFL_FTKE => GET_DEVICE_DATA_RDWR(YL_ZPFL_FTKE)
    ZFLU_CDN => GET_DEVICE_DATA_RDWR(YL_ZFLU_CDN)
    ZFLU_FEVI => GET_DEVICE_DATA_RDWR(YL_ZFLU_FEVI)
    ZFLU_QSAT => GET_DEVICE_DATA_RDWR(YL_ZFLU_QSAT)
    ZFLU_QSATS => GET_DEVICE_DATA_RDWR(YL_ZFLU_QSATS)
    ZDSA_CPS => GET_DEVICE_DATA_RDWR(YL_ZDSA_CPS)
    ZMSC_TW => GET_DEVICE_DATA_RDWR(YL_ZMSC_TW)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZMSC_LSCPE, ZPFL_FEFB2, ZMSC_LH, ZDSA_C2, ZPFL_FEFB3,  &
!$ACC & IMOC_CLPH, ZDSA_C1, ZPFL_FEFB1, ZFLU_CH, ZFLU_NEIJ, ZFLU_CD, ZMSC_FRMQ, ZFLU_EMIS, ZDSA_LHS, ZPFL_FTKEI, ZFLU_VEG,  &
!$ACC & ZDSA_RS, ZMSC_QW, ZPFL_FTKE, ZFLU_CDN, ZFLU_FEVI, ZFLU_QSAT, ZFLU_QSATS, ZDSA_CPS, ZMSC_TW,  &
!$ACC & Z_YDMF_PHYS_SURF_GSD_VF_PVEG, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL APLPAR_INIT_OPENACC(YDCPG_OPTS%LAROME, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG,  &
        & YDMODEL%YRML_PHY_G%YRDPHY%NTSSG, YDCPG_OPTS%YRSURF_DIMS%YSP_SBD%NLEVS, Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK),  &
        & ZMSC_FRMQ(:, :, JBLK), ZDSA_CPS(:, JBLK), ZDSA_LHS(:, JBLK), ZDSA_RS(:, JBLK), ZMSC_LH(:, :, JBLK),  &
        & ZMSC_LSCPE(:, :, JBLK), ZFLU_QSAT(:, :, JBLK), ZMSC_QW(:, :, JBLK), ZMSC_TW(:, :, JBLK), ZFLU_CD(:, JBLK),  &
        & ZFLU_CDN(:, JBLK), ZFLU_CH(:, JBLK), ZDSA_C1(:, JBLK), ZDSA_C2(:, JBLK), ZFLU_EMIS(:, JBLK), ZFLU_FEVI(:, :, JBLK),  &
        & ZPFL_FTKE(:, :, JBLK), ZPFL_FTKEI(:, :, JBLK), ZPFL_FEFB1(:, :, JBLK), ZPFL_FEFB2(:, :, JBLK), ZPFL_FEFB3(:, :, JBLK),  &
        & ZFLU_NEIJ(:, JBLK), ZFLU_VEG(:, JBLK), ZFLU_QSATS(:, JBLK), IMOC_CLPH(:, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:APLPAR_INIT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
      ZPFL_FEFB2 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB2)
      ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
      ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
      ZPFL_FEFB3 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB3)
      IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
      ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
      ZPFL_FEFB1 => GET_HOST_DATA_RDWR(YL_ZPFL_FEFB1)
      ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
      ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
      ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
      ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
      ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
      ZPFL_FTKEI => GET_HOST_DATA_RDWR(YL_ZPFL_FTKEI)
      ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
      ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
      ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
      ZPFL_FTKE => GET_HOST_DATA_RDWR(YL_ZPFL_FTKE)
      ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
      ZFLU_FEVI => GET_HOST_DATA_RDWR(YL_ZFLU_FEVI)
      ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
      ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
      ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
      ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZMSC_LSCPE => NULL()
    ZPFL_FEFB2 => NULL()
    ZMSC_LH => NULL()
    ZDSA_C2 => NULL()
    ZPFL_FEFB3 => NULL()
    IMOC_CLPH => NULL()
    ZDSA_C1 => NULL()
    ZPFL_FEFB1 => NULL()
    ZFLU_CH => NULL()
    ZFLU_NEIJ => NULL()
    ZFLU_CD => NULL()
    ZMSC_FRMQ => NULL()
    ZFLU_EMIS => NULL()
    ZDSA_LHS => NULL()
    ZPFL_FTKEI => NULL()
    ZFLU_VEG => NULL()
    ZDSA_RS => NULL()
    ZMSC_QW => NULL()
    ZPFL_FTKE => NULL()
    ZFLU_CDN => NULL()
    ZFLU_FEVI => NULL()
    ZFLU_QSAT => NULL()
    ZFLU_QSATS => NULL()
    ZDSA_CPS => NULL()
    ZMSC_TW => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:APLPAR_INIT', 1, ZHOOK_HANDLE_PARALLEL)
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:PLSM')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM(JLON))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:PLSM')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM(JLON))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:PLSM')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM(JLON))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:PLSM')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM(JLON))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:PLSM')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM(JLON))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, Z_YDMF_PHYS_SURF_GSD_VF_PLSM, ) PRIVATE( JBLK )  &
!$ACC & VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:PLSM')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM(JLON))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PLSM', 1, ZHOOK_HANDLE_PARALLEL)
  
  ! Check magnitude of model variables.
  
  
  IF (YDMODEL%YRML_PHY_MF%YRPHY%LGCHECKMV) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV', 0, ZHOOK_HANDLE_PARALLEL)
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:CHECKMV')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%FT0)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%FT0)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL CHECKMV(YDCPG_OPTS%NINDAT, YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP, YDMODEL%YRML_PHY_MF%YRPHY0,  &
        & YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%NSTEP,  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK), ZRDG_MU0(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK))
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:CHECKMV')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
        Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%FT0)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%FT0)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_MU0 => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_Q => NULL()
      Z_YDVARS_GEOMETRY_GEMU_T0 => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDVARS_GEOMETRY_GELAM_T0 => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:CHECKMV')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%FT0)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%FT0)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL CHECKMV_OPENACC(YDCPG_OPTS%NINDAT, YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP, YDMODEL%YRML_PHY_MF%YRPHY0,  &
          & YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG,  &
          & YDCPG_OPTS%NSTEP, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
          & Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK), ZRDG_MU0(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:CHECKMV')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
        Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%FT0)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%FT0)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_MU0 => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_Q => NULL()
      Z_YDVARS_GEOMETRY_GEMU_T0 => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDVARS_GEOMETRY_GELAM_T0 => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:CHECKMV')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_MU0 => GET_DEVICE_DATA_RDWR(YL_ZRDG_MU0)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_Q => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_DEVICE_DATA_RDWR(YDVARS%GEOMETRY%GEMU%FT0)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDVARS_GEOMETRY_GELAM_T0 => GET_DEVICE_DATA_RDWR(YDVARS%GEOMETRY%GELAM%FT0)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZRDG_MU0, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T,  &
!$ACC & Z_YDMF_PHYS_SURF_GSD_VF_PLSM, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, Z_YDMF_PHYS_BASE_STATE_Q,  &
!$ACC & Z_YDVARS_GEOMETRY_GEMU_T0, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDVARS_GEOMETRY_GELAM_T0,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, ) PRIVATE( JBLK ) VECTOR_LENGTH(  &
!$ACC & YDCPG_OPTS%KLON )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL CHECKMV_OPENACC(YDCPG_OPTS%NINDAT, YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP, YDMODEL%YRML_PHY_MF%YRPHY0,  &
          & YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG,  &
          & YDCPG_OPTS%NSTEP, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
          & Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK), ZRDG_MU0(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:CHECKMV')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
        Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GEMU%FT0)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%GELAM%FT0)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_MU0 => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_Q => NULL()
      Z_YDVARS_GEOMETRY_GEMU_T0 => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDVARS_GEOMETRY_GELAM_T0 => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:CHECKMV', 1, ZHOOK_HANDLE_PARALLEL)
  END IF
  
  
  
  LLREDPR = .false.
  ZRVMD = YDMODEL%YRCST%RV - YDMODEL%YRCST%RD
  
  IF (YDCPG_OPTS%LCONFX) THEN
    ZDTMSE = 0.01_JPRB
    ZSTATI = YDMODEL%YRML_GCONF%YRRIP%RSTATI - ZDTMSE / 2._JPRB
  ELSE
    ZDTMSE = YDMODEL%YRML_PHY_MF%YRPHY2%TSPHY
    ZSTATI = YDMODEL%YRML_GCONF%YRRIP%RSTATI
  END IF
  ZRHGMT = REAL(YDMODEL%YRML_GCONF%YRRIP%RHGMT, kind=JPRB)
  
  
  CALL APL_ARPEGE_INIT_PARALLEL(YDMODEL%YRCST, YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDMF_PHYS,  &
  & YDMF_PHYS_SURF, YDVARS, YDMODEL, YL_IMOC_CLPH, YL_INLAB_CVPP, YL_ZAER, YL_ZAERINDS, YL_ZAIPCMT, YL_ZALBD, YL_ZALBP,  &
  & YL_ZALPHA1, YL_ZCEMTR, YL_ZCFATH, YL_ZCFAU, YL_ZCFBTH, YL_ZCFBU, YL_ZCFBV, YL_ZCOEFA, YL_ZCONDCVPPI, YL_ZCONDCVPPL,  &
  & YL_ZCTRSO, YL_ZDECRD, YL_ZDIFCVPPQ, YL_ZDIFCVPPS, YL_ZDIFCVPPU, YL_ZDIFCVPPV, YL_ZDIFWQ, YL_ZDIFWS, YL_ZEDMFQ, YL_ZEDMFS,  &
  & YL_ZEDMFU, YL_ZEDMFV, ZEPS0, ZEPSNEB, YL_ZFPCOR, YL_ZKQLROV, YL_ZKQROV, YL_ZKTROV, YL_ZKUROV, YL_ZLVT, YL_ZMF_UP, YL_ZMRIPP,  &
  & YL_ZNEBC0, YL_ZNEBCH, YL_ZNEBDIFF, YL_ZNEBS, YL_ZNEBS0, YL_ZNEB_CVPP, YL_ZPFL_FPLCH, YL_ZPFL_FPLSH, YL_ZPOID,  &
  & YL_ZPRODTH_CVPP, YL_ZQC_DET_PCMT, YL_ZQI, YL_ZQIC, YL_ZQICE, YL_ZQL, YL_ZQLC, YL_ZQLIS, YL_ZQLIS0, YL_ZQLI_CVP,  &
  & YL_ZQLI_CVPP, YL_ZQO3, YL_ZQR, YL_ZQS, YL_ZQV, YL_ZSC_FCLL, YL_ZSC_FCLN, YL_ZSC_FEVI, YL_ZSC_FEVN, YL_ZSEDIQI, YL_ZSEDIQL,  &
  & YL_ZSFSWDIF, YL_ZSFSWDIR, YL_ZSUDU, YL_ZTENHA, YL_ZTENQVA, YL_ZTENT, YL_ZTRSOD, YL_ZTRSODIF, YL_ZTRSODIR, YL_ZUNEBH,  &
  & YL_ZXDROV, YL_ZXHROV, YL_ZXQRO, YL_ZXTRO, YL_ZXTROV, YL_ZXURO, YL_ZXUROV)
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACTQSAT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
    ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
    ZGEOSLC => GET_HOST_DATA_RDWR(YL_ZGEOSLC)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
    ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
    ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
    Z_YDCPG_MISC_RH => GET_HOST_DATA_RDWR(YDCPG_MISC%F_RH)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL ACTQSAT(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
      & YDMODEL%YRML_PHY_MF%YRTOPH%NTQSAT, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK), ZQV(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK),  &
      & ZGEOSLC(:, :, JBLK), ZMSC_LH(:, :, JBLK), ZMSC_LSCPE(:, :, JBLK), ZFLU_QSAT(:, :, JBLK), ZMSC_QW(:, :, JBLK),  &
      & Z_YDCPG_MISC_RH(:, :, JBLK), ZMSC_TW(:, :, JBLK))
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACTQSAT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
      ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
      ZGEOSLC => GET_HOST_DATA_RDWR(YL_ZGEOSLC)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
      ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
      ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
      Z_YDCPG_MISC_RH => GET_HOST_DATA_RDWR(YDCPG_MISC%F_RH)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZMSC_LSCPE => NULL()
    ZMSC_LH => NULL()
    ZGEOSLC => NULL()
    ZQV => NULL()
    ZMSC_QW => NULL()
    ZFLU_QSAT => NULL()
    ZMSC_TW => NULL()
    Z_YDCPG_MISC_RH => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:ACTQSAT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
    ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
    ZGEOSLC => GET_HOST_DATA_RDWR(YL_ZGEOSLC)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
    ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
    ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
    Z_YDCPG_MISC_RH => GET_HOST_DATA_RDWR(YDCPG_MISC%F_RH)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL ACTQSAT_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & YDMODEL%YRML_PHY_MF%YRTOPH%NTQSAT, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK), ZQV(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK),  &
        & ZGEOSLC(:, :, JBLK), ZMSC_LH(:, :, JBLK), ZMSC_LSCPE(:, :, JBLK), ZFLU_QSAT(:, :, JBLK), ZMSC_QW(:, :, JBLK),  &
        & Z_YDCPG_MISC_RH(:, :, JBLK), ZMSC_TW(:, :, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACTQSAT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
      ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
      ZGEOSLC => GET_HOST_DATA_RDWR(YL_ZGEOSLC)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
      ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
      ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
      Z_YDCPG_MISC_RH => GET_HOST_DATA_RDWR(YDCPG_MISC%F_RH)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZMSC_LSCPE => NULL()
    ZMSC_LH => NULL()
    ZGEOSLC => NULL()
    ZQV => NULL()
    ZMSC_QW => NULL()
    ZFLU_QSAT => NULL()
    ZMSC_TW => NULL()
    Z_YDCPG_MISC_RH => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:ACTQSAT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZMSC_LSCPE => GET_DEVICE_DATA_RDWR(YL_ZMSC_LSCPE)
    ZMSC_LH => GET_DEVICE_DATA_RDWR(YL_ZMSC_LH)
    ZGEOSLC => GET_DEVICE_DATA_RDWR(YL_ZGEOSLC)
    ZQV => GET_DEVICE_DATA_RDWR(YL_ZQV)
    ZMSC_QW => GET_DEVICE_DATA_RDWR(YL_ZMSC_QW)
    ZFLU_QSAT => GET_DEVICE_DATA_RDWR(YL_ZFLU_QSAT)
    ZMSC_TW => GET_DEVICE_DATA_RDWR(YL_ZMSC_TW)
    Z_YDCPG_MISC_RH => GET_DEVICE_DATA_RDWR(YDCPG_MISC%F_RH)
    Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZMSC_LSCPE, ZMSC_LH, ZGEOSLC, ZQV, ZMSC_QW,  &
!$ACC & ZFLU_QSAT, ZMSC_TW, Z_YDCPG_MISC_RH, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL ACTQSAT_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & YDMODEL%YRML_PHY_MF%YRTOPH%NTQSAT, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK), ZQV(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK),  &
        & ZGEOSLC(:, :, JBLK), ZMSC_LH(:, :, JBLK), ZMSC_LSCPE(:, :, JBLK), ZFLU_QSAT(:, :, JBLK), ZMSC_QW(:, :, JBLK),  &
        & Z_YDCPG_MISC_RH(:, :, JBLK), ZMSC_TW(:, :, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACTQSAT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZMSC_LSCPE => GET_HOST_DATA_RDWR(YL_ZMSC_LSCPE)
      ZMSC_LH => GET_HOST_DATA_RDWR(YL_ZMSC_LH)
      ZGEOSLC => GET_HOST_DATA_RDWR(YL_ZGEOSLC)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
      ZFLU_QSAT => GET_HOST_DATA_RDWR(YL_ZFLU_QSAT)
      ZMSC_TW => GET_HOST_DATA_RDWR(YL_ZMSC_TW)
      Z_YDCPG_MISC_RH => GET_HOST_DATA_RDWR(YDCPG_MISC%F_RH)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZMSC_LSCPE => NULL()
    ZMSC_LH => NULL()
    ZGEOSLC => NULL()
    ZQV => NULL()
    ZMSC_QW => NULL()
    ZFLU_QSAT => NULL()
    ZMSC_TW => NULL()
    Z_YDCPG_MISC_RH => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACTQSAT', 1, ZHOOK_HANDLE_PARALLEL)
  
  
  IF (.not.YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN
    
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL', 0, ZHOOK_HANDLE_PARALLEL)
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACSOL')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
      ZWSMX => GET_HOST_DATA_RDWR(YL_ZWSMX)
      ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
      ZCN => GET_HOST_DATA_RDWR(YL_ZCN)
      ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
      ZCG => GET_HOST_DATA_RDWR(YL_ZCG)
      ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
      ZC3 => GET_HOST_DATA_RDWR(YL_ZC3)
      ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
      ZWWILT => GET_HOST_DATA_RDWR(YL_ZWWILT)
      ZWSEQ => GET_HOST_DATA_RDWR(YL_ZWSEQ)
      ZWPMX => GET_HOST_DATA_RDWR(YL_ZWPMX)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_LAI)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F(:, 1))
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_A(:, 1))
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL(:, 1))
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_R(:, 1))
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_IVEG)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q(:, 1))
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
      Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CT)
      Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_SAB)
      Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_ARG)
      Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_D2)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL ACSOL(YDCPG_OPTS%YRCLI, YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY1, YLCPG_BNDS%KIDIA,  &
        & YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, Z_YDMF_PHYS_SURF_GSD_VV_PARG(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PD2(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PIVEG(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PLAI(:, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R(:, :, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VV_PSAB(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), LLHMT, ZDSA_C1(:, JBLK),  &
        & ZDSA_C2(:, JBLK), ZC3(:, JBLK), ZCG(:, JBLK), ZCN(:, JBLK), Z_YDMF_PHYS_OUT_CT(:, JBLK), ZNEIJG(:, JBLK),  &
        & ZNEIJV(:, JBLK), ZWFC(:, JBLK), ZWPMX(:, JBLK), ZWSEQ(:, JBLK), ZWSMX(:, JBLK), ZWWILT(:, JBLK))
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACSOL')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
        ZWSMX => GET_HOST_DATA_RDWR(YL_ZWSMX)
        ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
        ZCN => GET_HOST_DATA_RDWR(YL_ZCN)
        ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
        ZCG => GET_HOST_DATA_RDWR(YL_ZCG)
        ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
        ZC3 => GET_HOST_DATA_RDWR(YL_ZC3)
        ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
        ZWWILT => GET_HOST_DATA_RDWR(YL_ZWWILT)
        ZWSEQ => GET_HOST_DATA_RDWR(YL_ZWSEQ)
        ZWPMX => GET_HOST_DATA_RDWR(YL_ZWPMX)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
        Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_LAI)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F(:, 1))
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_A(:, 1))
        Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL(:, 1))
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_R(:, 1))
        Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_IVEG)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q(:, 1))
        Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
        Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CT)
        Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_SAB)
        Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_ARG)
        Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_D2)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZNEIJV => NULL()
      ZWSMX => NULL()
      ZDSA_C2 => NULL()
      ZCN => NULL()
      ZDSA_C1 => NULL()
      ZCG => NULL()
      ZWFC => NULL()
      ZC3 => NULL()
      ZNEIJG => NULL()
      ZWWILT => NULL()
      ZWSEQ => NULL()
      ZWPMX => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PLAI => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL()
      Z_YDMF_PHYS_OUT_CT => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PSAB => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PARG => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PD2 => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:ACSOL')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
      ZWSMX => GET_HOST_DATA_RDWR(YL_ZWSMX)
      ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
      ZCN => GET_HOST_DATA_RDWR(YL_ZCN)
      ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
      ZCG => GET_HOST_DATA_RDWR(YL_ZCG)
      ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
      ZC3 => GET_HOST_DATA_RDWR(YL_ZC3)
      ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
      ZWWILT => GET_HOST_DATA_RDWR(YL_ZWWILT)
      ZWSEQ => GET_HOST_DATA_RDWR(YL_ZWSEQ)
      ZWPMX => GET_HOST_DATA_RDWR(YL_ZWPMX)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_LAI)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F(:, 1))
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_A(:, 1))
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL(:, 1))
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_R(:, 1))
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_IVEG)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q(:, 1))
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
      Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CT)
      Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_SAB)
      Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_ARG)
      Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_D2)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL ACSOL_OPENACC(YDCPG_OPTS%YRCLI, YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY1,  &
          & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, Z_YDMF_PHYS_SURF_GSD_VV_PARG(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VV_PD2(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VV_PIVEG(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PLAI(:, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R(:, :, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VV_PSAB(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), LLHMT, ZDSA_C1(:, JBLK),  &
          & ZDSA_C2(:, JBLK), ZC3(:, JBLK), ZCG(:, JBLK), ZCN(:, JBLK), Z_YDMF_PHYS_OUT_CT(:, JBLK), ZNEIJG(:, JBLK),  &
          & ZNEIJV(:, JBLK), ZWFC(:, JBLK), ZWPMX(:, JBLK), ZWSEQ(:, JBLK), ZWSMX(:, JBLK), ZWWILT(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACSOL')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
        ZWSMX => GET_HOST_DATA_RDWR(YL_ZWSMX)
        ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
        ZCN => GET_HOST_DATA_RDWR(YL_ZCN)
        ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
        ZCG => GET_HOST_DATA_RDWR(YL_ZCG)
        ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
        ZC3 => GET_HOST_DATA_RDWR(YL_ZC3)
        ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
        ZWWILT => GET_HOST_DATA_RDWR(YL_ZWWILT)
        ZWSEQ => GET_HOST_DATA_RDWR(YL_ZWSEQ)
        ZWPMX => GET_HOST_DATA_RDWR(YL_ZWPMX)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
        Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_LAI)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F(:, 1))
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_A(:, 1))
        Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL(:, 1))
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_R(:, 1))
        Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_IVEG)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q(:, 1))
        Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
        Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CT)
        Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_SAB)
        Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_ARG)
        Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_D2)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZNEIJV => NULL()
      ZWSMX => NULL()
      ZDSA_C2 => NULL()
      ZCN => NULL()
      ZDSA_C1 => NULL()
      ZCG => NULL()
      ZWFC => NULL()
      ZC3 => NULL()
      ZNEIJG => NULL()
      ZWWILT => NULL()
      ZWSEQ => NULL()
      ZWPMX => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PLAI => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL()
      Z_YDMF_PHYS_OUT_CT => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PSAB => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PARG => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PD2 => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:ACSOL')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZNEIJV => GET_DEVICE_DATA_RDWR(YL_ZNEIJV)
      ZWSMX => GET_DEVICE_DATA_RDWR(YL_ZWSMX)
      ZDSA_C2 => GET_DEVICE_DATA_RDWR(YL_ZDSA_C2)
      ZCN => GET_DEVICE_DATA_RDWR(YL_ZCN)
      ZDSA_C1 => GET_DEVICE_DATA_RDWR(YL_ZDSA_C1)
      ZCG => GET_DEVICE_DATA_RDWR(YL_ZCG)
      ZWFC => GET_DEVICE_DATA_RDWR(YL_ZWFC)
      ZC3 => GET_DEVICE_DATA_RDWR(YL_ZC3)
      ZNEIJG => GET_DEVICE_DATA_RDWR(YL_ZNEIJG)
      ZWWILT => GET_DEVICE_DATA_RDWR(YL_ZWWILT)
      ZWSEQ => GET_DEVICE_DATA_RDWR(YL_ZWSEQ)
      ZWPMX => GET_DEVICE_DATA_RDWR(YL_ZWPMX)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_LAI)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F(:, 1))
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_A(:, 1))
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL(:, 1))
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_R(:, 1))
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_IVEG)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q(:, 1))
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
      Z_YDMF_PHYS_OUT_CT => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_CT)
      Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_SAB)
      Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_ARG)
      Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_D2)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZNEIJV, ZWSMX, ZDSA_C2, ZCN, ZDSA_C1, ZCG, ZWFC, ZC3,  &
!$ACC & ZNEIJG, ZWWILT, ZWSEQ, ZWPMX, Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF, Z_YDMF_PHYS_SURF_GSD_VV_PLAI,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_SURF_GSD_VF_PLSM, Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A, Z_YDMF_PHYS_SURF_GSD_VV_PZ0H, Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R, Z_YDMF_PHYS_SURF_GSD_VV_PIVEG, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC, Z_YDMF_PHYS_SURF_GSD_VF_PZ0F, Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q,  &
!$ACC & Z_YDMF_PHYS_SURF_GSD_VF_PVEG, Z_YDMF_PHYS_OUT_CT, Z_YDMF_PHYS_SURF_GSD_VV_PSAB, Z_YDMF_PHYS_SURF_GSD_VV_PARG,  &
!$ACC & Z_YDMF_PHYS_SURF_GSD_VV_PD2, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL ACSOL_OPENACC(YDCPG_OPTS%YRCLI, YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY1,  &
          & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, Z_YDMF_PHYS_SURF_GSD_VV_PARG(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VV_PD2(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VV_PIVEG(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PLAI(:, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R(:, :, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VV_PSAB(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), LLHMT, ZDSA_C1(:, JBLK),  &
          & ZDSA_C2(:, JBLK), ZC3(:, JBLK), ZCG(:, JBLK), ZCN(:, JBLK), Z_YDMF_PHYS_OUT_CT(:, JBLK), ZNEIJG(:, JBLK),  &
          & ZNEIJV(:, JBLK), ZWFC(:, JBLK), ZWPMX(:, JBLK), ZWSEQ(:, JBLK), ZWSMX(:, JBLK), ZWWILT(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACSOL')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
        ZWSMX => GET_HOST_DATA_RDWR(YL_ZWSMX)
        ZDSA_C2 => GET_HOST_DATA_RDWR(YL_ZDSA_C2)
        ZCN => GET_HOST_DATA_RDWR(YL_ZCN)
        ZDSA_C1 => GET_HOST_DATA_RDWR(YL_ZDSA_C1)
        ZCG => GET_HOST_DATA_RDWR(YL_ZCG)
        ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
        ZC3 => GET_HOST_DATA_RDWR(YL_ZC3)
        ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
        ZWWILT => GET_HOST_DATA_RDWR(YL_ZWWILT)
        ZWSEQ => GET_HOST_DATA_RDWR(YL_ZWSEQ)
        ZWPMX => GET_HOST_DATA_RDWR(YL_ZWPMX)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
        Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_LAI)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F(:, 1))
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_A(:, 1))
        Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL(:, 1))
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_R(:, 1))
        Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_IVEG)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q(:, 1))
        Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
        Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CT)
        Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_SAB)
        Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_ARG)
        Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_D2)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZNEIJV => NULL()
      ZWSMX => NULL()
      ZDSA_C2 => NULL()
      ZCN => NULL()
      ZDSA_C1 => NULL()
      ZCG => NULL()
      ZWFC => NULL()
      ZC3 => NULL()
      ZNEIJG => NULL()
      ZWWILT => NULL()
      ZWSEQ => NULL()
      ZWPMX => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PLAI => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL()
      Z_YDMF_PHYS_OUT_CT => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PSAB => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PARG => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PD2 => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACSOL', 1, ZHOOK_HANDLE_PARALLEL)
    
  END IF
  
  
  CALL APL_ARPEGE_INIT_SURFEX_PARALLEL(YDMF_PHYS_BASE_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDCPG_GPAR,  &
  & YDMF_PHYS, YDVARS, YDMODEL, YL_ZALBD, YL_ZALBP, YL_ZFLU_EMIS, YL_ZSGROUPEL, YL_ZSRAIN, YL_ZSSNOW, YL_ZTSN)
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ZDPHIV')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZDPHIV => GET_HOST_DATA_RDWR(YL_ZDPHIV)
    ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ZDPHIV')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZDPHIV => GET_HOST_DATA_RDWR(YL_ZDPHIV)
      ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZDPHIV => NULL()
    ZDPHIT => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:ZDPHIV')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZDPHIV => GET_HOST_DATA_RDWR(YL_ZDPHIV)
    ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ZDPHIV')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZDPHIV => GET_HOST_DATA_RDWR(YL_ZDPHIV)
      ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZDPHIV => NULL()
    ZDPHIT => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:ZDPHIV')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZDPHIV => GET_DEVICE_DATA_RDWR(YL_ZDPHIV)
    ZDPHIT => GET_DEVICE_DATA_RDWR(YL_ZDPHIT)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZDPHIV, ZDPHIT, ) PRIVATE( JBLK ) VECTOR_LENGTH(  &
!$ACC & YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ZDPHIV')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZDPHIV => GET_HOST_DATA_RDWR(YL_ZDPHIV)
      ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZDPHIV => NULL()
    ZDPHIT => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDPHIV', 1, ZHOOK_HANDLE_PARALLEL)
  
  LLCLS = .true.
  LLHMT = .true.
  IF (YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN
    
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS', 0, ZHOOK_HANDLE_PARALLEL)
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACHMTLS')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
      ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
      ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
      ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
      ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
      ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
      ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
      ZDPHI => GET_HOST_DATA_RDWR(YL_ZDPHI)
      ZRTI => GET_HOST_DATA_RDWR(YL_ZRTI)
      ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
      ZPRS => GET_HOST_DATA_RDWR(YL_ZPRS)
      ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS(JLON))
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL ACHMTLS(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG,  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK),  &
        & Z_YDCPG_MISC_QS(:, JBLK), ZDPHIT(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_OUT_GZ0H(:, JBLK), LLCLS,  &
        & ZNBVNO(:, :, JBLK), ZMRIPP(:, :, JBLK), ZDSA_CPS(:, JBLK), ZGWDCS(:, JBLK), ZDSA_LHS(:, JBLK), ZPCLS(:, JBLK),  &
        & ZFLU_CD(:, JBLK), ZFLU_CDN(:, JBLK))
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACHMTLS')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
        ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
        ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
        ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
        ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
        ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
        ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
        ZDPHI => GET_HOST_DATA_RDWR(YL_ZDPHI)
        ZRTI => GET_HOST_DATA_RDWR(YL_ZRTI)
        ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
        ZPRS => GET_HOST_DATA_RDWR(YL_ZPRS)
        ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
        Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS(JLON))
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, YDCPG_OPTS%KFLEVG))
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI(JLON, YDCPG_OPTS%KFLEVG))
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R =>  &
        & GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R(JLON, YDCPG_OPTS%KFLEVG))
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF(JLON, YDCPG_OPTS%KFLEVG))
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => NULL()
      ZMRIPP => NULL()
      ZDPHIT => NULL()
      ZNBVNO => NULL()
      ZFLU_CD => NULL()
      ZDSA_LHS => NULL()
      ZGWDCS => NULL()
      ZDPHI => NULL()
      ZRTI => NULL()
      ZFLU_CDN => NULL()
      ZPRS => NULL()
      ZDSA_CPS => NULL()
      Z_YDMF_PHYS_OUT_GZ0 => NULL()
      Z_YDCPG_MISC_QS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_OUT_GZ0H => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:ACHMTLS')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
      ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
      ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
      ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
      ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
      ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
      ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
      ZDPHI => GET_HOST_DATA_RDWR(YL_ZDPHI)
      ZRTI => GET_HOST_DATA_RDWR(YL_ZRTI)
      ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
      ZPRS => GET_HOST_DATA_RDWR(YL_ZPRS)
      ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS(JLON))
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL ACHMTLS_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
          & YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), ZDPHIT(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_GZ0H(:, JBLK), LLCLS, ZNBVNO(:, :, JBLK), ZMRIPP(:, :, JBLK), ZDSA_CPS(:, JBLK), ZGWDCS(:, JBLK),  &
          & ZDSA_LHS(:, JBLK), ZPCLS(:, JBLK), ZFLU_CD(:, JBLK), ZFLU_CDN(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACHMTLS')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
        ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
        ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
        ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
        ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
        ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
        ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
        ZDPHI => GET_HOST_DATA_RDWR(YL_ZDPHI)
        ZRTI => GET_HOST_DATA_RDWR(YL_ZRTI)
        ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
        ZPRS => GET_HOST_DATA_RDWR(YL_ZPRS)
        ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
        Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS(JLON))
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, YDCPG_OPTS%KFLEVG))
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI(JLON, YDCPG_OPTS%KFLEVG))
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R =>  &
        & GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R(JLON, YDCPG_OPTS%KFLEVG))
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF(JLON, YDCPG_OPTS%KFLEVG))
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => NULL()
      ZMRIPP => NULL()
      ZDPHIT => NULL()
      ZNBVNO => NULL()
      ZFLU_CD => NULL()
      ZDSA_LHS => NULL()
      ZGWDCS => NULL()
      ZDPHI => NULL()
      ZRTI => NULL()
      ZFLU_CDN => NULL()
      ZPRS => NULL()
      ZDSA_CPS => NULL()
      Z_YDMF_PHYS_OUT_GZ0 => NULL()
      Z_YDCPG_MISC_QS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_OUT_GZ0H => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:ACHMTLS')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => GET_DEVICE_DATA_RDWR(YL_ZPCLS)
      ZMRIPP => GET_DEVICE_DATA_RDWR(YL_ZMRIPP)
      ZDPHIT => GET_DEVICE_DATA_RDWR(YL_ZDPHIT)
      ZNBVNO => GET_DEVICE_DATA_RDWR(YL_ZNBVNO)
      ZFLU_CD => GET_DEVICE_DATA_RDWR(YL_ZFLU_CD)
      ZDSA_LHS => GET_DEVICE_DATA_RDWR(YL_ZDSA_LHS)
      ZGWDCS => GET_DEVICE_DATA_RDWR(YL_ZGWDCS)
      ZDPHI => GET_DEVICE_DATA_RDWR(YL_ZDPHI)
      ZRTI => GET_DEVICE_DATA_RDWR(YL_ZRTI)
      ZFLU_CDN => GET_DEVICE_DATA_RDWR(YL_ZFLU_CDN)
      ZPRS => GET_DEVICE_DATA_RDWR(YL_ZPRS)
      ZDSA_CPS => GET_DEVICE_DATA_RDWR(YL_ZDSA_CPS)
      Z_YDMF_PHYS_OUT_GZ0 => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
      Z_YDCPG_MISC_QS => GET_DEVICE_DATA_RDWR(YDCPG_MISC%F_QS(JLON))
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_OUT_GZ0H => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R =>  &
      & GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZPCLS, ZMRIPP, ZDPHIT, ZNBVNO, ZFLU_CD, ZDSA_LHS,  &
!$ACC & ZGWDCS, ZDPHI, ZRTI, ZFLU_CDN, ZPRS, ZDSA_CPS, Z_YDMF_PHYS_OUT_GZ0, Z_YDCPG_MISC_QS, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_OUT_GZ0H,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDMF_PHYS_BASE_STATE_U, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL ACHMTLS_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
          & YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), ZDPHIT(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_GZ0H(:, JBLK), LLCLS, ZNBVNO(:, :, JBLK), ZMRIPP(:, :, JBLK), ZDSA_CPS(:, JBLK), ZGWDCS(:, JBLK),  &
          & ZDSA_LHS(:, JBLK), ZPCLS(:, JBLK), ZFLU_CD(:, JBLK), ZFLU_CDN(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACHMTLS')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
        ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
        ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
        ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
        ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
        ZDSA_LHS => GET_HOST_DATA_RDWR(YL_ZDSA_LHS)
        ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
        ZDPHI => GET_HOST_DATA_RDWR(YL_ZDPHI)
        ZRTI => GET_HOST_DATA_RDWR(YL_ZRTI)
        ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
        ZPRS => GET_HOST_DATA_RDWR(YL_ZPRS)
        ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
        Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS(JLON))
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, YDCPG_OPTS%KFLEVG))
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI(JLON, YDCPG_OPTS%KFLEVG))
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R =>  &
        & GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R(JLON, YDCPG_OPTS%KFLEVG))
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF(JLON, YDCPG_OPTS%KFLEVG))
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => NULL()
      ZMRIPP => NULL()
      ZDPHIT => NULL()
      ZNBVNO => NULL()
      ZFLU_CD => NULL()
      ZDSA_LHS => NULL()
      ZGWDCS => NULL()
      ZDPHI => NULL()
      ZRTI => NULL()
      ZFLU_CDN => NULL()
      ZPRS => NULL()
      ZDSA_CPS => NULL()
      Z_YDMF_PHYS_OUT_GZ0 => NULL()
      Z_YDCPG_MISC_QS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_OUT_GZ0H => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMTLS', 1, ZHOOK_HANDLE_PARALLEL)
    
  ELSE
    
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT', 0, ZHOOK_HANDLE_PARALLEL)
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACHMT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
      ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
      ZPFL_FPLSH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLSH)
      ZHU => GET_HOST_DATA_RDWR(YL_ZHU)
      ZCDROV => GET_HOST_DATA_RDWR(YL_ZCDROV)
      ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
      ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
      ZPFL_FPLCH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLCH)
      ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
      ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
      ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
      ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
      ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
      ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
      ZSTAB => GET_HOST_DATA_RDWR(YL_ZSTAB)
      ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
      ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZDPHIV => GET_HOST_DATA_RDWR(YL_ZDPHIV)
      ZHQ => GET_HOST_DATA_RDWR(YL_ZHQ)
      ZXDROV => GET_HOST_DATA_RDWR(YL_ZXDROV)
      ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
      ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
      ZRTI => GET_HOST_DATA_RDWR(YL_ZRTI)
      ZXHROV => GET_HOST_DATA_RDWR(YL_ZXHROV)
      ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
      ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
      ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F(:, 1))
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NUCLS)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
      Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NVCLS)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_HV)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL ACHMT(YDCPG_OPTS%YRCLI, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY0, YDMODEL%YRML_PHY_MF%YRPHY1,  &
        & YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG,  &
        & YDCPG_OPTS%YRSURF_DIMS%YSD_VVD%NUMFLDS >= 8 .and. YDMODEL%YRML_PHY_MF%YRPHY%LSOLV,  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK), ZQV(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), ZPFL_FPLSH(:, :, JBLK),  &
        & ZPFL_FPLCH(:, :, JBLK), ZDPHIT(:, JBLK), ZDPHIV(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PHV(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), ZNEIJG(:, JBLK), ZNEIJV(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK), ZWFC(:, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), LLCLS, LLHMT,  &
        & ZNBVNO(:, :, JBLK), ZMRIPP(:, :, JBLK), ZFLU_CD(:, JBLK), ZFLU_CDN(:, JBLK), ZCDROV(:, JBLK), ZFLU_CH(:, JBLK),  &
        & ZCHROV(:, JBLK), ZDSA_CPS(:, JBLK), ZDQSTS(:, JBLK), ZGWDCS(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_GZ0H(:, JBLK), ZHQ(:, JBLK), ZHU(:, JBLK), ZFLU_NEIJ(:, JBLK), Z_YDMF_PHYS_OUT_QCLS(:, JBLK),  &
        & Z_YDCPG_MISC_QS(:, JBLK), ZFLU_QSATS(:, JBLK), Z_YDMF_PHYS_OUT_RHCLS(:, JBLK), ZDSA_RS(:, JBLK), ZRTI(:, JBLK),  &
        & ZSTAB(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK), Z_YDMF_PHYS_OUT_UCLS(:, JBLK), Z_YDMF_PHYS_OUT_VCLS(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_NUCLS(:, JBLK), Z_YDMF_PHYS_OUT_NVCLS(:, JBLK), ZPCLS(:, JBLK), ZFLU_VEG(:, JBLK), ZXDROV(:, JBLK),  &
        & ZXHROV(:, JBLK), Z_YDMF_PHYS_OUT_UGST(:, JBLK), Z_YDMF_PHYS_OUT_VGST(:, JBLK))
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACHMT')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
        ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
        ZPFL_FPLSH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLSH)
        ZHU => GET_HOST_DATA_RDWR(YL_ZHU)
        ZCDROV => GET_HOST_DATA_RDWR(YL_ZCDROV)
        ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
        ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
        ZPFL_FPLCH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLCH)
        ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
        ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
        ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
        ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
        ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
        ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
        ZSTAB => GET_HOST_DATA_RDWR(YL_ZSTAB)
        ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
        ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
        ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
        ZDPHIV => GET_HOST_DATA_RDWR(YL_ZDPHIV)
        ZHQ => GET_HOST_DATA_RDWR(YL_ZHQ)
        ZXDROV => GET_HOST_DATA_RDWR(YL_ZXDROV)
        ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
        ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
        ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
        ZRTI => GET_HOST_DATA_RDWR(YL_ZRTI)
        ZXHROV => GET_HOST_DATA_RDWR(YL_ZXHROV)
        ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
        ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
        ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F(:, 1))
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NUCLS)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
        Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
        Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
        Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
        Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
        Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
        Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
        Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
        Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NVCLS)
        Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
        Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_HV)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => NULL()
      ZMRIPP => NULL()
      ZPFL_FPLSH => NULL()
      ZHU => NULL()
      ZCDROV => NULL()
      ZDQSTS => NULL()
      ZFLU_CH => NULL()
      ZPFL_FPLCH => NULL()
      ZGWDCS => NULL()
      ZDSA_RS => NULL()
      ZDPHIT => NULL()
      ZFLU_CD => NULL()
      ZFLU_VEG => NULL()
      ZFLU_CDN => NULL()
      ZSTAB => NULL()
      ZNEIJV => NULL()
      ZNBVNO => NULL()
      ZQV => NULL()
      ZDPHIV => NULL()
      ZHQ => NULL()
      ZXDROV => NULL()
      ZCHROV => NULL()
      ZFLU_NEIJ => NULL()
      ZNEIJG => NULL()
      ZRTI => NULL()
      ZXHROV => NULL()
      ZFLU_QSATS => NULL()
      ZDSA_CPS => NULL()
      ZWFC => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_OUT_NUCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDMF_PHYS_OUT_RHCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL()
      Z_YDMF_PHYS_OUT_VCLS => NULL()
      Z_YDMF_PHYS_OUT_UGST => NULL()
      Z_YDMF_PHYS_OUT_UCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      Z_YDMF_PHYS_OUT_GZ0 => NULL()
      Z_YDCPG_MISC_QS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL()
      Z_YDMF_PHYS_OUT_GZ0H => NULL()
      Z_YDMF_PHYS_OUT_TCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_OUT_QCLS => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL()
      Z_YDMF_PHYS_OUT_VGST => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL()
      Z_YDMF_PHYS_OUT_NVCLS => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:ACHMT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
      ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
      ZPFL_FPLSH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLSH)
      ZHU => GET_HOST_DATA_RDWR(YL_ZHU)
      ZCDROV => GET_HOST_DATA_RDWR(YL_ZCDROV)
      ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
      ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
      ZPFL_FPLCH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLCH)
      ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
      ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
      ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
      ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
      ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
      ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
      ZSTAB => GET_HOST_DATA_RDWR(YL_ZSTAB)
      ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
      ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZDPHIV => GET_HOST_DATA_RDWR(YL_ZDPHIV)
      ZHQ => GET_HOST_DATA_RDWR(YL_ZHQ)
      ZXDROV => GET_HOST_DATA_RDWR(YL_ZXDROV)
      ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
      ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
      ZRTI => GET_HOST_DATA_RDWR(YL_ZRTI)
      ZXHROV => GET_HOST_DATA_RDWR(YL_ZXHROV)
      ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
      ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
      ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F(:, 1))
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NUCLS)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
      Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NVCLS)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_HV)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL ACHMT_OPENACC(YDCPG_OPTS%YRCLI, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY0,  &
          & YDMODEL%YRML_PHY_MF%YRPHY1, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,  &
          & YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG,  &
          & YDCPG_OPTS%YRSURF_DIMS%YSD_VVD%NUMFLDS >= 8 .and. YDMODEL%YRML_PHY_MF%YRPHY%LSOLV,  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK), ZQV(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), ZPFL_FPLSH(:, :, JBLK),  &
          & ZPFL_FPLCH(:, :, JBLK), ZDPHIT(:, JBLK), ZDPHIV(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VV_PHV(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), ZNEIJG(:, JBLK), ZNEIJV(:, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK), ZWFC(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), LLCLS, LLHMT, ZNBVNO(:, :, JBLK), ZMRIPP(:, :, JBLK), ZFLU_CD(:, JBLK),  &
          & ZFLU_CDN(:, JBLK), ZCDROV(:, JBLK), ZFLU_CH(:, JBLK), ZCHROV(:, JBLK), ZDSA_CPS(:, JBLK), ZDQSTS(:, JBLK),  &
          & ZGWDCS(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_OUT_GZ0H(:, JBLK), ZHQ(:, JBLK), ZHU(:, JBLK),  &
          & ZFLU_NEIJ(:, JBLK), Z_YDMF_PHYS_OUT_QCLS(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), ZFLU_QSATS(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_RHCLS(:, JBLK), ZDSA_RS(:, JBLK), ZRTI(:, JBLK), ZSTAB(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_UCLS(:, JBLK), Z_YDMF_PHYS_OUT_VCLS(:, JBLK), Z_YDMF_PHYS_OUT_NUCLS(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_NVCLS(:, JBLK), ZPCLS(:, JBLK), ZFLU_VEG(:, JBLK), ZXDROV(:, JBLK), ZXHROV(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_UGST(:, JBLK), Z_YDMF_PHYS_OUT_VGST(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACHMT')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
        ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
        ZPFL_FPLSH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLSH)
        ZHU => GET_HOST_DATA_RDWR(YL_ZHU)
        ZCDROV => GET_HOST_DATA_RDWR(YL_ZCDROV)
        ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
        ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
        ZPFL_FPLCH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLCH)
        ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
        ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
        ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
        ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
        ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
        ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
        ZSTAB => GET_HOST_DATA_RDWR(YL_ZSTAB)
        ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
        ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
        ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
        ZDPHIV => GET_HOST_DATA_RDWR(YL_ZDPHIV)
        ZHQ => GET_HOST_DATA_RDWR(YL_ZHQ)
        ZXDROV => GET_HOST_DATA_RDWR(YL_ZXDROV)
        ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
        ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
        ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
        ZRTI => GET_HOST_DATA_RDWR(YL_ZRTI)
        ZXHROV => GET_HOST_DATA_RDWR(YL_ZXHROV)
        ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
        ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
        ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F(:, 1))
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NUCLS)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
        Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
        Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
        Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
        Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
        Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
        Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
        Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
        Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NVCLS)
        Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
        Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_HV)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => NULL()
      ZMRIPP => NULL()
      ZPFL_FPLSH => NULL()
      ZHU => NULL()
      ZCDROV => NULL()
      ZDQSTS => NULL()
      ZFLU_CH => NULL()
      ZPFL_FPLCH => NULL()
      ZGWDCS => NULL()
      ZDSA_RS => NULL()
      ZDPHIT => NULL()
      ZFLU_CD => NULL()
      ZFLU_VEG => NULL()
      ZFLU_CDN => NULL()
      ZSTAB => NULL()
      ZNEIJV => NULL()
      ZNBVNO => NULL()
      ZQV => NULL()
      ZDPHIV => NULL()
      ZHQ => NULL()
      ZXDROV => NULL()
      ZCHROV => NULL()
      ZFLU_NEIJ => NULL()
      ZNEIJG => NULL()
      ZRTI => NULL()
      ZXHROV => NULL()
      ZFLU_QSATS => NULL()
      ZDSA_CPS => NULL()
      ZWFC => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_OUT_NUCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDMF_PHYS_OUT_RHCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL()
      Z_YDMF_PHYS_OUT_VCLS => NULL()
      Z_YDMF_PHYS_OUT_UGST => NULL()
      Z_YDMF_PHYS_OUT_UCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      Z_YDMF_PHYS_OUT_GZ0 => NULL()
      Z_YDCPG_MISC_QS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL()
      Z_YDMF_PHYS_OUT_GZ0H => NULL()
      Z_YDMF_PHYS_OUT_TCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_OUT_QCLS => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL()
      Z_YDMF_PHYS_OUT_VGST => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL()
      Z_YDMF_PHYS_OUT_NVCLS => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:ACHMT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => GET_DEVICE_DATA_RDWR(YL_ZPCLS)
      ZMRIPP => GET_DEVICE_DATA_RDWR(YL_ZMRIPP)
      ZPFL_FPLSH => GET_DEVICE_DATA_RDWR(YL_ZPFL_FPLSH)
      ZHU => GET_DEVICE_DATA_RDWR(YL_ZHU)
      ZCDROV => GET_DEVICE_DATA_RDWR(YL_ZCDROV)
      ZDQSTS => GET_DEVICE_DATA_RDWR(YL_ZDQSTS)
      ZFLU_CH => GET_DEVICE_DATA_RDWR(YL_ZFLU_CH)
      ZPFL_FPLCH => GET_DEVICE_DATA_RDWR(YL_ZPFL_FPLCH)
      ZGWDCS => GET_DEVICE_DATA_RDWR(YL_ZGWDCS)
      ZDSA_RS => GET_DEVICE_DATA_RDWR(YL_ZDSA_RS)
      ZDPHIT => GET_DEVICE_DATA_RDWR(YL_ZDPHIT)
      ZFLU_CD => GET_DEVICE_DATA_RDWR(YL_ZFLU_CD)
      ZFLU_VEG => GET_DEVICE_DATA_RDWR(YL_ZFLU_VEG)
      ZFLU_CDN => GET_DEVICE_DATA_RDWR(YL_ZFLU_CDN)
      ZSTAB => GET_DEVICE_DATA_RDWR(YL_ZSTAB)
      ZNEIJV => GET_DEVICE_DATA_RDWR(YL_ZNEIJV)
      ZNBVNO => GET_DEVICE_DATA_RDWR(YL_ZNBVNO)
      ZQV => GET_DEVICE_DATA_RDWR(YL_ZQV)
      ZDPHIV => GET_DEVICE_DATA_RDWR(YL_ZDPHIV)
      ZHQ => GET_DEVICE_DATA_RDWR(YL_ZHQ)
      ZXDROV => GET_DEVICE_DATA_RDWR(YL_ZXDROV)
      ZCHROV => GET_DEVICE_DATA_RDWR(YL_ZCHROV)
      ZFLU_NEIJ => GET_DEVICE_DATA_RDWR(YL_ZFLU_NEIJ)
      ZNEIJG => GET_DEVICE_DATA_RDWR(YL_ZNEIJG)
      ZRTI => GET_DEVICE_DATA_RDWR(YL_ZRTI)
      ZXHROV => GET_DEVICE_DATA_RDWR(YL_ZXHROV)
      ZFLU_QSATS => GET_DEVICE_DATA_RDWR(YL_ZFLU_QSATS)
      ZDSA_CPS => GET_DEVICE_DATA_RDWR(YL_ZDSA_CPS)
      ZWFC => GET_DEVICE_DATA_RDWR(YL_ZWFC)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F(:, 1))
      Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_OUT_NUCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_NUCLS)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_OUT_RHCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_OUT_VCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_UCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_OUT_GZ0 => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
      Z_YDCPG_MISC_QS => GET_DEVICE_DATA_RDWR(YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_OUT_GZ0H => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
      Z_YDMF_PHYS_OUT_TCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_OUT_QCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      Z_YDMF_PHYS_OUT_VGST => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_OUT_NVCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_NVCLS)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_HV)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZPCLS, ZMRIPP, ZPFL_FPLSH, ZHU, ZCDROV, ZDQSTS,  &
!$ACC & ZFLU_CH, ZPFL_FPLCH, ZGWDCS, ZDSA_RS, ZDPHIT, ZFLU_CD, ZFLU_VEG, ZFLU_CDN, ZSTAB, ZNEIJV, ZNBVNO, ZQV, ZDPHIV, ZHQ,  &
!$ACC & ZXDROV, ZCHROV, ZFLU_NEIJ, ZNEIJG, ZRTI, ZXHROV, ZFLU_QSATS, ZDSA_CPS, ZWFC, Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_OUT_NUCLS, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDMF_PHYS_OUT_RHCLS, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W, Z_YDMF_PHYS_OUT_VCLS, Z_YDMF_PHYS_OUT_UGST, Z_YDMF_PHYS_OUT_UCLS,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_U, Z_YDMF_PHYS_OUT_GZ0, Z_YDCPG_MISC_QS, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T,  &
!$ACC & Z_YDMF_PHYS_SURF_GSD_VF_PLSM, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP, Z_YDMF_PHYS_SURF_GSD_VF_PZ0F, Z_YDMF_PHYS_OUT_GZ0H, Z_YDMF_PHYS_OUT_TCLS,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, Z_YDMF_PHYS_OUT_QCLS, Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF,  &
!$ACC & Z_YDMF_PHYS_SURF_GSD_VV_PZ0H, Z_YDMF_PHYS_OUT_VGST, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC, Z_YDMF_PHYS_OUT_NVCLS,  &
!$ACC & Z_YDMF_PHYS_SURF_GSD_VF_PVEG, Z_YDMF_PHYS_SURF_GSD_VV_PHV, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL ACHMT_OPENACC(YDCPG_OPTS%YRCLI, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY0,  &
          & YDMODEL%YRML_PHY_MF%YRPHY1, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,  &
          & YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG,  &
          & YDCPG_OPTS%YRSURF_DIMS%YSD_VVD%NUMFLDS >= 8 .and. YDMODEL%YRML_PHY_MF%YRPHY%LSOLV,  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK), ZQV(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), ZPFL_FPLSH(:, :, JBLK),  &
          & ZPFL_FPLCH(:, :, JBLK), ZDPHIT(:, JBLK), ZDPHIV(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VV_PHV(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), ZNEIJG(:, JBLK), ZNEIJV(:, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK), ZWFC(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), LLCLS, LLHMT, ZNBVNO(:, :, JBLK), ZMRIPP(:, :, JBLK), ZFLU_CD(:, JBLK),  &
          & ZFLU_CDN(:, JBLK), ZCDROV(:, JBLK), ZFLU_CH(:, JBLK), ZCHROV(:, JBLK), ZDSA_CPS(:, JBLK), ZDQSTS(:, JBLK),  &
          & ZGWDCS(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_OUT_GZ0H(:, JBLK), ZHQ(:, JBLK), ZHU(:, JBLK),  &
          & ZFLU_NEIJ(:, JBLK), Z_YDMF_PHYS_OUT_QCLS(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), ZFLU_QSATS(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_RHCLS(:, JBLK), ZDSA_RS(:, JBLK), ZRTI(:, JBLK), ZSTAB(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_UCLS(:, JBLK), Z_YDMF_PHYS_OUT_VCLS(:, JBLK), Z_YDMF_PHYS_OUT_NUCLS(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_NVCLS(:, JBLK), ZPCLS(:, JBLK), ZFLU_VEG(:, JBLK), ZXDROV(:, JBLK), ZXHROV(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_UGST(:, JBLK), Z_YDMF_PHYS_OUT_VGST(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACHMT')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
        ZMRIPP => GET_HOST_DATA_RDWR(YL_ZMRIPP)
        ZPFL_FPLSH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLSH)
        ZHU => GET_HOST_DATA_RDWR(YL_ZHU)
        ZCDROV => GET_HOST_DATA_RDWR(YL_ZCDROV)
        ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
        ZFLU_CH => GET_HOST_DATA_RDWR(YL_ZFLU_CH)
        ZPFL_FPLCH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLCH)
        ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
        ZDSA_RS => GET_HOST_DATA_RDWR(YL_ZDSA_RS)
        ZDPHIT => GET_HOST_DATA_RDWR(YL_ZDPHIT)
        ZFLU_CD => GET_HOST_DATA_RDWR(YL_ZFLU_CD)
        ZFLU_VEG => GET_HOST_DATA_RDWR(YL_ZFLU_VEG)
        ZFLU_CDN => GET_HOST_DATA_RDWR(YL_ZFLU_CDN)
        ZSTAB => GET_HOST_DATA_RDWR(YL_ZSTAB)
        ZNEIJV => GET_HOST_DATA_RDWR(YL_ZNEIJV)
        ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
        ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
        ZDPHIV => GET_HOST_DATA_RDWR(YL_ZDPHIV)
        ZHQ => GET_HOST_DATA_RDWR(YL_ZHQ)
        ZXDROV => GET_HOST_DATA_RDWR(YL_ZXDROV)
        ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
        ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
        ZNEIJG => GET_HOST_DATA_RDWR(YL_ZNEIJG)
        ZRTI => GET_HOST_DATA_RDWR(YL_ZRTI)
        ZXHROV => GET_HOST_DATA_RDWR(YL_ZXHROV)
        ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
        ZDSA_CPS => GET_HOST_DATA_RDWR(YL_ZDSA_CPS)
        ZWFC => GET_HOST_DATA_RDWR(YL_ZWFC)
        Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_SG%F_F(:, 1))
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NUCLS)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
        Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
        Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
        Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0F)
        Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0H)
        Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
        Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
        Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_Z0H)
        Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
        Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_NVCLS)
        Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VEG)
        Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VV%F_HV)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => NULL()
      ZMRIPP => NULL()
      ZPFL_FPLSH => NULL()
      ZHU => NULL()
      ZCDROV => NULL()
      ZDQSTS => NULL()
      ZFLU_CH => NULL()
      ZPFL_FPLCH => NULL()
      ZGWDCS => NULL()
      ZDSA_RS => NULL()
      ZDPHIT => NULL()
      ZFLU_CD => NULL()
      ZFLU_VEG => NULL()
      ZFLU_CDN => NULL()
      ZSTAB => NULL()
      ZNEIJV => NULL()
      ZNBVNO => NULL()
      ZQV => NULL()
      ZDPHIV => NULL()
      ZHQ => NULL()
      ZXDROV => NULL()
      ZCHROV => NULL()
      ZFLU_NEIJ => NULL()
      ZNEIJG => NULL()
      ZRTI => NULL()
      ZXHROV => NULL()
      ZFLU_QSATS => NULL()
      ZDSA_CPS => NULL()
      ZWFC => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_OUT_NUCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDMF_PHYS_OUT_RHCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL()
      Z_YDMF_PHYS_OUT_VCLS => NULL()
      Z_YDMF_PHYS_OUT_UGST => NULL()
      Z_YDMF_PHYS_OUT_UCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      Z_YDMF_PHYS_OUT_GZ0 => NULL()
      Z_YDCPG_MISC_QS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL()
      Z_YDMF_PHYS_OUT_GZ0H => NULL()
      Z_YDMF_PHYS_OUT_TCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_OUT_QCLS => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL()
      Z_YDMF_PHYS_OUT_VGST => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL()
      Z_YDMF_PHYS_OUT_NVCLS => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL()
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACHMT', 1, ZHOOK_HANDLE_PARALLEL)
    
  END IF
  
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACCLPH')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZTHETAV => GET_HOST_DATA_RDWR(YL_ZTHETAV)
    ZBLH => GET_HOST_DATA_RDWR(YL_ZBLH)
    IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
    ZTHETAVS => GET_HOST_DATA_RDWR(YL_ZTHETAVS)
    ZVGST => GET_HOST_DATA_RDWR(YL_ZVGST)
    ZUGST => GET_HOST_DATA_RDWR(YL_ZUGST)
    ZCP => GET_HOST_DATA_RDWR(YL_ZCP)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T(JLON))
    Z_YDMF_PHYS_OUT_VEIN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VEIN)
    Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH(JLON))
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS(JLON))
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD(JLON, YDCPG_OPTS%KFLEVG))
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP(JLON, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL ACCLPH(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY0, YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,  &
      & YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, ZTHETAV(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), ZTHETAVS(:, JBLK), IMOC_CLPH(:, JBLK),  &
      & Z_YDMF_PHYS_OUT_CLPH(:, JBLK), Z_YDMF_PHYS_OUT_VEIN(:, JBLK), ZUGST(:, JBLK), ZVGST(:, JBLK))
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACCLPH')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZTHETAV => GET_HOST_DATA_RDWR(YL_ZTHETAV)
      ZBLH => GET_HOST_DATA_RDWR(YL_ZBLH)
      IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
      ZTHETAVS => GET_HOST_DATA_RDWR(YL_ZTHETAVS)
      ZVGST => GET_HOST_DATA_RDWR(YL_ZVGST)
      ZUGST => GET_HOST_DATA_RDWR(YL_ZUGST)
      ZCP => GET_HOST_DATA_RDWR(YL_ZCP)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T(JLON))
      Z_YDMF_PHYS_OUT_VEIN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VEIN)
      Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH(JLON))
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS(JLON))
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD =>  &
      & GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP(JLON, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZTHETAV => NULL()
    ZBLH => NULL()
    IMOC_CLPH => NULL()
    ZTHETAVS => NULL()
    ZVGST => NULL()
    ZUGST => NULL()
    ZCP => NULL()
    ZQV => NULL()
    Z_YDMF_PHYS_BASE_STATE_U => NULL()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
    Z_YDMF_PHYS_OUT_VEIN => NULL()
    Z_YDMF_PHYS_OUT_CLPH => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
    Z_YDMF_PHYS_BASE_STATE_V => NULL()
    Z_YDCPG_MISC_QS => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:ACCLPH')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZTHETAV => GET_HOST_DATA_RDWR(YL_ZTHETAV)
    ZBLH => GET_HOST_DATA_RDWR(YL_ZBLH)
    IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
    ZTHETAVS => GET_HOST_DATA_RDWR(YL_ZTHETAVS)
    ZVGST => GET_HOST_DATA_RDWR(YL_ZVGST)
    ZUGST => GET_HOST_DATA_RDWR(YL_ZUGST)
    ZCP => GET_HOST_DATA_RDWR(YL_ZCP)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T(JLON))
    Z_YDMF_PHYS_OUT_VEIN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VEIN)
    Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH(JLON))
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS(JLON))
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD(JLON, YDCPG_OPTS%KFLEVG))
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP(JLON, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL ACCLPH_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY0, YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA,  &
        & YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, ZTHETAV(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), ZTHETAVS(:, JBLK), IMOC_CLPH(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_CLPH(:, JBLK), Z_YDMF_PHYS_OUT_VEIN(:, JBLK), ZUGST(:, JBLK), ZVGST(:, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACCLPH')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZTHETAV => GET_HOST_DATA_RDWR(YL_ZTHETAV)
      ZBLH => GET_HOST_DATA_RDWR(YL_ZBLH)
      IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
      ZTHETAVS => GET_HOST_DATA_RDWR(YL_ZTHETAVS)
      ZVGST => GET_HOST_DATA_RDWR(YL_ZVGST)
      ZUGST => GET_HOST_DATA_RDWR(YL_ZUGST)
      ZCP => GET_HOST_DATA_RDWR(YL_ZCP)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T(JLON))
      Z_YDMF_PHYS_OUT_VEIN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VEIN)
      Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH(JLON))
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS(JLON))
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD =>  &
      & GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP(JLON, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZTHETAV => NULL()
    ZBLH => NULL()
    IMOC_CLPH => NULL()
    ZTHETAVS => NULL()
    ZVGST => NULL()
    ZUGST => NULL()
    ZCP => NULL()
    ZQV => NULL()
    Z_YDMF_PHYS_BASE_STATE_U => NULL()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
    Z_YDMF_PHYS_OUT_VEIN => NULL()
    Z_YDMF_PHYS_OUT_CLPH => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
    Z_YDMF_PHYS_BASE_STATE_V => NULL()
    Z_YDCPG_MISC_QS => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:ACCLPH')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZTHETAV => GET_DEVICE_DATA_RDWR(YL_ZTHETAV)
    ZBLH => GET_DEVICE_DATA_RDWR(YL_ZBLH)
    IMOC_CLPH => GET_DEVICE_DATA_RDWR(YL_IMOC_CLPH)
    ZTHETAVS => GET_DEVICE_DATA_RDWR(YL_ZTHETAVS)
    ZVGST => GET_DEVICE_DATA_RDWR(YL_ZVGST)
    ZUGST => GET_DEVICE_DATA_RDWR(YL_ZUGST)
    ZCP => GET_DEVICE_DATA_RDWR(YL_ZCP)
    ZQV => GET_DEVICE_DATA_RDWR(YL_ZQV)
    Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T(JLON))
    Z_YDMF_PHYS_OUT_VEIN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_VEIN)
    Z_YDMF_PHYS_OUT_CLPH => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH(JLON))
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
    Z_YDCPG_MISC_QS => GET_DEVICE_DATA_RDWR(YDCPG_MISC%F_QS(JLON))
    Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD =>  &
    & GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD(JLON, YDCPG_OPTS%KFLEVG))
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP(JLON, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZTHETAV, ZBLH, IMOC_CLPH, ZTHETAVS, ZVGST, ZUGST,  &
!$ACC & ZCP, ZQV, Z_YDMF_PHYS_BASE_STATE_U, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_OUT_VEIN, Z_YDMF_PHYS_OUT_CLPH,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, Z_YDMF_PHYS_BASE_STATE_V, Z_YDCPG_MISC_QS,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL ACCLPH_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY0, YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA,  &
        & YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, ZTHETAV(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), ZTHETAVS(:, JBLK), IMOC_CLPH(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_CLPH(:, JBLK), Z_YDMF_PHYS_OUT_VEIN(:, JBLK), ZUGST(:, JBLK), ZVGST(:, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACCLPH')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZTHETAV => GET_HOST_DATA_RDWR(YL_ZTHETAV)
      ZBLH => GET_HOST_DATA_RDWR(YL_ZBLH)
      IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
      ZTHETAVS => GET_HOST_DATA_RDWR(YL_ZTHETAVS)
      ZVGST => GET_HOST_DATA_RDWR(YL_ZVGST)
      ZUGST => GET_HOST_DATA_RDWR(YL_ZUGST)
      ZCP => GET_HOST_DATA_RDWR(YL_ZCP)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T(JLON))
      Z_YDMF_PHYS_OUT_VEIN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VEIN)
      Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH(JLON))
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS(JLON))
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD =>  &
      & GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD(JLON, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP(JLON, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZTHETAV => NULL()
    ZBLH => NULL()
    IMOC_CLPH => NULL()
    ZTHETAVS => NULL()
    ZVGST => NULL()
    ZUGST => NULL()
    ZCP => NULL()
    ZQV => NULL()
    Z_YDMF_PHYS_BASE_STATE_U => NULL()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
    Z_YDMF_PHYS_OUT_VEIN => NULL()
    Z_YDMF_PHYS_OUT_CLPH => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
    Z_YDMF_PHYS_BASE_STATE_V => NULL()
    Z_YDCPG_MISC_QS => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACCLPH', 1, ZHOOK_HANDLE_PARALLEL)
  
  CALL APL_ARPEGE_OCEANIC_FLUXES_PARALLEL(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL,  &
  & LLHMT, YL_ZCDROV, YL_ZCEROV, YL_ZCHROV, YL_ZDPHIT, YL_ZDPHIV, YL_ZDSA_RS, YL_ZFLU_CD, YL_ZFLU_CDN, YL_ZFLU_CH, YL_ZFLU_QSATS)
  
  
  CALL APL_WIND_GUST_PARALLEL(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDVARS, YDMODEL, YL_IMOC_CLPH, YL_ZBLH,  &
  & YL_ZDCAPE)
  
  
  CALL APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC,  &
  & YDMF_PHYS, YDMODEL, YDDDH, YL_INLAB_CVPP, YL_ZCDROV, YL_ZCHROV, YL_ZCOEFN, YL_ZCONDCVPPI, YL_ZCONDCVPPL, YL_ZDIFCVPPQ,  &
  & YL_ZDIFCVPPS, YDMODEL%YRML_PHY_MF%YRPHY0%REPS, YL_ZFLU_CD, YL_ZFLU_CH, YL_ZKQLROV, YL_ZKQROV, YL_ZKTROV, YL_ZKUROV,  &
  & YL_ZMSC_LSCPE, YL_ZNBVNO, YL_ZNEBS, YL_ZNEBS0, YL_ZNEB_CVPP, YL_ZPFL_FPLCH, YL_ZPFL_FTKE, YL_ZPFL_FTKEI, YL_ZPRODTH_CVPP,  &
  & YL_ZQI, YL_ZQIC, YL_ZQL, YL_ZQLC, YL_ZQLIS, YL_ZQLIS0, YL_ZQLI_CVPP, YL_ZQV, YL_ZTKE1, YL_ZXTROV, YL_ZXUROV)
  
  CALL APL_ARPEGE_ALBEDO_COMPUTATION_PARALLEL(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL,  &
  & YL_ZALBD, YL_ZALBP, ZEPS0, YL_ZFLU_EMIS, YL_ZFLU_NEIJ, YL_ZRDG_MU0)
  
  CALL APL_ARPEGE_AEROSOLS_FOR_RADIATION_PARALLEL(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS_SURF, YDMODEL,  &
  & YL_ZAER, YL_ZAERINDS)
  
  CALL APL_ARPEGE_CLOUDINESS_PARALLEL(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDMF_PHYS, YDVARS, YDMODEL,  &
  & LLREDPR, YL_ZAIPCMT, YL_ZBLH, YL_ZDECRD, YL_ZFLU_QSAT, YL_ZMSC_QW, YL_ZNEBC0, YL_ZNEBCH, YL_ZNEBS, YL_ZNEBS0, YL_ZNEB_CVPP,  &
  & YL_ZPFL_FPLCH, YL_ZQI, YL_ZQL, YL_ZQLIS, YL_ZQLIS0, YL_ZQLI_CVP, YL_ZQLI_CVPP, YL_ZQV, YL_ZUNEBH, YDGEOMETRY%YRSTA)
  
  CALL APL_ARPEGE_RADIATION_PARALLEL(YDMF_PHYS_BASE_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDCPG_GPAR,  &
  & YDMF_PHYS, YDMF_PHYS_SURF, YDVARS, YDMODEL, YL_ZAER, YL_ZAERINDS, YL_ZALBD, YL_ZALBP, YL_ZCEMTR, YL_ZCTRSO, YL_ZFLU_EMIS,  &
  & YL_ZFLU_QSAT, YL_ZQO3, YL_ZQR, YL_ZQS, YL_ZQV, YL_ZRDG_MU0, YL_ZRDG_MU0LU, YL_ZRDG_MU0M, YL_ZSFSWDIF, YL_ZSFSWDIR, YL_ZSUDU,  &
  & YL_ZTENT, YL_ZTRSOD, YL_ZTRSODIF, YL_ZTRSODIR)
  
  CALL APL_ARPEGE_SOIL_HYDRO_PARALLEL(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL,  &
  & YL_ZCHROV, YL_ZFLU_NEIJ, YL_ZFLU_QSAT, YL_ZFLU_QSATS, YL_ZFLU_VEG, YL_ZGWDCS, YL_ZHQ, YL_ZHTR, YL_ZHU, YL_ZQV, YL_ZWFC,  &
  & YL_ZWLMX, YL_ZWWILT)
  
  CALL APL_ARPEGE_SURFACE_PARALLEL(YDMF_PHYS_BASE_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDCPG_GPAR, YDMF_PHYS,  &
  & YDMF_PHYS_SURF, YDVARS, YDMODEL, YL_ZALBD, YL_ZALBP, YL_ZALPHA1, YL_ZCDROV, YL_ZCEROV, YL_ZCFATH, YL_ZCFAU, YL_ZCFBTH,  &
  & YL_ZCFBU, YL_ZCFBV, YL_ZCHROV, YL_ZCOEFA, YL_ZCOEFN, YL_ZCP, YL_ZDIFEXT, YL_ZDIFWQ, YL_ZDIFWS, YL_ZDQSTS, YL_ZDSA_CPS,  &
  & YL_ZDSA_LHS, ZDTMSE, YL_ZEDMFQ, YL_ZEDMFS, YL_ZEDMFU, YL_ZEDMFV, YL_ZFLU_CD, YL_ZFLU_CDN, YL_ZFLU_EMIS, YL_ZFLU_FEVI,  &
  & YL_ZFLU_NEIJ, YL_ZFLU_QSATS, YL_ZFLU_VEG, YL_ZHQ, YL_ZHTR, YL_ZHU, YL_ZKQLROV, YL_ZKQROV, YL_ZKTROV, YL_ZKUROV, YL_ZLVT,  &
  & YL_ZMF_UP, YL_ZNEBCH, YL_ZNEBDIFF, YL_ZNEBS, YL_ZPOID, YL_ZQI, YL_ZQICE, YL_ZQL, YL_ZQV, YL_ZRDG_MU0, YL_ZRDG_MU0N, ZRHGMT,  &
  & YL_ZSC_FCLL, YL_ZSC_FCLN, YL_ZSC_FEVI, YL_ZSC_FEVN, YL_ZSFSWDIF, YL_ZSFSWDIR, YL_ZSGROUPEL, YL_ZSRAIN, YL_ZSSNOW, ZSTATI,  &
  & YL_ZTSN, YL_ZXDROV, YL_ZXHROV, YL_ZXQRO, YL_ZXTRO, YL_ZXTROV, YL_ZXURO, YL_ZXUROV)
  
  ! The deep convection will see the shallow part from KFB as it is with Louis scheme and the modified RI
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:DIFTQ')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZDIFCVPPU => GET_HOST_DATA_RDWR(YL_ZDIFCVPPU)
    ZDIFCVPPS => GET_HOST_DATA_RDWR(YL_ZDIFCVPPS)
    ZDIFCVPPV => GET_HOST_DATA_RDWR(YL_ZDIFCVPPV)
    ZDIFCVPPQ => GET_HOST_DATA_RDWR(YL_ZDIFCVPPQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTS(JLON, JLEV))
    Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRTU(JLON, JLEV))
    Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRTV(JLON, JLEV))
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ(JLON, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:DIFTQ')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZDIFCVPPU => GET_HOST_DATA_RDWR(YL_ZDIFCVPPU)
      ZDIFCVPPS => GET_HOST_DATA_RDWR(YL_ZDIFCVPPS)
      ZDIFCVPPV => GET_HOST_DATA_RDWR(YL_ZDIFCVPPV)
      ZDIFCVPPQ => GET_HOST_DATA_RDWR(YL_ZDIFCVPPQ)
      Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTS(JLON, JLEV))
      Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRTU(JLON, JLEV))
      Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRTV(JLON, JLEV))
      Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ(JLON, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZDIFCVPPU => NULL()
    ZDIFCVPPS => NULL()
    ZDIFCVPPV => NULL()
    ZDIFCVPPQ => NULL()
    Z_YDMF_PHYS_OUT_DIFTS => NULL()
    Z_YDMF_PHYS_OUT_STRTU => NULL()
    Z_YDMF_PHYS_OUT_STRTV => NULL()
    Z_YDMF_PHYS_OUT_DIFTQ => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:DIFTQ')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZDIFCVPPU => GET_HOST_DATA_RDWR(YL_ZDIFCVPPU)
    ZDIFCVPPS => GET_HOST_DATA_RDWR(YL_ZDIFCVPPS)
    ZDIFCVPPV => GET_HOST_DATA_RDWR(YL_ZDIFCVPPV)
    ZDIFCVPPQ => GET_HOST_DATA_RDWR(YL_ZDIFCVPPQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTS(JLON, JLEV))
    Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRTU(JLON, JLEV))
    Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRTV(JLON, JLEV))
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ(JLON, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:DIFTQ')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZDIFCVPPU => GET_HOST_DATA_RDWR(YL_ZDIFCVPPU)
      ZDIFCVPPS => GET_HOST_DATA_RDWR(YL_ZDIFCVPPS)
      ZDIFCVPPV => GET_HOST_DATA_RDWR(YL_ZDIFCVPPV)
      ZDIFCVPPQ => GET_HOST_DATA_RDWR(YL_ZDIFCVPPQ)
      Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTS(JLON, JLEV))
      Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRTU(JLON, JLEV))
      Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRTV(JLON, JLEV))
      Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ(JLON, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZDIFCVPPU => NULL()
    ZDIFCVPPS => NULL()
    ZDIFCVPPV => NULL()
    ZDIFCVPPQ => NULL()
    Z_YDMF_PHYS_OUT_DIFTS => NULL()
    Z_YDMF_PHYS_OUT_STRTU => NULL()
    Z_YDMF_PHYS_OUT_STRTV => NULL()
    Z_YDMF_PHYS_OUT_DIFTQ => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:DIFTQ')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZDIFCVPPU => GET_DEVICE_DATA_RDWR(YL_ZDIFCVPPU)
    ZDIFCVPPS => GET_DEVICE_DATA_RDWR(YL_ZDIFCVPPS)
    ZDIFCVPPV => GET_DEVICE_DATA_RDWR(YL_ZDIFCVPPV)
    ZDIFCVPPQ => GET_DEVICE_DATA_RDWR(YL_ZDIFCVPPQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTS(JLON, JLEV))
    Z_YDMF_PHYS_OUT_STRTU => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_STRTU(JLON, JLEV))
    Z_YDMF_PHYS_OUT_STRTV => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_STRTV(JLON, JLEV))
    Z_YDMF_PHYS_OUT_DIFTQ => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ(JLON, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZDIFCVPPU, ZDIFCVPPS, ZDIFCVPPV, ZDIFCVPPQ,  &
!$ACC & Z_YDMF_PHYS_OUT_DIFTS, Z_YDMF_PHYS_OUT_STRTU, Z_YDMF_PHYS_OUT_STRTV, Z_YDMF_PHYS_OUT_DIFTQ, ) PRIVATE( JBLK )  &
!$ACC & VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:DIFTQ')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZDIFCVPPU => GET_HOST_DATA_RDWR(YL_ZDIFCVPPU)
      ZDIFCVPPS => GET_HOST_DATA_RDWR(YL_ZDIFCVPPS)
      ZDIFCVPPV => GET_HOST_DATA_RDWR(YL_ZDIFCVPPV)
      ZDIFCVPPQ => GET_HOST_DATA_RDWR(YL_ZDIFCVPPQ)
      Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTS(JLON, JLEV))
      Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRTU(JLON, JLEV))
      Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRTV(JLON, JLEV))
      Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ(JLON, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZDIFCVPPU => NULL()
    ZDIFCVPPS => NULL()
    ZDIFCVPPV => NULL()
    ZDIFCVPPQ => NULL()
    Z_YDMF_PHYS_OUT_DIFTS => NULL()
    Z_YDMF_PHYS_OUT_STRTU => NULL()
    Z_YDMF_PHYS_OUT_STRTV => NULL()
    Z_YDMF_PHYS_OUT_DIFTQ => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:DIFTQ', 1, ZHOOK_HANDLE_PARALLEL)
  
  ! Additional diagnostics of radiative fluxes (PFRTHDS and PFRSOPT)
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:FRSOPT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
    ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T(JLON))
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRTH(JLON, YDCPG_OPTS%KFLEVG, 1))
    Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRTHDS(JLON))
    Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRSOPT(JLON))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:FRSOPT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
      ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T(JLON))
      Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRTH(JLON, YDCPG_OPTS%KFLEVG, 1))
      Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRTHDS(JLON))
      Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRSOPT(JLON))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0 => NULL()
    ZFLU_EMIS => NULL()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
    Z_YDMF_PHYS_OUT_FRTH => NULL()
    Z_YDMF_PHYS_OUT_FRTHDS => NULL()
    Z_YDMF_PHYS_OUT_FRSOPT => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:FRSOPT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
    ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T(JLON))
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRTH(JLON, YDCPG_OPTS%KFLEVG, 1))
    Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRTHDS(JLON))
    Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRSOPT(JLON))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:FRSOPT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
      ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T(JLON))
      Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRTH(JLON, YDCPG_OPTS%KFLEVG, 1))
      Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRTHDS(JLON))
      Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRSOPT(JLON))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0 => NULL()
    ZFLU_EMIS => NULL()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
    Z_YDMF_PHYS_OUT_FRTH => NULL()
    Z_YDMF_PHYS_OUT_FRTHDS => NULL()
    Z_YDMF_PHYS_OUT_FRSOPT => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:FRSOPT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0 => GET_DEVICE_DATA_RDWR(YL_ZRDG_MU0)
    ZFLU_EMIS => GET_DEVICE_DATA_RDWR(YL_ZFLU_EMIS)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T(JLON))
    Z_YDMF_PHYS_OUT_FRTH => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FRTH(JLON, YDCPG_OPTS%KFLEVG, 1))
    Z_YDMF_PHYS_OUT_FRTHDS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FRTHDS(JLON))
    Z_YDMF_PHYS_OUT_FRSOPT => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FRSOPT(JLON))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZRDG_MU0, ZFLU_EMIS,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_OUT_FRTH, Z_YDMF_PHYS_OUT_FRTHDS, Z_YDMF_PHYS_OUT_FRSOPT, ) PRIVATE( JBLK  &
!$ACC & ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:FRSOPT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZRDG_MU0 => GET_HOST_DATA_RDWR(YL_ZRDG_MU0)
      ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T(JLON))
      Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRTH(JLON, YDCPG_OPTS%KFLEVG, 1))
      Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRTHDS(JLON))
      Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRSOPT(JLON))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0 => NULL()
    ZFLU_EMIS => NULL()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
    Z_YDMF_PHYS_OUT_FRTH => NULL()
    Z_YDMF_PHYS_OUT_FRTHDS => NULL()
    Z_YDMF_PHYS_OUT_FRSOPT => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:FRSOPT', 1, ZHOOK_HANDLE_PARALLEL)
  
  ! Additional diagnostic of the derivative of the non solar surface; heat flux with respect to surface temperature
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACDRAG')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZNEBS => GET_HOST_DATA_RDWR(YL_ZNEBS)
    ZTRAJGWD => GET_HOST_DATA_RDWR(YL_ZTRAJGWD)
    ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
    ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
    ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
    ZQLIS => GET_HOST_DATA_RDWR(YL_ZQLIS)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
    ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
    ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
    Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDU)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
    Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_GETRL)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%RCORI%FT0)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_OUT_DRNSHF => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DRNSHF)
    Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDV)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL ACDNSHF(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY1, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,  &
      & YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, ZFLU_EMIS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK),  &
      & ZFLU_NEIJ(:, JBLK), ZQV(:, :, JBLK), Z_YDCPG_MISC_QS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK),  &
      & ZCHROV(:, JBLK), ZDQSTS(:, JBLK), Z_YDMF_PHYS_OUT_DRNSHF(:, JBLK))
      CALL ACDRAG(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
      & YDMODEL%YRML_PHY_MF%YRTOPH%NTDRAG, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:, :, JBLK),  &
      & ZNBVNO(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), Z_YDVARS_GEOMETRY_RCORI_T0(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PGETRL(:, JBLK),  &
      & ZGWDCS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI(:, JBLK),  &
      & Z_YDMF_PHYS_OUT_STRDU(:, :, JBLK), Z_YDMF_PHYS_OUT_STRDV(:, :, JBLK), ZTRAJGWD(:, :, JBLK))
      CALL ACPLUIS(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
      & YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:, :, JBLK), ZNEBS(:, :, JBLK), ZQV(:, :, JBLK), ZQLIS(:, :, JBLK),  &
      & ZMSC_QW(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_FCSQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLSL(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_FPLSN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPSN(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_FPFPSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:, :, JBLK))
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACDRAG')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZNEBS => GET_HOST_DATA_RDWR(YL_ZNEBS)
      ZTRAJGWD => GET_HOST_DATA_RDWR(YL_ZTRAJGWD)
      ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
      ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
      ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
      ZQLIS => GET_HOST_DATA_RDWR(YL_ZQLIS)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
      ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
      ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
      Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDU)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
      Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_GETRL)
      Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
      Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
      Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
      Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
      Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%RCORI%FT0)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_OUT_DRNSHF => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DRNSHF)
      Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDV)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZNEBS => NULL()
    ZTRAJGWD => NULL()
    ZCHROV => NULL()
    ZNBVNO => NULL()
    ZDQSTS => NULL()
    ZFLU_NEIJ => NULL()
    ZQLIS => NULL()
    ZQV => NULL()
    ZFLU_EMIS => NULL()
    ZGWDCS => NULL()
    ZMSC_QW => NULL()
    Z_YDMF_PHYS_OUT_STRDU => NULL()
    Z_YDCPG_MISC_QS => NULL()
    Z_YDMF_PHYS_BASE_STATE_U => NULL()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_OUT_FCSQN => NULL()
    Z_YDMF_PHYS_BASE_STATE_V => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => NULL()
    Z_YDMF_PHYS_OUT_FPFPSL => NULL()
    Z_YDMF_PHYS_OUT_FCSQL => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSL => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_OUT_FPFPSN => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSN => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL()
    Z_YDMF_PHYS_OUT_FPLSL => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
    Z_YDVARS_GEOMETRY_RCORI_T0 => NULL()
    Z_YDMF_PHYS_OUT_FPLSN => NULL()
    Z_YDMF_PHYS_OUT_DRNSHF => NULL()
    Z_YDMF_PHYS_OUT_STRDV => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:ACDRAG')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZNEBS => GET_HOST_DATA_RDWR(YL_ZNEBS)
    ZTRAJGWD => GET_HOST_DATA_RDWR(YL_ZTRAJGWD)
    ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
    ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
    ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
    ZQLIS => GET_HOST_DATA_RDWR(YL_ZQLIS)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
    ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
    ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
    Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDU)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
    Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_GETRL)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%RCORI%FT0)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_OUT_DRNSHF => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DRNSHF)
    Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDV)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL ACDNSHF_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY1, YLCPG_BNDS%KIDIA,  &
        & YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, ZFLU_EMIS(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), ZFLU_NEIJ(:, JBLK), ZQV(:, :, JBLK), Z_YDCPG_MISC_QS(:, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), ZCHROV(:, JBLK), ZDQSTS(:, JBLK), Z_YDMF_PHYS_OUT_DRNSHF(:, JBLK),  &
        & YDSTACK=YLSTACK)
        CALL ACDRAG_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & YDMODEL%YRML_PHY_MF%YRTOPH%NTDRAG, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:, :, JBLK),  &
        & ZNBVNO(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), Z_YDVARS_GEOMETRY_RCORI_T0(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PGETRL(:, JBLK),  &
        & ZGWDCS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_STRDU(:, :, JBLK), Z_YDMF_PHYS_OUT_STRDV(:, :, JBLK), ZTRAJGWD(:, :, JBLK), YDSTACK=YLSTACK)
        CALL ACPLUIS_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:, :, JBLK), ZNEBS(:, :, JBLK), ZQV(:, :, JBLK), ZQLIS(:, :, JBLK),  &
        & ZMSC_QW(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FCSQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLSL(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPLSN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPSN(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPFPSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:, :, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACDRAG')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZNEBS => GET_HOST_DATA_RDWR(YL_ZNEBS)
      ZTRAJGWD => GET_HOST_DATA_RDWR(YL_ZTRAJGWD)
      ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
      ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
      ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
      ZQLIS => GET_HOST_DATA_RDWR(YL_ZQLIS)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
      ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
      ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
      Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDU)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
      Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_GETRL)
      Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
      Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
      Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
      Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
      Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%RCORI%FT0)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_OUT_DRNSHF => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DRNSHF)
      Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDV)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZNEBS => NULL()
    ZTRAJGWD => NULL()
    ZCHROV => NULL()
    ZNBVNO => NULL()
    ZDQSTS => NULL()
    ZFLU_NEIJ => NULL()
    ZQLIS => NULL()
    ZQV => NULL()
    ZFLU_EMIS => NULL()
    ZGWDCS => NULL()
    ZMSC_QW => NULL()
    Z_YDMF_PHYS_OUT_STRDU => NULL()
    Z_YDCPG_MISC_QS => NULL()
    Z_YDMF_PHYS_BASE_STATE_U => NULL()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_OUT_FCSQN => NULL()
    Z_YDMF_PHYS_BASE_STATE_V => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => NULL()
    Z_YDMF_PHYS_OUT_FPFPSL => NULL()
    Z_YDMF_PHYS_OUT_FCSQL => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSL => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_OUT_FPFPSN => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSN => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL()
    Z_YDMF_PHYS_OUT_FPLSL => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
    Z_YDVARS_GEOMETRY_RCORI_T0 => NULL()
    Z_YDMF_PHYS_OUT_FPLSN => NULL()
    Z_YDMF_PHYS_OUT_DRNSHF => NULL()
    Z_YDMF_PHYS_OUT_STRDV => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:ACDRAG')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZNEBS => GET_DEVICE_DATA_RDWR(YL_ZNEBS)
    ZTRAJGWD => GET_DEVICE_DATA_RDWR(YL_ZTRAJGWD)
    ZCHROV => GET_DEVICE_DATA_RDWR(YL_ZCHROV)
    ZNBVNO => GET_DEVICE_DATA_RDWR(YL_ZNBVNO)
    ZDQSTS => GET_DEVICE_DATA_RDWR(YL_ZDQSTS)
    ZFLU_NEIJ => GET_DEVICE_DATA_RDWR(YL_ZFLU_NEIJ)
    ZQLIS => GET_DEVICE_DATA_RDWR(YL_ZQLIS)
    ZQV => GET_DEVICE_DATA_RDWR(YL_ZQV)
    ZFLU_EMIS => GET_DEVICE_DATA_RDWR(YL_ZFLU_EMIS)
    ZGWDCS => GET_DEVICE_DATA_RDWR(YL_ZGWDCS)
    ZMSC_QW => GET_DEVICE_DATA_RDWR(YL_ZMSC_QW)
    Z_YDMF_PHYS_OUT_STRDU => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_STRDU)
    Z_YDCPG_MISC_QS => GET_DEVICE_DATA_RDWR(YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_OUT_FCSQN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
    Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_GETRL)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FCSQL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_OUT_FPLSL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDVARS_GEOMETRY_RCORI_T0 => GET_DEVICE_DATA_RDWR(YDVARS%GEOMETRY%RCORI%FT0)
    Z_YDMF_PHYS_OUT_FPLSN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_OUT_DRNSHF => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_DRNSHF)
    Z_YDMF_PHYS_OUT_STRDV => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_STRDV)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZNEBS, ZTRAJGWD, ZCHROV, ZNBVNO, ZDQSTS, ZFLU_NEIJ,  &
!$ACC & ZQLIS, ZQV, ZFLU_EMIS, ZGWDCS, ZMSC_QW, Z_YDMF_PHYS_OUT_STRDU, Z_YDCPG_MISC_QS, Z_YDMF_PHYS_BASE_STATE_U,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_SURF_GSD_VF_PLSM, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_OUT_FCSQN,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN, Z_YDMF_PHYS_SURF_GSD_VF_PGETRL,  &
!$ACC & Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI, Z_YDMF_PHYS_OUT_FPFPSL, Z_YDMF_PHYS_OUT_FCSQL, Z_YDMF_PHYS_OUT_FPEVPSL,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDMF_PHYS_OUT_FPFPSN, Z_YDMF_PHYS_OUT_FPEVPSN,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP, Z_YDMF_PHYS_OUT_FPLSL,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, Z_YDVARS_GEOMETRY_RCORI_T0,  &
!$ACC & Z_YDMF_PHYS_OUT_FPLSN, Z_YDMF_PHYS_OUT_DRNSHF, Z_YDMF_PHYS_OUT_STRDV, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL ACDNSHF_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY1, YLCPG_BNDS%KIDIA,  &
        & YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, ZFLU_EMIS(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), ZFLU_NEIJ(:, JBLK), ZQV(:, :, JBLK), Z_YDCPG_MISC_QS(:, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), ZCHROV(:, JBLK), ZDQSTS(:, JBLK), Z_YDMF_PHYS_OUT_DRNSHF(:, JBLK),  &
        & YDSTACK=YLSTACK)
        CALL ACDRAG_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & YDMODEL%YRML_PHY_MF%YRTOPH%NTDRAG, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:, :, JBLK),  &
        & ZNBVNO(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), Z_YDVARS_GEOMETRY_RCORI_T0(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PGETRL(:, JBLK),  &
        & ZGWDCS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_STRDU(:, :, JBLK), Z_YDMF_PHYS_OUT_STRDV(:, :, JBLK), ZTRAJGWD(:, :, JBLK), YDSTACK=YLSTACK)
        CALL ACPLUIS_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:, :, JBLK), ZNEBS(:, :, JBLK), ZQV(:, :, JBLK), ZQLIS(:, :, JBLK),  &
        & ZMSC_QW(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FCSQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLSL(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPLSN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPSN(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPFPSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:, :, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACDRAG')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZNEBS => GET_HOST_DATA_RDWR(YL_ZNEBS)
      ZTRAJGWD => GET_HOST_DATA_RDWR(YL_ZTRAJGWD)
      ZCHROV => GET_HOST_DATA_RDWR(YL_ZCHROV)
      ZNBVNO => GET_HOST_DATA_RDWR(YL_ZNBVNO)
      ZDQSTS => GET_HOST_DATA_RDWR(YL_ZDQSTS)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR(YL_ZFLU_NEIJ)
      ZQLIS => GET_HOST_DATA_RDWR(YL_ZQLIS)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZFLU_EMIS => GET_HOST_DATA_RDWR(YL_ZFLU_EMIS)
      ZGWDCS => GET_HOST_DATA_RDWR(YL_ZGWDCS)
      ZMSC_QW => GET_HOST_DATA_RDWR(YL_ZMSC_QW)
      Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDU)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
      Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_GETRL)
      Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
      Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
      Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
      Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
      Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%RCORI%FT0)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_OUT_DRNSHF => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DRNSHF)
      Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRDV)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZNEBS => NULL()
    ZTRAJGWD => NULL()
    ZCHROV => NULL()
    ZNBVNO => NULL()
    ZDQSTS => NULL()
    ZFLU_NEIJ => NULL()
    ZQLIS => NULL()
    ZQV => NULL()
    ZFLU_EMIS => NULL()
    ZGWDCS => NULL()
    ZMSC_QW => NULL()
    Z_YDMF_PHYS_OUT_STRDU => NULL()
    Z_YDCPG_MISC_QS => NULL()
    Z_YDMF_PHYS_BASE_STATE_U => NULL()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_OUT_FCSQN => NULL()
    Z_YDMF_PHYS_BASE_STATE_V => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => NULL()
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => NULL()
    Z_YDMF_PHYS_OUT_FPFPSL => NULL()
    Z_YDMF_PHYS_OUT_FCSQL => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSL => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_OUT_FPFPSN => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSN => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL()
    Z_YDMF_PHYS_OUT_FPLSL => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
    Z_YDVARS_GEOMETRY_RCORI_T0 => NULL()
    Z_YDMF_PHYS_OUT_FPLSN => NULL()
    Z_YDMF_PHYS_OUT_DRNSHF => NULL()
    Z_YDMF_PHYS_OUT_STRDV => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRAG', 1, ZHOOK_HANDLE_PARALLEL)
  
  CALL APL_ARPEGE_DEEP_CONVECTION_PARALLEL(YDMF_PHYS_BASE_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDCPG_DYN0,  &
  & YDMF_PHYS_SURF, YDVARS, YDMODEL, YL_ZFPCOR, YL_ZQV, YL_ZTENHA, YL_ZTENQVA, YL_ZTENT)
  
  CALL APL_ARPEGE_PRECIPITATION_PARALLEL(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDMF_PHYS_SURF, YDVARS,  &
  & YDMODEL, YL_ZFLU_NEIJ, YL_ZNEBS, YL_ZNEB_CVPP, YL_ZQC_DET_PCMT, YL_ZQI, YL_ZQL, YL_ZQLIS, YL_ZQLI_CVPP, YL_ZQR, YL_ZQS,  &
  & YL_ZQV, YL_ZSEDIQI, YL_ZSEDIQL, YL_ZTENHA, YL_ZTENQVA, YDGEOMETRY%YRSTA)
  
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:QNGCOR')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZPFL_FPLCH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLCH)
    ZFPLSL => GET_HOST_DATA_RDWR(YL_ZFPLSL)
    ZPFL_FPLSH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLSH)
    ZSEDIQI => GET_HOST_DATA_RDWR(YL_ZSEDIQI)
    ZFLX_LOTT_GWV => GET_HOST_DATA_RDWR(YL_ZFLX_LOTT_GWV)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    ZSEDIQL => GET_HOST_DATA_RDWR(YL_ZSEDIQL)
    ZFPLSN => GET_HOST_DATA_RDWR(YL_ZFPLSN)
    ZQI => GET_HOST_DATA_RDWR(YL_ZQI)
    ZFLX_LOTT_GWU => GET_HOST_DATA_RDWR(YL_ZFLX_LOTT_GWU)
    ZQL => GET_HOST_DATA_RDWR(YL_ZQL)
    ZFPCOR => GET_HOST_DATA_RDWR(YL_ZFPCOR)
    Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQN)
    Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQL(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQN)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSG(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCQNG)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL QNGCOR(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
      & YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, ZQV(:, :, JBLK), ZQL(:, :, JBLK), ZQI(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFCQ(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_DIFCQN(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFCQL(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_DIFTQN(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFTQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPSL(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_FPEVPSN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPCL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPCN(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_FPFPSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPFPCL(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_FPFPCN(:, :, JBLK), Z_YDMF_PHYS_OUT_FCCQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FCCQN(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_FCSQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:, :, JBLK), Z_YDMF_PHYS_OUT_FCQNG(:, :, JBLK))
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:QNGCOR')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZPFL_FPLCH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLCH)
      ZFPLSL => GET_HOST_DATA_RDWR(YL_ZFPLSL)
      ZPFL_FPLSH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLSH)
      ZSEDIQI => GET_HOST_DATA_RDWR(YL_ZSEDIQI)
      ZFLX_LOTT_GWV => GET_HOST_DATA_RDWR(YL_ZFLX_LOTT_GWV)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZSEDIQL => GET_HOST_DATA_RDWR(YL_ZSEDIQL)
      ZFPLSN => GET_HOST_DATA_RDWR(YL_ZFPLSN)
      ZQI => GET_HOST_DATA_RDWR(YL_ZQI)
      ZFLX_LOTT_GWU => GET_HOST_DATA_RDWR(YL_ZFLX_LOTT_GWU)
      ZQL => GET_HOST_DATA_RDWR(YL_ZQL)
      ZFPCOR => GET_HOST_DATA_RDWR(YL_ZFPCOR)
      Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQN)
      Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQL(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCN)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCN)
      Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQN)
      Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCL)
      Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQL)
      Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
      Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQL)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSG(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
      Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
      Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQ)
      Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
      Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
      Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
      Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCL)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
      Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQN)
      Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCQNG)
      Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZPFL_FPLCH => NULL()
    ZFPLSL => NULL()
    ZPFL_FPLSH => NULL()
    ZSEDIQI => NULL()
    ZFLX_LOTT_GWV => NULL()
    ZQV => NULL()
    ZSEDIQL => NULL()
    ZFPLSN => NULL()
    ZQI => NULL()
    ZFLX_LOTT_GWU => NULL()
    ZQL => NULL()
    ZFPCOR => NULL()
    Z_YDMF_PHYS_OUT_DIFCQN => NULL()
    Z_YDMF_PHYS_OUT_DIFTQL => NULL()
    Z_YDMF_PHYS_OUT_FPEVPCN => NULL()
    Z_YDMF_PHYS_OUT_FPLSL => NULL()
    Z_YDMF_PHYS_OUT_FPFPCN => NULL()
    Z_YDMF_PHYS_OUT_DIFTQN => NULL()
    Z_YDMF_PHYS_OUT_FPEVPCL => NULL()
    Z_YDMF_PHYS_OUT_FCCQL => NULL()
    Z_YDMF_PHYS_OUT_FCSQN => NULL()
    Z_YDMF_PHYS_OUT_DIFCQL => NULL()
    Z_YDMF_PHYS_OUT_FPLSN => NULL()
    Z_YDMF_PHYS_OUT_FPLSG => NULL()
    Z_YDMF_PHYS_OUT_FPFPSL => NULL()
    Z_YDMF_PHYS_OUT_FCSQL => NULL()
    Z_YDMF_PHYS_OUT_DIFCQ => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSL => NULL()
    Z_YDMF_PHYS_OUT_FPFPSN => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSN => NULL()
    Z_YDMF_PHYS_OUT_FPFPCL => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL()
    Z_YDMF_PHYS_OUT_FCCQN => NULL()
    Z_YDMF_PHYS_OUT_FCQNG => NULL()
    Z_YDMF_PHYS_OUT_DIFTQ => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:QNGCOR')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZPFL_FPLCH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLCH)
    ZFPLSL => GET_HOST_DATA_RDWR(YL_ZFPLSL)
    ZPFL_FPLSH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLSH)
    ZSEDIQI => GET_HOST_DATA_RDWR(YL_ZSEDIQI)
    ZFLX_LOTT_GWV => GET_HOST_DATA_RDWR(YL_ZFLX_LOTT_GWV)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    ZSEDIQL => GET_HOST_DATA_RDWR(YL_ZSEDIQL)
    ZFPLSN => GET_HOST_DATA_RDWR(YL_ZFPLSN)
    ZQI => GET_HOST_DATA_RDWR(YL_ZQI)
    ZFLX_LOTT_GWU => GET_HOST_DATA_RDWR(YL_ZFLX_LOTT_GWU)
    ZQL => GET_HOST_DATA_RDWR(YL_ZQL)
    ZFPCOR => GET_HOST_DATA_RDWR(YL_ZFPCOR)
    Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQN)
    Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQL(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQN)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSG(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCQNG)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL QNGCOR_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, ZQV(:, :, JBLK), ZQL(:, :, JBLK), ZQI(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFCQ(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_DIFCQN(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFCQL(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_DIFTQN(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFTQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPSL(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPEVPSN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPCL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPCN(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPFPSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPFPCL(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPFPCN(:, :, JBLK), Z_YDMF_PHYS_OUT_FCCQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FCCQN(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FCSQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:, :, JBLK), Z_YDMF_PHYS_OUT_FCQNG(:, :, JBLK),  &
        & YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:QNGCOR')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZPFL_FPLCH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLCH)
      ZFPLSL => GET_HOST_DATA_RDWR(YL_ZFPLSL)
      ZPFL_FPLSH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLSH)
      ZSEDIQI => GET_HOST_DATA_RDWR(YL_ZSEDIQI)
      ZFLX_LOTT_GWV => GET_HOST_DATA_RDWR(YL_ZFLX_LOTT_GWV)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZSEDIQL => GET_HOST_DATA_RDWR(YL_ZSEDIQL)
      ZFPLSN => GET_HOST_DATA_RDWR(YL_ZFPLSN)
      ZQI => GET_HOST_DATA_RDWR(YL_ZQI)
      ZFLX_LOTT_GWU => GET_HOST_DATA_RDWR(YL_ZFLX_LOTT_GWU)
      ZQL => GET_HOST_DATA_RDWR(YL_ZQL)
      ZFPCOR => GET_HOST_DATA_RDWR(YL_ZFPCOR)
      Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQN)
      Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQL(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCN)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCN)
      Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQN)
      Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCL)
      Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQL)
      Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
      Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQL)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSG(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
      Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
      Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQ)
      Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
      Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
      Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
      Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCL)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
      Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQN)
      Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCQNG)
      Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZPFL_FPLCH => NULL()
    ZFPLSL => NULL()
    ZPFL_FPLSH => NULL()
    ZSEDIQI => NULL()
    ZFLX_LOTT_GWV => NULL()
    ZQV => NULL()
    ZSEDIQL => NULL()
    ZFPLSN => NULL()
    ZQI => NULL()
    ZFLX_LOTT_GWU => NULL()
    ZQL => NULL()
    ZFPCOR => NULL()
    Z_YDMF_PHYS_OUT_DIFCQN => NULL()
    Z_YDMF_PHYS_OUT_DIFTQL => NULL()
    Z_YDMF_PHYS_OUT_FPEVPCN => NULL()
    Z_YDMF_PHYS_OUT_FPLSL => NULL()
    Z_YDMF_PHYS_OUT_FPFPCN => NULL()
    Z_YDMF_PHYS_OUT_DIFTQN => NULL()
    Z_YDMF_PHYS_OUT_FPEVPCL => NULL()
    Z_YDMF_PHYS_OUT_FCCQL => NULL()
    Z_YDMF_PHYS_OUT_FCSQN => NULL()
    Z_YDMF_PHYS_OUT_DIFCQL => NULL()
    Z_YDMF_PHYS_OUT_FPLSN => NULL()
    Z_YDMF_PHYS_OUT_FPLSG => NULL()
    Z_YDMF_PHYS_OUT_FPFPSL => NULL()
    Z_YDMF_PHYS_OUT_FCSQL => NULL()
    Z_YDMF_PHYS_OUT_DIFCQ => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSL => NULL()
    Z_YDMF_PHYS_OUT_FPFPSN => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSN => NULL()
    Z_YDMF_PHYS_OUT_FPFPCL => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL()
    Z_YDMF_PHYS_OUT_FCCQN => NULL()
    Z_YDMF_PHYS_OUT_FCQNG => NULL()
    Z_YDMF_PHYS_OUT_DIFTQ => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:QNGCOR')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZPFL_FPLCH => GET_DEVICE_DATA_RDWR(YL_ZPFL_FPLCH)
    ZFPLSL => GET_DEVICE_DATA_RDWR(YL_ZFPLSL)
    ZPFL_FPLSH => GET_DEVICE_DATA_RDWR(YL_ZPFL_FPLSH)
    ZSEDIQI => GET_DEVICE_DATA_RDWR(YL_ZSEDIQI)
    ZFLX_LOTT_GWV => GET_DEVICE_DATA_RDWR(YL_ZFLX_LOTT_GWV)
    ZQV => GET_DEVICE_DATA_RDWR(YL_ZQV)
    ZSEDIQL => GET_DEVICE_DATA_RDWR(YL_ZSEDIQL)
    ZFPLSN => GET_DEVICE_DATA_RDWR(YL_ZFPLSN)
    ZQI => GET_DEVICE_DATA_RDWR(YL_ZQI)
    ZFLX_LOTT_GWU => GET_DEVICE_DATA_RDWR(YL_ZFLX_LOTT_GWU)
    ZQL => GET_DEVICE_DATA_RDWR(YL_ZQL)
    ZFPCOR => GET_DEVICE_DATA_RDWR(YL_ZFPCOR)
    Z_YDMF_PHYS_OUT_DIFCQN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQN)
    Z_YDMF_PHYS_OUT_DIFTQL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQL(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPLSL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPFPCN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_DIFTQN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQN)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FCCQL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_DIFCQL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPLSG => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSG(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPFPSL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FCSQL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_OUT_FCCQN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FCQNG => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FCQNG)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZPFL_FPLCH, ZFPLSL, ZPFL_FPLSH, ZSEDIQI,  &
!$ACC & ZFLX_LOTT_GWV, ZQV, ZSEDIQL, ZFPLSN, ZQI, ZFLX_LOTT_GWU, ZQL, ZFPCOR, Z_YDMF_PHYS_OUT_DIFCQN, Z_YDMF_PHYS_OUT_DIFTQL,  &
!$ACC & Z_YDMF_PHYS_OUT_FPEVPCN, Z_YDMF_PHYS_OUT_FPLSL, Z_YDMF_PHYS_OUT_FPFPCN, Z_YDMF_PHYS_OUT_DIFTQN, Z_YDMF_PHYS_OUT_FPEVPCL,  &
!$ACC & Z_YDMF_PHYS_OUT_FCCQL, Z_YDMF_PHYS_OUT_FCSQN, Z_YDMF_PHYS_OUT_DIFCQL, Z_YDMF_PHYS_OUT_FPLSN, Z_YDMF_PHYS_OUT_FPLSG,  &
!$ACC & Z_YDMF_PHYS_OUT_FPFPSL, Z_YDMF_PHYS_OUT_FCSQL, Z_YDMF_PHYS_OUT_DIFCQ, Z_YDMF_PHYS_OUT_FPEVPSL, Z_YDMF_PHYS_OUT_FPFPSN,  &
!$ACC & Z_YDMF_PHYS_OUT_FPEVPSN, Z_YDMF_PHYS_OUT_FPFPCL, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP, Z_YDMF_PHYS_OUT_FCCQN,  &
!$ACC & Z_YDMF_PHYS_OUT_FCQNG, Z_YDMF_PHYS_OUT_DIFTQ, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL QNGCOR_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, ZQV(:, :, JBLK), ZQL(:, :, JBLK), ZQI(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFCQ(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_DIFCQN(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFCQL(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_DIFTQN(:, :, JBLK), Z_YDMF_PHYS_OUT_DIFTQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPSL(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPEVPSN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPCL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPEVPCN(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPFPSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPFPCL(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPFPCN(:, :, JBLK), Z_YDMF_PHYS_OUT_FCCQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FCCQN(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FCSQL(:, :, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:, :, JBLK), Z_YDMF_PHYS_OUT_FCQNG(:, :, JBLK),  &
        & YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:QNGCOR')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZPFL_FPLCH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLCH)
      ZFPLSL => GET_HOST_DATA_RDWR(YL_ZFPLSL)
      ZPFL_FPLSH => GET_HOST_DATA_RDWR(YL_ZPFL_FPLSH)
      ZSEDIQI => GET_HOST_DATA_RDWR(YL_ZSEDIQI)
      ZFLX_LOTT_GWV => GET_HOST_DATA_RDWR(YL_ZFLX_LOTT_GWV)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZSEDIQL => GET_HOST_DATA_RDWR(YL_ZSEDIQL)
      ZFPLSN => GET_HOST_DATA_RDWR(YL_ZFPLSN)
      ZQI => GET_HOST_DATA_RDWR(YL_ZQI)
      ZFLX_LOTT_GWU => GET_HOST_DATA_RDWR(YL_ZFLX_LOTT_GWU)
      ZQL => GET_HOST_DATA_RDWR(YL_ZQL)
      ZFPCOR => GET_HOST_DATA_RDWR(YL_ZFPCOR)
      Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQN)
      Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQL(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCN)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCN)
      Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQN)
      Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPCL)
      Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQL)
      Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQN)
      Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQL)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSG(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSL)
      Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCSQL)
      Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFCQ)
      Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSL)
      Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPSN)
      Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPEVPSN)
      Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPFPCL)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
      Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCCQN)
      Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FCQNG)
      Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_DIFTQ)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZPFL_FPLCH => NULL()
    ZFPLSL => NULL()
    ZPFL_FPLSH => NULL()
    ZSEDIQI => NULL()
    ZFLX_LOTT_GWV => NULL()
    ZQV => NULL()
    ZSEDIQL => NULL()
    ZFPLSN => NULL()
    ZQI => NULL()
    ZFLX_LOTT_GWU => NULL()
    ZQL => NULL()
    ZFPCOR => NULL()
    Z_YDMF_PHYS_OUT_DIFCQN => NULL()
    Z_YDMF_PHYS_OUT_DIFTQL => NULL()
    Z_YDMF_PHYS_OUT_FPEVPCN => NULL()
    Z_YDMF_PHYS_OUT_FPLSL => NULL()
    Z_YDMF_PHYS_OUT_FPFPCN => NULL()
    Z_YDMF_PHYS_OUT_DIFTQN => NULL()
    Z_YDMF_PHYS_OUT_FPEVPCL => NULL()
    Z_YDMF_PHYS_OUT_FCCQL => NULL()
    Z_YDMF_PHYS_OUT_FCSQN => NULL()
    Z_YDMF_PHYS_OUT_DIFCQL => NULL()
    Z_YDMF_PHYS_OUT_FPLSN => NULL()
    Z_YDMF_PHYS_OUT_FPLSG => NULL()
    Z_YDMF_PHYS_OUT_FPFPSL => NULL()
    Z_YDMF_PHYS_OUT_FCSQL => NULL()
    Z_YDMF_PHYS_OUT_DIFCQ => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSL => NULL()
    Z_YDMF_PHYS_OUT_FPFPSN => NULL()
    Z_YDMF_PHYS_OUT_FPEVPSN => NULL()
    Z_YDMF_PHYS_OUT_FPFPCL => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL()
    Z_YDMF_PHYS_OUT_FCCQN => NULL()
    Z_YDMF_PHYS_OUT_FCQNG => NULL()
    Z_YDMF_PHYS_OUT_DIFTQ => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:QNGCOR', 1, ZHOOK_HANDLE_PARALLEL)
  
  ! Bilan hydrique du sol
  
  CALL APL_ARPEGE_HYDRO_BUDGET_PARALLEL(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_GPAR, YDMF_PHYS, YDMF_PHYS_SURF,  &
  & YDMODEL, YL_ZC3, YL_ZCN, YL_ZDSA_C1, YL_ZDSA_C2, YL_ZFLU_FEVI, YL_ZFLU_NEIJ, YL_ZFLU_VEG, YL_ZFPLSL, YL_ZFPLSN, YL_ZWFC,  &
  & YL_ZWLMX, YL_ZWPMX, YL_ZWSEQ, YL_ZWSMX)
  
  ! Drag mesospherique pour un modele possedant des niveaux au-dessus de 50 km (i.e. dans la mesosphere)
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACDRME')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
    Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR(YDCPG_MISC%F_NEB(JLON, JLEV))
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QLI(JLON, JLEV))
    Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMU)
    Z_YDVARS_IRAD_T1 => GET_HOST_DATA_RDWR(YDVARS%IRAD%FT1(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
    Z_YDVARS_LRAD_T1 => GET_HOST_DATA_RDWR(YDVARS%LRAD%FT1(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QICE(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRMH)
    Z_YDVARS_A_T1 => GET_HOST_DATA_RDWR(YDVARS%A%FT1(JLON, JLEV))
    Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMV)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL ACDRME(YDMODEL%YRCST, YDGEOMETRY%YRSTA, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRML_PHY_MF%YRTOPH, YLCPG_BNDS%KIDIA,  &
      & YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTDRME, YDCPG_OPTS%KFLEVG,  &
      & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), ZQV(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), Z_YDMF_PHYS_OUT_FRMH(:, :, JBLK), ZMSC_FRMQ(:, :, JBLK),  &
      & Z_YDMF_PHYS_OUT_STRMU(:, :, JBLK), Z_YDMF_PHYS_OUT_STRMV(:, :, JBLK))
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACDRME')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
      Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR(YDCPG_MISC%F_NEB(JLON, JLEV))
      Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QLI(JLON, JLEV))
      Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMU)
      Z_YDVARS_IRAD_T1 => GET_HOST_DATA_RDWR(YDVARS%IRAD%FT1(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDVARS_LRAD_T1 => GET_HOST_DATA_RDWR(YDVARS%LRAD%FT1(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QICE(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRMH)
      Z_YDVARS_A_T1 => GET_HOST_DATA_RDWR(YDVARS%A%FT1(JLON, JLEV))
      Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMV)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZQV => NULL()
    ZMSC_FRMQ => NULL()
    Z_YDCPG_MISC_NEB => NULL()
    Z_YDCPG_MISC_QLI => NULL()
    Z_YDMF_PHYS_OUT_STRMU => NULL()
    Z_YDVARS_IRAD_T1 => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_BASE_STATE_V => NULL()
    Z_YDVARS_LRAD_T1 => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL()
    Z_YDCPG_MISC_QICE => NULL()
    Z_YDMF_PHYS_OUT_FRMH => NULL()
    Z_YDVARS_A_T1 => NULL()
    Z_YDMF_PHYS_OUT_STRMV => NULL()
    Z_YDMF_PHYS_BASE_STATE_U => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:ACDRME')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
    ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
    Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR(YDCPG_MISC%F_NEB(JLON, JLEV))
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QLI(JLON, JLEV))
    Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMU)
    Z_YDVARS_IRAD_T1 => GET_HOST_DATA_RDWR(YDVARS%IRAD%FT1(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
    Z_YDVARS_LRAD_T1 => GET_HOST_DATA_RDWR(YDVARS%LRAD%FT1(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QICE(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRMH)
    Z_YDVARS_A_T1 => GET_HOST_DATA_RDWR(YDVARS%A%FT1(JLON, JLEV))
    Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMV)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL ACDRME_OPENACC(YDMODEL%YRCST, YDGEOMETRY%YRSTA, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRML_PHY_MF%YRTOPH,  &
        & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTDRME, YDCPG_OPTS%KFLEVG,  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), ZQV(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), Z_YDMF_PHYS_OUT_FRMH(:, :, JBLK), ZMSC_FRMQ(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_STRMU(:, :, JBLK), Z_YDMF_PHYS_OUT_STRMV(:, :, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACDRME')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
      Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR(YDCPG_MISC%F_NEB(JLON, JLEV))
      Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QLI(JLON, JLEV))
      Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMU)
      Z_YDVARS_IRAD_T1 => GET_HOST_DATA_RDWR(YDVARS%IRAD%FT1(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDVARS_LRAD_T1 => GET_HOST_DATA_RDWR(YDVARS%LRAD%FT1(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QICE(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRMH)
      Z_YDVARS_A_T1 => GET_HOST_DATA_RDWR(YDVARS%A%FT1(JLON, JLEV))
      Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMV)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZQV => NULL()
    ZMSC_FRMQ => NULL()
    Z_YDCPG_MISC_NEB => NULL()
    Z_YDCPG_MISC_QLI => NULL()
    Z_YDMF_PHYS_OUT_STRMU => NULL()
    Z_YDVARS_IRAD_T1 => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_BASE_STATE_V => NULL()
    Z_YDVARS_LRAD_T1 => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL()
    Z_YDCPG_MISC_QICE => NULL()
    Z_YDMF_PHYS_OUT_FRMH => NULL()
    Z_YDVARS_A_T1 => NULL()
    Z_YDMF_PHYS_OUT_STRMV => NULL()
    Z_YDMF_PHYS_BASE_STATE_U => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:ACDRME')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZQV => GET_DEVICE_DATA_RDWR(YL_ZQV)
    ZMSC_FRMQ => GET_DEVICE_DATA_RDWR(YL_ZMSC_FRMQ)
    Z_YDCPG_MISC_NEB => GET_DEVICE_DATA_RDWR(YDCPG_MISC%F_NEB(JLON, JLEV))
    Z_YDCPG_MISC_QLI => GET_DEVICE_DATA_RDWR(YDCPG_MISC%F_QLI(JLON, JLEV))
    Z_YDMF_PHYS_OUT_STRMU => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_STRMU)
    Z_YDVARS_IRAD_T1 => GET_DEVICE_DATA_RDWR(YDVARS%IRAD%FT1(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
    Z_YDVARS_LRAD_T1 => GET_DEVICE_DATA_RDWR(YDVARS%LRAD%FT1(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDCPG_MISC_QICE => GET_DEVICE_DATA_RDWR(YDCPG_MISC%F_QICE(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FRMH => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FRMH)
    Z_YDVARS_A_T1 => GET_DEVICE_DATA_RDWR(YDVARS%A%FT1(JLON, JLEV))
    Z_YDMF_PHYS_OUT_STRMV => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_STRMV)
    Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZQV, ZMSC_FRMQ, Z_YDCPG_MISC_NEB, Z_YDCPG_MISC_QLI,  &
!$ACC & Z_YDMF_PHYS_OUT_STRMU, Z_YDVARS_IRAD_T1, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_V, Z_YDVARS_LRAD_T1,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP, Z_YDCPG_MISC_QICE,  &
!$ACC & Z_YDMF_PHYS_OUT_FRMH, Z_YDVARS_A_T1, Z_YDMF_PHYS_OUT_STRMV, Z_YDMF_PHYS_BASE_STATE_U, ) PRIVATE( JBLK ) VECTOR_LENGTH(  &
!$ACC & YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL ACDRME_OPENACC(YDMODEL%YRCST, YDGEOMETRY%YRSTA, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRML_PHY_MF%YRTOPH,  &
        & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTDRME, YDCPG_OPTS%KFLEVG,  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), ZQV(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), Z_YDMF_PHYS_OUT_FRMH(:, :, JBLK), ZMSC_FRMQ(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_STRMU(:, :, JBLK), Z_YDMF_PHYS_OUT_STRMV(:, :, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACDRME')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZQV => GET_HOST_DATA_RDWR(YL_ZQV)
      ZMSC_FRMQ => GET_HOST_DATA_RDWR(YL_ZMSC_FRMQ)
      Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR(YDCPG_MISC%F_NEB(JLON, JLEV))
      Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QLI(JLON, JLEV))
      Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMU)
      Z_YDVARS_IRAD_T1 => GET_HOST_DATA_RDWR(YDVARS%IRAD%FT1(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDVARS_LRAD_T1 => GET_HOST_DATA_RDWR(YDVARS%LRAD%FT1(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QICE(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FRMH)
      Z_YDVARS_A_T1 => GET_HOST_DATA_RDWR(YDVARS%A%FT1(JLON, JLEV))
      Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_STRMV)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZQV => NULL()
    ZMSC_FRMQ => NULL()
    Z_YDCPG_MISC_NEB => NULL()
    Z_YDCPG_MISC_QLI => NULL()
    Z_YDMF_PHYS_OUT_STRMU => NULL()
    Z_YDVARS_IRAD_T1 => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_BASE_STATE_V => NULL()
    Z_YDVARS_LRAD_T1 => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL()
    Z_YDCPG_MISC_QICE => NULL()
    Z_YDMF_PHYS_OUT_FRMH => NULL()
    Z_YDVARS_A_T1 => NULL()
    Z_YDMF_PHYS_OUT_STRMV => NULL()
    Z_YDMF_PHYS_BASE_STATE_U => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACDRME', 1, ZHOOK_HANDLE_PARALLEL)
  
!$loki SKIP
  
  ! DDH flexibles pour les champs de surface variables/flux/tendances.
  
  IF (YDMODEL%YRML_DIAG%YRLDDH%LFLEXDIA) THEN
    CALL APLPAR_FLEXDIA_PARALLEL(YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL, YDDDH,  &
    & YDMF_PHYS_BASE_STATE)
  END IF
  
!$loki end parallel
  
  IF (YDMODEL%YRML_PHY_MF%YRPHY2%LRAFTKE) THEN
    
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE', 0, ZHOOK_HANDLE_PARALLEL)
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACEVADCAPE')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZBLH => GET_HOST_DATA_RDWR(YL_ZBLH)
      IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
      ZTKE1 => GET_HOST_DATA_RDWR(YL_ZTKE1)
      ZDCAPE => GET_HOST_DATA_RDWR(YL_ZDCAPE)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
      Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CAPE)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%OROG%FT0)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH(JLON))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL ACEVADCAPE(YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_OUT_FPLSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPLCL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), ZDCAPE(:, JBLK))
        CALL ACCLDIA(YDMODEL%YRCST, YDCPG_OPTS%LXCLP, YDCPG_OPTS%LXTGST, YDCPG_OPTS%LXXGST, YDMODEL%YRML_PHY_MF%YRPHY,  &
        & YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRML_PHY_MF%YRTOPH, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_OUT_UCLS(:, JBLK), Z_YDMF_PHYS_OUT_VCLS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), Z_YDMF_PHYS_OUT_CAPE(:, JBLK), ZDCAPE(:, JBLK), ZTKE1(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDVARS_GEOMETRY_OROG_T0(:, JBLK), Z_YDMF_PHYS_OUT_UGST(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_VGST(:, JBLK), ZBLH(:, JBLK), IMOC_CLPH(:, JBLK))
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACEVADCAPE')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZBLH => GET_HOST_DATA_RDWR(YL_ZBLH)
        IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
        ZTKE1 => GET_HOST_DATA_RDWR(YL_ZTKE1)
        ZDCAPE => GET_HOST_DATA_RDWR(YL_ZDCAPE)
        Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
        Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
        Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
        Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
        Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CAPE)
        Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
        Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%OROG%FT0)
        Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH(JLON))
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZBLH => NULL()
      IMOC_CLPH => NULL()
      ZTKE1 => NULL()
      ZDCAPE => NULL()
      Z_YDMF_PHYS_OUT_FPLCL => NULL()
      Z_YDMF_PHYS_OUT_VCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_OUT_FPLCN => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
      Z_YDMF_PHYS_OUT_UGST => NULL()
      Z_YDMF_PHYS_OUT_VGST => NULL()
      Z_YDMF_PHYS_OUT_CAPE => NULL()
      Z_YDMF_PHYS_OUT_UCLS => NULL()
      Z_YDMF_PHYS_OUT_FPLSL => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDVARS_GEOMETRY_OROG_T0 => NULL()
      Z_YDMF_PHYS_OUT_FPLSN => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_OUT_CLPH => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:ACEVADCAPE')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZBLH => GET_HOST_DATA_RDWR(YL_ZBLH)
      IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
      ZTKE1 => GET_HOST_DATA_RDWR(YL_ZTKE1)
      ZDCAPE => GET_HOST_DATA_RDWR(YL_ZDCAPE)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
      Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CAPE)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%OROG%FT0)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH(JLON))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL ACEVADCAPE_OPENACC(YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,  &
          & YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_OUT_FPLSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:, :, JBLK),  &
          & Z_YDMF_PHYS_OUT_FPLCL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), ZDCAPE(:, JBLK),  &
          & YDSTACK=YLSTACK)
          CALL ACCLDIA_OPENACC(YDMODEL%YRCST, YDCPG_OPTS%LXCLP, YDCPG_OPTS%LXTGST, YDCPG_OPTS%LXXGST, YDMODEL%YRML_PHY_MF%YRPHY,  &
          & YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRML_PHY_MF%YRTOPH, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
          & YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_OUT_UCLS(:, JBLK), Z_YDMF_PHYS_OUT_VCLS(:, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), Z_YDMF_PHYS_OUT_CAPE(:, JBLK),  &
          & ZDCAPE(:, JBLK), ZTKE1(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
          & Z_YDVARS_GEOMETRY_OROG_T0(:, JBLK), Z_YDMF_PHYS_OUT_UGST(:, JBLK), Z_YDMF_PHYS_OUT_VGST(:, JBLK), ZBLH(:, JBLK),  &
          & IMOC_CLPH(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACEVADCAPE')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZBLH => GET_HOST_DATA_RDWR(YL_ZBLH)
        IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
        ZTKE1 => GET_HOST_DATA_RDWR(YL_ZTKE1)
        ZDCAPE => GET_HOST_DATA_RDWR(YL_ZDCAPE)
        Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
        Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
        Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
        Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
        Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CAPE)
        Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
        Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%OROG%FT0)
        Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH(JLON))
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZBLH => NULL()
      IMOC_CLPH => NULL()
      ZTKE1 => NULL()
      ZDCAPE => NULL()
      Z_YDMF_PHYS_OUT_FPLCL => NULL()
      Z_YDMF_PHYS_OUT_VCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_OUT_FPLCN => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
      Z_YDMF_PHYS_OUT_UGST => NULL()
      Z_YDMF_PHYS_OUT_VGST => NULL()
      Z_YDMF_PHYS_OUT_CAPE => NULL()
      Z_YDMF_PHYS_OUT_UCLS => NULL()
      Z_YDMF_PHYS_OUT_FPLSL => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDVARS_GEOMETRY_OROG_T0 => NULL()
      Z_YDMF_PHYS_OUT_FPLSN => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_OUT_CLPH => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:ACEVADCAPE')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZBLH => GET_DEVICE_DATA_RDWR(YL_ZBLH)
      IMOC_CLPH => GET_DEVICE_DATA_RDWR(YL_IMOC_CLPH)
      ZTKE1 => GET_DEVICE_DATA_RDWR(YL_ZTKE1)
      ZDCAPE => GET_DEVICE_DATA_RDWR(YL_ZDCAPE)
      Z_YDMF_PHYS_OUT_FPLCL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_VCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_OUT_FPLCN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_OUT_UGST => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VGST => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
      Z_YDMF_PHYS_OUT_CAPE => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_CAPE)
      Z_YDMF_PHYS_OUT_UCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_FPLSL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDVARS_GEOMETRY_OROG_T0 => GET_DEVICE_DATA_RDWR(YDVARS%GEOMETRY%OROG%FT0)
      Z_YDMF_PHYS_OUT_FPLSN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_OUT_CLPH => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH(JLON))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZBLH, IMOC_CLPH, ZTKE1, ZDCAPE,  &
!$ACC & Z_YDMF_PHYS_OUT_FPLCL, Z_YDMF_PHYS_OUT_VCLS, Z_YDMF_PHYS_BASE_STATE_U, Z_YDMF_PHYS_BASE_STATE_T,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_OUT_FPLCN,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP, Z_YDMF_PHYS_OUT_UGST, Z_YDMF_PHYS_OUT_VGST, Z_YDMF_PHYS_OUT_CAPE,  &
!$ACC & Z_YDMF_PHYS_OUT_UCLS, Z_YDMF_PHYS_OUT_FPLSL, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDVARS_GEOMETRY_OROG_T0, Z_YDMF_PHYS_OUT_FPLSN,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDMF_PHYS_OUT_CLPH, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL ACEVADCAPE_OPENACC(YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,  &
          & YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_OUT_FPLSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:, :, JBLK),  &
          & Z_YDMF_PHYS_OUT_FPLCL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK), ZDCAPE(:, JBLK),  &
          & YDSTACK=YLSTACK)
          CALL ACCLDIA_OPENACC(YDMODEL%YRCST, YDCPG_OPTS%LXCLP, YDCPG_OPTS%LXTGST, YDCPG_OPTS%LXXGST, YDMODEL%YRML_PHY_MF%YRPHY,  &
          & YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRML_PHY_MF%YRTOPH, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
          & YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_OUT_UCLS(:, JBLK), Z_YDMF_PHYS_OUT_VCLS(:, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), Z_YDMF_PHYS_OUT_CAPE(:, JBLK),  &
          & ZDCAPE(:, JBLK), ZTKE1(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK),  &
          & Z_YDVARS_GEOMETRY_OROG_T0(:, JBLK), Z_YDMF_PHYS_OUT_UGST(:, JBLK), Z_YDMF_PHYS_OUT_VGST(:, JBLK), ZBLH(:, JBLK),  &
          & IMOC_CLPH(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:ACEVADCAPE')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZBLH => GET_HOST_DATA_RDWR(YL_ZBLH)
        IMOC_CLPH => GET_HOST_DATA_RDWR(YL_IMOC_CLPH)
        ZTKE1 => GET_HOST_DATA_RDWR(YL_ZTKE1)
        ZDCAPE => GET_HOST_DATA_RDWR(YL_ZDCAPE)
        Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
        Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
        Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
        Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
        Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CAPE)
        Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
        Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR(YDVARS%GEOMETRY%OROG%FT0)
        Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_CLPH(JLON))
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZBLH => NULL()
      IMOC_CLPH => NULL()
      ZTKE1 => NULL()
      ZDCAPE => NULL()
      Z_YDMF_PHYS_OUT_FPLCL => NULL()
      Z_YDMF_PHYS_OUT_VCLS => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_OUT_FPLCN => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL()
      Z_YDMF_PHYS_OUT_UGST => NULL()
      Z_YDMF_PHYS_OUT_VGST => NULL()
      Z_YDMF_PHYS_OUT_CAPE => NULL()
      Z_YDMF_PHYS_OUT_UCLS => NULL()
      Z_YDMF_PHYS_OUT_FPLSL => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDVARS_GEOMETRY_OROG_T0 => NULL()
      Z_YDMF_PHYS_OUT_FPLSN => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_OUT_CLPH => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACEVADCAPE', 1, ZHOOK_HANDLE_PARALLEL)
    
  END IF
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ACVISIH')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZQGM => GET_HOST_DATA_RDWR(YL_ZQGM)
    ZQR => GET_HOST_DATA_RDWR(YL_ZQR)
    ZQS => GET_HOST_DATA_RDWR(YL_ZQS)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_OUT_VISIHYD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISIHYD)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QICE)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_OUT_VISICLD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISICLD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_OUT_MXCLWC => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_MXCLWC)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL ACVISIH(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY%YRDVISI, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
      & YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK), Z_YDCPG_MISC_QLI(:, :, JBLK),  &
      & Z_YDCPG_MISC_QICE(:, :, JBLK), ZQR(:, :, JBLK), ZQS(:, :, JBLK), ZQGM(:, :, JBLK), Z_YDMF_PHYS_OUT_VISICLD(:, JBLK),  &
      & Z_YDMF_PHYS_OUT_VISIHYD(:, JBLK), Z_YDMF_PHYS_OUT_MXCLWC(:, JBLK))
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACVISIH')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZQGM => GET_HOST_DATA_RDWR(YL_ZQGM)
      ZQR => GET_HOST_DATA_RDWR(YL_ZQR)
      ZQS => GET_HOST_DATA_RDWR(YL_ZQS)
      Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QLI)
      Z_YDMF_PHYS_OUT_VISIHYD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISIHYD)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QICE)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_OUT_VISICLD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISICLD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_OUT_MXCLWC => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_MXCLWC)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZQGM => NULL()
    ZQR => NULL()
    ZQS => NULL()
    Z_YDCPG_MISC_QLI => NULL()
    Z_YDMF_PHYS_OUT_VISIHYD => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
    Z_YDCPG_MISC_QICE => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
    Z_YDMF_PHYS_OUT_VISICLD => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
    Z_YDMF_PHYS_OUT_MXCLWC => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:ACVISIH')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZQGM => GET_HOST_DATA_RDWR(YL_ZQGM)
    ZQR => GET_HOST_DATA_RDWR(YL_ZQR)
    ZQS => GET_HOST_DATA_RDWR(YL_ZQS)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_OUT_VISIHYD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISIHYD)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QICE)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_OUT_VISICLD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISICLD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_OUT_MXCLWC => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_MXCLWC)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL ACVISIH_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY%YRDVISI, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,  &
        & YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK), Z_YDCPG_MISC_QLI(:, :, JBLK),  &
        & Z_YDCPG_MISC_QICE(:, :, JBLK), ZQR(:, :, JBLK), ZQS(:, :, JBLK), ZQGM(:, :, JBLK), Z_YDMF_PHYS_OUT_VISICLD(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_VISIHYD(:, JBLK), Z_YDMF_PHYS_OUT_MXCLWC(:, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACVISIH')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZQGM => GET_HOST_DATA_RDWR(YL_ZQGM)
      ZQR => GET_HOST_DATA_RDWR(YL_ZQR)
      ZQS => GET_HOST_DATA_RDWR(YL_ZQS)
      Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QLI)
      Z_YDMF_PHYS_OUT_VISIHYD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISIHYD)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QICE)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_OUT_VISICLD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISICLD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_OUT_MXCLWC => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_MXCLWC)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZQGM => NULL()
    ZQR => NULL()
    ZQS => NULL()
    Z_YDCPG_MISC_QLI => NULL()
    Z_YDMF_PHYS_OUT_VISIHYD => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
    Z_YDCPG_MISC_QICE => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
    Z_YDMF_PHYS_OUT_VISICLD => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
    Z_YDMF_PHYS_OUT_MXCLWC => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:ACVISIH')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZQGM => GET_DEVICE_DATA_RDWR(YL_ZQGM)
    ZQR => GET_DEVICE_DATA_RDWR(YL_ZQR)
    ZQS => GET_DEVICE_DATA_RDWR(YL_ZQS)
    Z_YDCPG_MISC_QLI => GET_DEVICE_DATA_RDWR(YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_OUT_VISIHYD => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_VISIHYD)
    Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDCPG_MISC_QICE => GET_DEVICE_DATA_RDWR(YDCPG_MISC%F_QICE)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_OUT_VISICLD => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_VISICLD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_OUT_MXCLWC => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_MXCLWC)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZQGM, ZQR, ZQS, Z_YDCPG_MISC_QLI,  &
!$ACC & Z_YDMF_PHYS_OUT_VISIHYD, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, Z_YDCPG_MISC_QICE,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R, Z_YDMF_PHYS_OUT_VISICLD,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDMF_PHYS_OUT_MXCLWC, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL ACVISIH_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY%YRDVISI, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,  &
        & YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:, :, JBLK), Z_YDCPG_MISC_QLI(:, :, JBLK),  &
        & Z_YDCPG_MISC_QICE(:, :, JBLK), ZQR(:, :, JBLK), ZQS(:, :, JBLK), ZQGM(:, :, JBLK), Z_YDMF_PHYS_OUT_VISICLD(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_VISIHYD(:, JBLK), Z_YDMF_PHYS_OUT_MXCLWC(:, JBLK), YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ACVISIH')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZQGM => GET_HOST_DATA_RDWR(YL_ZQGM)
      ZQR => GET_HOST_DATA_RDWR(YL_ZQR)
      ZQS => GET_HOST_DATA_RDWR(YL_ZQS)
      Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QLI)
      Z_YDMF_PHYS_OUT_VISIHYD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISIHYD)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QICE)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_OUT_VISICLD => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VISICLD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_OUT_MXCLWC => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_MXCLWC)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZQGM => NULL()
    ZQR => NULL()
    ZQS => NULL()
    Z_YDCPG_MISC_QLI => NULL()
    Z_YDMF_PHYS_OUT_VISIHYD => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
    Z_YDCPG_MISC_QICE => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL()
    Z_YDMF_PHYS_OUT_VISICLD => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
    Z_YDMF_PHYS_OUT_MXCLWC => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ACVISIH', 1, ZHOOK_HANDLE_PARALLEL)
  
  ! Convert from flux [kg/m2/s] to density [kg/m3] using old RTTOV-SCATT
  !  a    b         ! RR = a * LWC^b, [RR]=mm/h, [LWC]=g/m^3
  ! 20.89 1.15      ! rain
  ! 29.51 1.10      ! snow
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ZBAY_QRCONV')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN(JLON, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ZBAY_QRCONV')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
      ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN(JLON, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => NULL()
    ZBAY_QSCONV => NULL()
    Z_YDMF_PHYS_OUT_FPLCL => NULL()
    Z_YDMF_PHYS_OUT_FPLCN => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:ZBAY_QRCONV')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN(JLON, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ZBAY_QRCONV')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
      ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN(JLON, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => NULL()
    ZBAY_QSCONV => NULL()
    Z_YDMF_PHYS_OUT_FPLCL => NULL()
    Z_YDMF_PHYS_OUT_FPLCN => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:ZBAY_QRCONV')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_DEVICE_DATA_RDWR(YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_DEVICE_DATA_RDWR(YL_ZBAY_QSCONV)
    Z_YDMF_PHYS_OUT_FPLCL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL(JLON, JLEV))
    Z_YDMF_PHYS_OUT_FPLCN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN(JLON, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZBAY_QRCONV, ZBAY_QSCONV, Z_YDMF_PHYS_OUT_FPLCL,  &
!$ACC & Z_YDMF_PHYS_OUT_FPLCN, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ZBAY_QRCONV')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
      ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL(JLON, JLEV))
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN(JLON, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => NULL()
    ZBAY_QSCONV => NULL()
    Z_YDMF_PHYS_OUT_FPLCL => NULL()
    Z_YDMF_PHYS_OUT_FPLCN => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZBAY_QRCONV', 1, ZHOOK_HANDLE_PARALLEL)
  
  ! Convert density [kg/m3] to mixing ratio [kg/kg]
  ! R_dry (dry air constant)
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:ZDE2MR')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
    ZDE2MR => GET_HOST_DATA_RDWR(YL_ZDE2MR)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ZDE2MR')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
      ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
      ZDE2MR => GET_HOST_DATA_RDWR(YL_ZDE2MR)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => NULL()
    ZBAY_QSCONV => NULL()
    ZDE2MR => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:ZDE2MR')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
    ZDE2MR => GET_HOST_DATA_RDWR(YL_ZDE2MR)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ZDE2MR')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
      ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
      ZDE2MR => GET_HOST_DATA_RDWR(YL_ZDE2MR)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => NULL()
    ZBAY_QSCONV => NULL()
    ZDE2MR => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:ZDE2MR')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_DEVICE_DATA_RDWR(YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_DEVICE_DATA_RDWR(YL_ZBAY_QSCONV)
    ZDE2MR => GET_DEVICE_DATA_RDWR(YL_ZDE2MR)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF(JLON, JLEV))
    Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZBAY_QRCONV, ZBAY_QSCONV, ZDE2MR,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDMF_PHYS_BASE_STATE_T, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:ZDE2MR')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
      ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
      ZDE2MR => GET_HOST_DATA_RDWR(YL_ZDE2MR)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF(JLON, JLEV))
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T(JLON, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => NULL()
    ZBAY_QSCONV => NULL()
    ZDE2MR => NULL()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
    Z_YDMF_PHYS_BASE_STATE_T => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:ZDE2MR', 1, ZHOOK_HANDLE_PARALLEL)
  
  ! Precipitation Type
  
  ! Compute wet-bulb temperature at 2 meters (suppose homogeneity of qv/ql/qi )
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:PPWETPOINT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
    Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_L(:, YDCPG_OPTS%KFLEVG))
    Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
    Z_YDMF_PHYS_OUT_TPWCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TPWCLS)
    Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_I(:, YDCPG_OPTS%KFLEVG))
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q(:, YDCPG_OPTS%KFLEVG))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL PPWETPOINT(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
      & ZPCLS(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(:, :, JBLK),  &
      & Z_YDMF_PHYS_BASE_STATE_L(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_I(:, :, JBLK), Z_YDMF_PHYS_OUT_TPWCLS(:, JBLK))
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:PPWETPOINT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
      Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_L(:, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_OUT_TPWCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TPWCLS)
      Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_I(:, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q(:, YDCPG_OPTS%KFLEVG))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZPCLS => NULL()
    Z_YDMF_PHYS_BASE_STATE_L => NULL()
    Z_YDMF_PHYS_OUT_TCLS => NULL()
    Z_YDMF_PHYS_OUT_TPWCLS => NULL()
    Z_YDMF_PHYS_BASE_STATE_I => NULL()
    Z_YDMF_PHYS_BASE_STATE_Q => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:PPWETPOINT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
    Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_L(:, YDCPG_OPTS%KFLEVG))
    Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
    Z_YDMF_PHYS_OUT_TPWCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TPWCLS)
    Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_I(:, YDCPG_OPTS%KFLEVG))
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q(:, YDCPG_OPTS%KFLEVG))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL PPWETPOINT_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & ZPCLS(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_L(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_I(:, :, JBLK), Z_YDMF_PHYS_OUT_TPWCLS(:, JBLK),  &
        & YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:PPWETPOINT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
      Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_L(:, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_OUT_TPWCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TPWCLS)
      Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_I(:, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q(:, YDCPG_OPTS%KFLEVG))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZPCLS => NULL()
    Z_YDMF_PHYS_BASE_STATE_L => NULL()
    Z_YDMF_PHYS_OUT_TCLS => NULL()
    Z_YDMF_PHYS_OUT_TPWCLS => NULL()
    Z_YDMF_PHYS_BASE_STATE_I => NULL()
    Z_YDMF_PHYS_BASE_STATE_Q => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:PPWETPOINT')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZPCLS => GET_DEVICE_DATA_RDWR(YL_ZPCLS)
    Z_YDMF_PHYS_BASE_STATE_L => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_L(:, YDCPG_OPTS%KFLEVG))
    Z_YDMF_PHYS_OUT_TCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
    Z_YDMF_PHYS_OUT_TPWCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_TPWCLS)
    Z_YDMF_PHYS_BASE_STATE_I => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_I(:, YDCPG_OPTS%KFLEVG))
    Z_YDMF_PHYS_BASE_STATE_Q => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q(:, YDCPG_OPTS%KFLEVG))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZPCLS, Z_YDMF_PHYS_BASE_STATE_L,  &
!$ACC & Z_YDMF_PHYS_OUT_TCLS, Z_YDMF_PHYS_OUT_TPWCLS, Z_YDMF_PHYS_BASE_STATE_I, Z_YDMF_PHYS_BASE_STATE_Q, ) PRIVATE( JBLK )  &
!$ACC & VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL PPWETPOINT_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & ZPCLS(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_L(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_I(:, :, JBLK), Z_YDMF_PHYS_OUT_TPWCLS(:, JBLK),  &
        & YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:PPWETPOINT')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZPCLS => GET_HOST_DATA_RDWR(YL_ZPCLS)
      Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_L(:, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_OUT_TPWCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TPWCLS)
      Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_I(:, YDCPG_OPTS%KFLEVG))
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q(:, YDCPG_OPTS%KFLEVG))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZPCLS => NULL()
    Z_YDMF_PHYS_BASE_STATE_L => NULL()
    Z_YDMF_PHYS_OUT_TCLS => NULL()
    Z_YDMF_PHYS_OUT_TPWCLS => NULL()
    Z_YDMF_PHYS_BASE_STATE_I => NULL()
    Z_YDMF_PHYS_BASE_STATE_Q => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PPWETPOINT', 1, ZHOOK_HANDLE_PARALLEL)
  
  CALL APL_ARPEGE_DPRECIPS_PARALLEL(YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDVARS, YDMODEL, YL_ZPRC_DPRECIPS,  &
  & YL_ZPRC_DPRECIPS2)
  
  CALL MF_PHYS_MOCON_PARALLEL(YDCPG_BNDS, YDCPG_OPTS, YL_ZRDG_LCVQ, YL_IMOC_CLPH, YDMF_PHYS, YDMF_PHYS_BASE_STATE)
  
  ! Store surface water flux P and E for water conservation
  IF (YDCPG_OPTS%LCORWAT) THEN
    
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0', 0, ZHOOK_HANDLE_PARALLEL)
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:0')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_VH_PPCN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCN)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVL)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_SURF_GSD_VH_PPSL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSL)
      Z_YDMF_PHYS_SURF_GSD_VH_PPSN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSN)
      Z_YDMF_PHYS_SURF_GSD_VH_PEVA => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_EVA)
      Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVN)
      Z_YDMF_PHYS_SURF_GSD_VH_PPCL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCL)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL MF_PHYS_CORWAT(YLCPG_BNDS, YDCPG_OPTS, Z_YDMF_PHYS_OUT_FEVL(:, :, JBLK), Z_YDMF_PHYS_OUT_FEVN(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPLCL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLSL(:, :, JBLK),  &
        & Z_YDMF_PHYS_OUT_FPLSN(:, :, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PEVA(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PPCL(:, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_VH_PPCN(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PPSL(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PPSN(:, JBLK))
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:0')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDMF_PHYS_SURF_GSD_VH_PPCN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCN)
        Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
        Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
        Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
        Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVL)
        Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
        Z_YDMF_PHYS_SURF_GSD_VH_PPSL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSL)
        Z_YDMF_PHYS_SURF_GSD_VH_PPSN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSN)
        Z_YDMF_PHYS_SURF_GSD_VH_PEVA => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_EVA)
        Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVN)
        Z_YDMF_PHYS_SURF_GSD_VH_PPCL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCL)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_VH_PPCN => NULL()
      Z_YDMF_PHYS_OUT_FPLCL => NULL()
      Z_YDMF_PHYS_OUT_FPLCN => NULL()
      Z_YDMF_PHYS_OUT_FPLSL => NULL()
      Z_YDMF_PHYS_OUT_FEVL => NULL()
      Z_YDMF_PHYS_OUT_FPLSN => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PPSL => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PPSN => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PEVA => NULL()
      Z_YDMF_PHYS_OUT_FEVN => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PPCL => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:0')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_VH_PPCN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCN)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVL)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_SURF_GSD_VH_PPSL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSL)
      Z_YDMF_PHYS_SURF_GSD_VH_PPSN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSN)
      Z_YDMF_PHYS_SURF_GSD_VH_PEVA => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_EVA)
      Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVN)
      Z_YDMF_PHYS_SURF_GSD_VH_PPCL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCL)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL MF_PHYS_CORWAT_OPENACC(YLCPG_BNDS, YDCPG_OPTS, Z_YDMF_PHYS_OUT_FEVL(:, :, JBLK),  &
          & Z_YDMF_PHYS_OUT_FEVN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLCL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:, :, JBLK),  &
          & Z_YDMF_PHYS_OUT_FPLSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:, :, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PEVA(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VH_PPCL(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PPCN(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PPSL(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VH_PPSN(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:0')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDMF_PHYS_SURF_GSD_VH_PPCN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCN)
        Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
        Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
        Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
        Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVL)
        Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
        Z_YDMF_PHYS_SURF_GSD_VH_PPSL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSL)
        Z_YDMF_PHYS_SURF_GSD_VH_PPSN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSN)
        Z_YDMF_PHYS_SURF_GSD_VH_PEVA => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_EVA)
        Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVN)
        Z_YDMF_PHYS_SURF_GSD_VH_PPCL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCL)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_VH_PPCN => NULL()
      Z_YDMF_PHYS_OUT_FPLCL => NULL()
      Z_YDMF_PHYS_OUT_FPLCN => NULL()
      Z_YDMF_PHYS_OUT_FPLSL => NULL()
      Z_YDMF_PHYS_OUT_FEVL => NULL()
      Z_YDMF_PHYS_OUT_FPLSN => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PPSL => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PPSN => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PEVA => NULL()
      Z_YDMF_PHYS_OUT_FEVN => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PPCL => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:0')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_VH_PPCN => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCN)
      Z_YDMF_PHYS_OUT_FPLCL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_FPLCN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
      Z_YDMF_PHYS_OUT_FPLSL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_OUT_FEVL => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FEVL)
      Z_YDMF_PHYS_OUT_FPLSN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_SURF_GSD_VH_PPSL => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSL)
      Z_YDMF_PHYS_SURF_GSD_VH_PPSN => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSN)
      Z_YDMF_PHYS_SURF_GSD_VH_PEVA => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_EVA)
      Z_YDMF_PHYS_OUT_FEVN => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_FEVN)
      Z_YDMF_PHYS_SURF_GSD_VH_PPCL => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCL)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, Z_YDMF_PHYS_SURF_GSD_VH_PPCN, Z_YDMF_PHYS_OUT_FPLCL,  &
!$ACC & Z_YDMF_PHYS_OUT_FPLCN, Z_YDMF_PHYS_OUT_FPLSL, Z_YDMF_PHYS_OUT_FEVL, Z_YDMF_PHYS_OUT_FPLSN, Z_YDMF_PHYS_SURF_GSD_VH_PPSL,  &
!$ACC & Z_YDMF_PHYS_SURF_GSD_VH_PPSN, Z_YDMF_PHYS_SURF_GSD_VH_PEVA, Z_YDMF_PHYS_OUT_FEVN, Z_YDMF_PHYS_SURF_GSD_VH_PPCL, )  &
!$ACC & PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL MF_PHYS_CORWAT_OPENACC(YLCPG_BNDS, YDCPG_OPTS, Z_YDMF_PHYS_OUT_FEVL(:, :, JBLK),  &
          & Z_YDMF_PHYS_OUT_FEVN(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLCL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:, :, JBLK),  &
          & Z_YDMF_PHYS_OUT_FPLSL(:, :, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:, :, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PEVA(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VH_PPCL(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PPCN(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PPSL(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VH_PPSN(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:0')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDMF_PHYS_SURF_GSD_VH_PPCN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCN)
        Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCL)
        Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLCN)
        Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSL)
        Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVL)
        Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FPLSN)
        Z_YDMF_PHYS_SURF_GSD_VH_PPSL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSL)
        Z_YDMF_PHYS_SURF_GSD_VH_PPSN => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PSN)
        Z_YDMF_PHYS_SURF_GSD_VH_PEVA => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_EVA)
        Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_FEVN)
        Z_YDMF_PHYS_SURF_GSD_VH_PPCL => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VH%F_PCL)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_VH_PPCN => NULL()
      Z_YDMF_PHYS_OUT_FPLCL => NULL()
      Z_YDMF_PHYS_OUT_FPLCN => NULL()
      Z_YDMF_PHYS_OUT_FPLSL => NULL()
      Z_YDMF_PHYS_OUT_FEVL => NULL()
      Z_YDMF_PHYS_OUT_FPLSN => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PPSL => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PPSN => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PEVA => NULL()
      Z_YDMF_PHYS_OUT_FEVN => NULL()
      Z_YDMF_PHYS_SURF_GSD_VH_PPCL => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:0', 1, ZHOOK_HANDLE_PARALLEL)
    
  END IF
  
  ! Surface specific humidity necessary to compute the vertical advection of q in the case "delta m=1" (unlagged physics only).
  
  IF (YDMODEL%YRML_PHY_MF%YRPHY%NDPSFI == 1) THEN
    
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1', 0, ZHOOK_HANDLE_PARALLEL)
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:1')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
      Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDWR(YDCPG_PHY0%F_PREHYD)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSP_RR%F_T_T0)
      Z_YDCPG_MISC_QSOL => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QSOL)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL CPQSOL(YDMODEL%YRCST, YDGEOMETRY%YRDIMV, YDMODEL%YRML_PHY_MF%YRPHY, YDCPG_OPTS%KLON, YLCPG_BNDS%KIDIA,  &
        & YLCPG_BNDS%KFDIA, Z_YDCPG_PHY0_PREHYD(:, :, JBLK), Z_YDMF_PHYS_SURF_GSP_RR_PT_T0(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK),  &
        & ZFLU_QSATS(:, JBLK), Z_YDCPG_MISC_QSOL(:, JBLK))
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:1')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
        Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDWR(YDCPG_PHY0%F_PREHYD)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
        Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSP_RR%F_T_T0)
        Z_YDCPG_MISC_QSOL => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QSOL)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZFLU_QSATS => NULL()
      Z_YDCPG_PHY0_PREHYD => NULL()
      Z_YDCPG_MISC_QS => NULL()
      Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => NULL()
      Z_YDCPG_MISC_QSOL => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:1')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
      Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDWR(YDCPG_PHY0%F_PREHYD)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSP_RR%F_T_T0)
      Z_YDCPG_MISC_QSOL => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QSOL)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL CPQSOL_OPENACC(YDMODEL%YRCST, YDGEOMETRY%YRDIMV, YDMODEL%YRML_PHY_MF%YRPHY, YDCPG_OPTS%KLON, YLCPG_BNDS%KIDIA,  &
          & YLCPG_BNDS%KFDIA, Z_YDCPG_PHY0_PREHYD(:, :, JBLK), Z_YDMF_PHYS_SURF_GSP_RR_PT_T0(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK),  &
          & ZFLU_QSATS(:, JBLK), Z_YDCPG_MISC_QSOL(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:1')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
        Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDWR(YDCPG_PHY0%F_PREHYD)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
        Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSP_RR%F_T_T0)
        Z_YDCPG_MISC_QSOL => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QSOL)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZFLU_QSATS => NULL()
      Z_YDCPG_PHY0_PREHYD => NULL()
      Z_YDCPG_MISC_QS => NULL()
      Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => NULL()
      Z_YDCPG_MISC_QSOL => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:1')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      ZFLU_QSATS => GET_DEVICE_DATA_RDWR(YL_ZFLU_QSATS)
      Z_YDCPG_PHY0_PREHYD => GET_DEVICE_DATA_RDWR(YDCPG_PHY0%F_PREHYD)
      Z_YDCPG_MISC_QS => GET_DEVICE_DATA_RDWR(YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSP_RR%F_T_T0)
      Z_YDCPG_MISC_QSOL => GET_DEVICE_DATA_RDWR(YDCPG_MISC%F_QSOL)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZFLU_QSATS, Z_YDCPG_PHY0_PREHYD, Z_YDCPG_MISC_QS,  &
!$ACC & Z_YDMF_PHYS_SURF_GSP_RR_PT_T0, Z_YDCPG_MISC_QSOL, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL CPQSOL_OPENACC(YDMODEL%YRCST, YDGEOMETRY%YRDIMV, YDMODEL%YRML_PHY_MF%YRPHY, YDCPG_OPTS%KLON, YLCPG_BNDS%KIDIA,  &
          & YLCPG_BNDS%KFDIA, Z_YDCPG_PHY0_PREHYD(:, :, JBLK), Z_YDMF_PHYS_SURF_GSP_RR_PT_T0(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK),  &
          & ZFLU_QSATS(:, JBLK), Z_YDCPG_MISC_QSOL(:, JBLK), YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:1')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        ZFLU_QSATS => GET_HOST_DATA_RDWR(YL_ZFLU_QSATS)
        Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDWR(YDCPG_PHY0%F_PREHYD)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QS)
        Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSP_RR%F_T_T0)
        Z_YDCPG_MISC_QSOL => GET_HOST_DATA_RDWR(YDCPG_MISC%F_QSOL)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      ZFLU_QSATS => NULL()
      Z_YDCPG_PHY0_PREHYD => NULL()
      Z_YDCPG_MISC_QS => NULL()
      Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => NULL()
      Z_YDCPG_MISC_QSOL => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:1', 1, ZHOOK_HANDLE_PARALLEL)
    
  END IF
  
  CALL APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL(YDMF_PHYS_BASE_STATE, YDMF_PHYS_NEXT_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS,  &
  & YDCPG_MISC, YDMF_PHYS, YDCPG_DYN0, YDMF_PHYS_SURF, YDVARS, YDMODEL, YDDDH, YL_ZDIFEXT, YL_ZDSA_CPS, YL_ZMSC_FRMQ,  &
  & YL_ZPFL_FEFB1, YL_ZPFL_FEFB2, YL_ZPFL_FEFB3, YL_ZPFL_FTKE, YL_ZPFL_FTKEI)
  
  CALL MF_PHYS_FPL_PART2_PARALLEL(YDCPG_BNDS, YDCPG_OPTS, YL_ZPFL_FPLCH, YL_ZPFL_FPLSH, YDVARS%CPF%FT1, YDVARS%SPF%FT1, YDMODEL)
  
  CALL MF_PHYS_TRANSFER_PARALLEL(YDCPG_BNDS, YDCPG_OPTS, YDVARS, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_GCONF%YGFL)
  
  CALL APL_ARPEGE_SURFACE_UPDATE_PARALLEL(YDCPG_BNDS, YDCPG_OPTS, YDCPG_GPAR, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL,  &
  & YDCPG_OPTS%LCONFX, YDCPG_OPTS%ZDTPHY, YL_ZDSA_C1, YL_ZDSA_C2, YL_ZFLU_FEVI, YL_ZFLU_VEG)
  
  IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVPGY) THEN
    
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2', 0, ZHOOK_HANDLE_PARALLEL)
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:2')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_CVV_T0 => GET_HOST_DATA_RDWR(YDVARS%CVV%FT0)
      Z_YDVARS_CVV_T1 => GET_HOST_DATA_RDWR(YDVARS%CVV%FT1)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        CALL YLCPG_BNDS%UPDATE(JBLK)
        CALL MF_PHYS_CVV(YLCPG_BNDS, YDCPG_OPTS, Z_YDVARS_CVV_T0(:, :, JBLK), Z_YDVARS_CVV_T1(:, :, JBLK))
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:2')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDVARS_CVV_T0 => GET_HOST_DATA_RDWR(YDVARS%CVV%FT0)
        Z_YDVARS_CVV_T1 => GET_HOST_DATA_RDWR(YDVARS%CVV%FT1)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_CVV_T0 => NULL()
      Z_YDVARS_CVV_T1 => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:2')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_CVV_T0 => GET_HOST_DATA_RDWR(YDVARS%CVV%FT0)
      Z_YDVARS_CVV_T1 => GET_HOST_DATA_RDWR(YDVARS%CVV%FT1)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL MF_PHYS_CVV_OPENACC(YLCPG_BNDS, YDCPG_OPTS, Z_YDVARS_CVV_T0(:, :, JBLK), Z_YDVARS_CVV_T1(:, :, JBLK),  &
          & YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:2')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDVARS_CVV_T0 => GET_HOST_DATA_RDWR(YDVARS%CVV%FT0)
        Z_YDVARS_CVV_T1 => GET_HOST_DATA_RDWR(YDVARS%CVV%FT1)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_CVV_T0 => NULL()
      Z_YDVARS_CVV_T1 => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:2')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_CVV_T0 => GET_DEVICE_DATA_RDWR(YDVARS%CVV%FT0)
      Z_YDVARS_CVV_T1 => GET_DEVICE_DATA_RDWR(YDVARS%CVV%FT1)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, Z_YDVARS_CVV_T0, Z_YDVARS_CVV_T1, ) PRIVATE( JBLK )  &
!$ACC & VECTOR_LENGTH( YDCPG_OPTS%KLON )
      DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
          CALL MF_PHYS_CVV_OPENACC(YLCPG_BNDS, YDCPG_OPTS, Z_YDVARS_CVV_T0(:, :, JBLK), Z_YDVARS_CVV_T1(:, :, JBLK),  &
          & YDSTACK=YLSTACK)
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE:2')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        Z_YDVARS_CVV_T0 => GET_HOST_DATA_RDWR(YDVARS%CVV%FT0)
        Z_YDVARS_CVV_T1 => GET_HOST_DATA_RDWR(YDVARS%CVV%FT1)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_CVV_T0 => NULL()
      Z_YDVARS_CVV_T1 => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:2', 1, ZHOOK_HANDLE_PARALLEL)
    
  END IF
  
  ! Restore the initial value of some pseudo-historical surface buffers if relevant.
  
  IF (YDCPG_OPTS%LCONFX) THEN
    
    CALL MF_PHYS_SAVE_PHSURF_PART2_PARALLEL(YDCPG_BNDS, YDCPG_OPTS, YL_ZSAV_DDAL, YL_ZSAV_DDOM, YL_ZSAV_ENTCH, YL_ZSAV_FHPS,  &
    & YL_ZSAV_GZ0F, YL_ZSAV_GZ0HF, YL_ZSAV_HV, YL_ZSAV_PBLH, YL_ZSAV_QSH, YL_ZSAV_UDAL, YL_ZSAV_UDGRO, YL_ZSAV_UDOM,  &
    & YL_ZSAV_UNEBH, YDMF_PHYS_SURF%GSD_VF%F_Z0F, YDMF_PHYS_SURF%GSD_VH%F_PBLH, YDMF_PHYS_SURF%GSD_VH%F_QSH,  &
    & YDMF_PHYS_SURF%GSD_VH%F_SPSH, YDMF_PHYS_SURF%GSD_VK%F_UDGRO, YDMF_PHYS_SURF%GSD_VV%F_HV, YDMF_PHYS_SURF%GSD_VV%F_Z0H,  &
    & YDVARS%DAL%FT0, YDVARS%DOM%FT0, YDVARS%UAL%FT0, YDVARS%UEN%FT0, YDVARS%UNEBH%FT0, YDVARS%UOM%FT0, YDMODEL)
    
  END IF
  
  ! Store horizontal exchange coefficients (3D turbulence) to SL2 buffers
  
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:BAYRAD')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
    Z_YDVARS_SCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%SCONV%FT1)
    Z_YDVARS_RCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%RCONV%FT1)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL MF_PHYS_BAYRAD(YLCPG_BNDS, YDCPG_OPTS, ZBAY_QRCONV(:, :, JBLK), ZBAY_QSCONV(:, :, JBLK),  &
      & Z_YDVARS_RCONV_T1(:, :, JBLK), Z_YDVARS_SCONV_T1(:, :, JBLK), YDMODEL)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:BAYRAD')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
      ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
      Z_YDVARS_SCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%SCONV%FT1)
      Z_YDVARS_RCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%RCONV%FT1)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => NULL()
    ZBAY_QSCONV => NULL()
    Z_YDVARS_SCONV_T1 => NULL()
    Z_YDVARS_RCONV_T1 => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:BAYRAD')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
    Z_YDVARS_SCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%SCONV%FT1)
    Z_YDVARS_RCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%RCONV%FT1)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL MF_PHYS_BAYRAD_OPENACC(YLCPG_BNDS, YDCPG_OPTS, ZBAY_QRCONV(:, :, JBLK), ZBAY_QSCONV(:, :, JBLK),  &
        & Z_YDVARS_RCONV_T1(:, :, JBLK), Z_YDVARS_SCONV_T1(:, :, JBLK), YDMODEL, YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:BAYRAD')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
      ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
      Z_YDVARS_SCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%SCONV%FT1)
      Z_YDVARS_RCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%RCONV%FT1)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => NULL()
    ZBAY_QSCONV => NULL()
    Z_YDVARS_SCONV_T1 => NULL()
    Z_YDVARS_RCONV_T1 => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:BAYRAD')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_DEVICE_DATA_RDWR(YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_DEVICE_DATA_RDWR(YL_ZBAY_QSCONV)
    Z_YDVARS_SCONV_T1 => GET_DEVICE_DATA_RDWR(YDVARS%SCONV%FT1)
    Z_YDVARS_RCONV_T1 => GET_DEVICE_DATA_RDWR(YDVARS%RCONV%FT1)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZBAY_QRCONV, ZBAY_QSCONV, Z_YDVARS_SCONV_T1,  &
!$ACC & Z_YDVARS_RCONV_T1, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL MF_PHYS_BAYRAD_OPENACC(YLCPG_BNDS, YDCPG_OPTS, ZBAY_QRCONV(:, :, JBLK), ZBAY_QSCONV(:, :, JBLK),  &
        & Z_YDVARS_RCONV_T1(:, :, JBLK), Z_YDVARS_SCONV_T1(:, :, JBLK), YDMODEL, YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:BAYRAD')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZBAY_QRCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QRCONV)
      ZBAY_QSCONV => GET_HOST_DATA_RDWR(YL_ZBAY_QSCONV)
      Z_YDVARS_SCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%SCONV%FT1)
      Z_YDVARS_RCONV_T1 => GET_HOST_DATA_RDWR(YDVARS%RCONV%FT1)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => NULL()
    ZBAY_QSCONV => NULL()
    Z_YDVARS_SCONV_T1 => NULL()
    Z_YDVARS_RCONV_T1 => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:BAYRAD', 1, ZHOOK_HANDLE_PARALLEL)
  
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:EDR')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_DI%F_XEDR(:, JLEV))
    Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_EDR(:, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:EDR')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_DI%F_XEDR(:, JLEV))
      Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_EDR(:, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => NULL()
    Z_YDMF_PHYS_OUT_EDR => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:EDR')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_DI%F_XEDR(:, JLEV))
    Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_EDR(:, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:EDR')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_DI%F_XEDR(:, JLEV))
      Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_EDR(:, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => NULL()
    Z_YDMF_PHYS_OUT_EDR => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:EDR')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_DI%F_XEDR(:, JLEV))
    Z_YDMF_PHYS_OUT_EDR => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_EDR(:, JLEV))
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, Z_YDMF_PHYS_SURF_GSD_DI_PXEDR, Z_YDMF_PHYS_OUT_EDR, )  &
!$ACC & PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:EDR')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_DI%F_XEDR(:, JLEV))
      Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_EDR(:, JLEV))
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => NULL()
    Z_YDMF_PHYS_OUT_EDR => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:EDR', 1, ZHOOK_HANDLE_PARALLEL)
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS', 0, ZHOOK_HANDLE_PARALLEL)
  IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE:PRECIPS')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZPRC_DPRECIPS => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS)
    ZPRC_DPRECIPS2 => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS2)
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
    CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE JBLK FIRSTPRIVATE( YLCPG_BNDS )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      CALL YLCPG_BNDS%UPDATE(JBLK)
      CALL MF_PHYS_PRECIPS(YLCPG_BNDS, YDCPG_OPTS, ZPRC_DPRECIPS(:, :, JBLK), ZPRC_DPRECIPS2(:, :, JBLK),  &
      & Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP(:, :, JBLK), Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2(:, :, JBLK), YDMODEL)
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:PRECIPS')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZPRC_DPRECIPS => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS)
      ZPRC_DPRECIPS2 => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS2)
      Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
      Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZPRC_DPRECIPS => NULL()
    ZPRC_DPRECIPS2 => NULL()
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => NULL()
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE:PRECIPS')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZPRC_DPRECIPS => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS)
    ZPRC_DPRECIPS2 => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS2)
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL MF_PHYS_PRECIPS_OPENACC(YLCPG_BNDS, YDCPG_OPTS, ZPRC_DPRECIPS(:, :, JBLK), ZPRC_DPRECIPS2(:, :, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP(:, :, JBLK), Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2(:, :, JBLK), YDMODEL, YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:PRECIPS')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZPRC_DPRECIPS => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS)
      ZPRC_DPRECIPS2 => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS2)
      Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
      Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZPRC_DPRECIPS => NULL()
    ZPRC_DPRECIPS2 => NULL()
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => NULL()
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE:PRECIPS')) THEN
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
    ZPRC_DPRECIPS => GET_DEVICE_DATA_RDWR(YL_ZPRC_DPRECIPS)
    ZPRC_DPRECIPS2 => GET_DEVICE_DATA_RDWR(YL_ZPRC_DPRECIPS2)
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( YDCPG_OPTS, YDGEOMETRY, YDMODEL, YSTACK, ZPRC_DPRECIPS, ZPRC_DPRECIPS2,  &
!$ACC & Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP, Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2, ) PRIVATE( JBLK ) VECTOR_LENGTH( YDCPG_OPTS%KLON )
    DO JBLK=1,YDCPG_OPTS%KGPBLKS
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
      DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L = stack_l(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U = stack_u(YSTACK, JBLK, YDCPG_OPTS%KGPBLKS)
        CALL MF_PHYS_PRECIPS_OPENACC(YLCPG_BNDS, YDCPG_OPTS, ZPRC_DPRECIPS(:, :, JBLK), ZPRC_DPRECIPS2(:, :, JBLK),  &
        & Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP(:, :, JBLK), Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2(:, :, JBLK), YDMODEL, YDSTACK=YLSTACK)
      END DO
    END DO
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
    IF (LSYNCHOST('APL_ARPEGE:PRECIPS')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
      ZPRC_DPRECIPS => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS)
      ZPRC_DPRECIPS2 => GET_HOST_DATA_RDWR(YL_ZPRC_DPRECIPS2)
      Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
      Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
    ZPRC_DPRECIPS => NULL()
    ZPRC_DPRECIPS2 => NULL()
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => NULL()
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => NULL()
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
  END IF
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE:PRECIPS', 1, ZHOOK_HANDLE_PARALLEL)
  
  
  IF (LHOOK) CALL DR_HOOK('DELETE_TEMPORARIES', 0, ZHOOK_HANDLE_FIELD_API)
  
  IF (ASSOCIATED(YL_ZRDG_MU0LU)) CALL FIELD_DELETE(YL_ZRDG_MU0LU)
  IF (ASSOCIATED(YL_ZRDG_CVGQ)) CALL FIELD_DELETE(YL_ZRDG_CVGQ)
  IF (ASSOCIATED(YL_ZRDG_MU0)) CALL FIELD_DELETE(YL_ZRDG_MU0)
  IF (ASSOCIATED(YL_ZRDG_MU0M)) CALL FIELD_DELETE(YL_ZRDG_MU0M)
  IF (ASSOCIATED(YL_ZRDG_MU0N)) CALL FIELD_DELETE(YL_ZRDG_MU0N)
  IF (ASSOCIATED(YL_ZRDG_LCVQ)) CALL FIELD_DELETE(YL_ZRDG_LCVQ)
  IF (ASSOCIATED(YL_ZFLU_QSATS)) CALL FIELD_DELETE(YL_ZFLU_QSATS)
  IF (ASSOCIATED(YL_ZMSC_LSCPE)) CALL FIELD_DELETE(YL_ZMSC_LSCPE)
  IF (ASSOCIATED(YL_ZPFL_FEFB2)) CALL FIELD_DELETE(YL_ZPFL_FEFB2)
  IF (ASSOCIATED(YL_ZMSC_LH)) CALL FIELD_DELETE(YL_ZMSC_LH)
  IF (ASSOCIATED(YL_ZDSA_C2)) CALL FIELD_DELETE(YL_ZDSA_C2)
  IF (ASSOCIATED(YL_ZPFL_FEFB3)) CALL FIELD_DELETE(YL_ZPFL_FEFB3)
  IF (ASSOCIATED(YL_IMOC_CLPH)) CALL FIELD_DELETE(YL_IMOC_CLPH)
  IF (ASSOCIATED(YL_ZDSA_C1)) CALL FIELD_DELETE(YL_ZDSA_C1)
  IF (ASSOCIATED(YL_ZPFL_FEFB1)) CALL FIELD_DELETE(YL_ZPFL_FEFB1)
  IF (ASSOCIATED(YL_ZFLU_CH)) CALL FIELD_DELETE(YL_ZFLU_CH)
  IF (ASSOCIATED(YL_ZFLU_NEIJ)) CALL FIELD_DELETE(YL_ZFLU_NEIJ)
  IF (ASSOCIATED(YL_ZFLU_CD)) CALL FIELD_DELETE(YL_ZFLU_CD)
  IF (ASSOCIATED(YL_ZMSC_FRMQ)) CALL FIELD_DELETE(YL_ZMSC_FRMQ)
  IF (ASSOCIATED(YL_ZFLU_EMIS)) CALL FIELD_DELETE(YL_ZFLU_EMIS)
  IF (ASSOCIATED(YL_ZDSA_LHS)) CALL FIELD_DELETE(YL_ZDSA_LHS)
  IF (ASSOCIATED(YL_ZPFL_FTKEI)) CALL FIELD_DELETE(YL_ZPFL_FTKEI)
  IF (ASSOCIATED(YL_ZFLU_VEG)) CALL FIELD_DELETE(YL_ZFLU_VEG)
  IF (ASSOCIATED(YL_ZDSA_RS)) CALL FIELD_DELETE(YL_ZDSA_RS)
  IF (ASSOCIATED(YL_ZMSC_QW)) CALL FIELD_DELETE(YL_ZMSC_QW)
  IF (ASSOCIATED(YL_ZPFL_FTKE)) CALL FIELD_DELETE(YL_ZPFL_FTKE)
  IF (ASSOCIATED(YL_ZFLU_CDN)) CALL FIELD_DELETE(YL_ZFLU_CDN)
  IF (ASSOCIATED(YL_ZFLU_FEVI)) CALL FIELD_DELETE(YL_ZFLU_FEVI)
  IF (ASSOCIATED(YL_ZFLU_QSAT)) CALL FIELD_DELETE(YL_ZFLU_QSAT)
  IF (ASSOCIATED(YL_ZDSA_CPS)) CALL FIELD_DELETE(YL_ZDSA_CPS)
  IF (ASSOCIATED(YL_ZMSC_TW)) CALL FIELD_DELETE(YL_ZMSC_TW)
  IF (ASSOCIATED(YL_ZGEOSLC)) CALL FIELD_DELETE(YL_ZGEOSLC)
  IF (ASSOCIATED(YL_ZQV)) CALL FIELD_DELETE(YL_ZQV)
  IF (ASSOCIATED(YL_ZNEIJV)) CALL FIELD_DELETE(YL_ZNEIJV)
  IF (ASSOCIATED(YL_ZWSMX)) CALL FIELD_DELETE(YL_ZWSMX)
  IF (ASSOCIATED(YL_ZCN)) CALL FIELD_DELETE(YL_ZCN)
  IF (ASSOCIATED(YL_ZCG)) CALL FIELD_DELETE(YL_ZCG)
  IF (ASSOCIATED(YL_ZWFC)) CALL FIELD_DELETE(YL_ZWFC)
  IF (ASSOCIATED(YL_ZC3)) CALL FIELD_DELETE(YL_ZC3)
  IF (ASSOCIATED(YL_ZNEIJG)) CALL FIELD_DELETE(YL_ZNEIJG)
  IF (ASSOCIATED(YL_ZWWILT)) CALL FIELD_DELETE(YL_ZWWILT)
  IF (ASSOCIATED(YL_ZWSEQ)) CALL FIELD_DELETE(YL_ZWSEQ)
  IF (ASSOCIATED(YL_ZWPMX)) CALL FIELD_DELETE(YL_ZWPMX)
  IF (ASSOCIATED(YL_ZDPHIV)) CALL FIELD_DELETE(YL_ZDPHIV)
  IF (ASSOCIATED(YL_ZDPHIT)) CALL FIELD_DELETE(YL_ZDPHIT)
  IF (ASSOCIATED(YL_ZPCLS)) CALL FIELD_DELETE(YL_ZPCLS)
  IF (ASSOCIATED(YL_ZMRIPP)) CALL FIELD_DELETE(YL_ZMRIPP)
  IF (ASSOCIATED(YL_ZNBVNO)) CALL FIELD_DELETE(YL_ZNBVNO)
  IF (ASSOCIATED(YL_ZGWDCS)) CALL FIELD_DELETE(YL_ZGWDCS)
  IF (ASSOCIATED(YL_ZDPHI)) CALL FIELD_DELETE(YL_ZDPHI)
  IF (ASSOCIATED(YL_ZRTI)) CALL FIELD_DELETE(YL_ZRTI)
  IF (ASSOCIATED(YL_ZPRS)) CALL FIELD_DELETE(YL_ZPRS)
  IF (ASSOCIATED(YL_ZPFL_FPLSH)) CALL FIELD_DELETE(YL_ZPFL_FPLSH)
  IF (ASSOCIATED(YL_ZHU)) CALL FIELD_DELETE(YL_ZHU)
  IF (ASSOCIATED(YL_ZCDROV)) CALL FIELD_DELETE(YL_ZCDROV)
  IF (ASSOCIATED(YL_ZDQSTS)) CALL FIELD_DELETE(YL_ZDQSTS)
  IF (ASSOCIATED(YL_ZPFL_FPLCH)) CALL FIELD_DELETE(YL_ZPFL_FPLCH)
  IF (ASSOCIATED(YL_ZSTAB)) CALL FIELD_DELETE(YL_ZSTAB)
  IF (ASSOCIATED(YL_ZHQ)) CALL FIELD_DELETE(YL_ZHQ)
  IF (ASSOCIATED(YL_ZXDROV)) CALL FIELD_DELETE(YL_ZXDROV)
  IF (ASSOCIATED(YL_ZCHROV)) CALL FIELD_DELETE(YL_ZCHROV)
  IF (ASSOCIATED(YL_ZXHROV)) CALL FIELD_DELETE(YL_ZXHROV)
  IF (ASSOCIATED(YL_ZTHETAV)) CALL FIELD_DELETE(YL_ZTHETAV)
  IF (ASSOCIATED(YL_ZBLH)) CALL FIELD_DELETE(YL_ZBLH)
  IF (ASSOCIATED(YL_ZTHETAVS)) CALL FIELD_DELETE(YL_ZTHETAVS)
  IF (ASSOCIATED(YL_ZVGST)) CALL FIELD_DELETE(YL_ZVGST)
  IF (ASSOCIATED(YL_ZUGST)) CALL FIELD_DELETE(YL_ZUGST)
  IF (ASSOCIATED(YL_ZCP)) CALL FIELD_DELETE(YL_ZCP)
  IF (ASSOCIATED(YL_ZDIFCVPPU)) CALL FIELD_DELETE(YL_ZDIFCVPPU)
  IF (ASSOCIATED(YL_ZDIFCVPPS)) CALL FIELD_DELETE(YL_ZDIFCVPPS)
  IF (ASSOCIATED(YL_ZDIFCVPPV)) CALL FIELD_DELETE(YL_ZDIFCVPPV)
  IF (ASSOCIATED(YL_ZDIFCVPPQ)) CALL FIELD_DELETE(YL_ZDIFCVPPQ)
  IF (ASSOCIATED(YL_ZNEBS)) CALL FIELD_DELETE(YL_ZNEBS)
  IF (ASSOCIATED(YL_ZTRAJGWD)) CALL FIELD_DELETE(YL_ZTRAJGWD)
  IF (ASSOCIATED(YL_ZQLIS)) CALL FIELD_DELETE(YL_ZQLIS)
  IF (ASSOCIATED(YL_ZFPLSL)) CALL FIELD_DELETE(YL_ZFPLSL)
  IF (ASSOCIATED(YL_ZSEDIQI)) CALL FIELD_DELETE(YL_ZSEDIQI)
  IF (ASSOCIATED(YL_ZFLX_LOTT_GWV)) CALL FIELD_DELETE(YL_ZFLX_LOTT_GWV)
  IF (ASSOCIATED(YL_ZSEDIQL)) CALL FIELD_DELETE(YL_ZSEDIQL)
  IF (ASSOCIATED(YL_ZFPLSN)) CALL FIELD_DELETE(YL_ZFPLSN)
  IF (ASSOCIATED(YL_ZQI)) CALL FIELD_DELETE(YL_ZQI)
  IF (ASSOCIATED(YL_ZFLX_LOTT_GWU)) CALL FIELD_DELETE(YL_ZFLX_LOTT_GWU)
  IF (ASSOCIATED(YL_ZQL)) CALL FIELD_DELETE(YL_ZQL)
  IF (ASSOCIATED(YL_ZFPCOR)) CALL FIELD_DELETE(YL_ZFPCOR)
  IF (ASSOCIATED(YL_ZTKE1)) CALL FIELD_DELETE(YL_ZTKE1)
  IF (ASSOCIATED(YL_ZDCAPE)) CALL FIELD_DELETE(YL_ZDCAPE)
  IF (ASSOCIATED(YL_ZQGM)) CALL FIELD_DELETE(YL_ZQGM)
  IF (ASSOCIATED(YL_ZQR)) CALL FIELD_DELETE(YL_ZQR)
  IF (ASSOCIATED(YL_ZQS)) CALL FIELD_DELETE(YL_ZQS)
  IF (ASSOCIATED(YL_ZBAY_QRCONV)) CALL FIELD_DELETE(YL_ZBAY_QRCONV)
  IF (ASSOCIATED(YL_ZBAY_QSCONV)) CALL FIELD_DELETE(YL_ZBAY_QSCONV)
  IF (ASSOCIATED(YL_ZDE2MR)) CALL FIELD_DELETE(YL_ZDE2MR)
  IF (ASSOCIATED(YL_ZPRC_DPRECIPS)) CALL FIELD_DELETE(YL_ZPRC_DPRECIPS)
  IF (ASSOCIATED(YL_ZPRC_DPRECIPS2)) CALL FIELD_DELETE(YL_ZPRC_DPRECIPS2)
  IF (ASSOCIATED(YL_ZSAV_PBLH)) CALL FIELD_DELETE(YL_ZSAV_PBLH)
  IF (ASSOCIATED(YL_ZSAV_HV)) CALL FIELD_DELETE(YL_ZSAV_HV)
  IF (ASSOCIATED(YL_ZSAV_QSH)) CALL FIELD_DELETE(YL_ZSAV_QSH)
  IF (ASSOCIATED(YL_ZSAV_ENTCH)) CALL FIELD_DELETE(YL_ZSAV_ENTCH)
  IF (ASSOCIATED(YL_ZSAV_GZ0HF)) CALL FIELD_DELETE(YL_ZSAV_GZ0HF)
  IF (ASSOCIATED(YL_ZSAV_FHPS)) CALL FIELD_DELETE(YL_ZSAV_FHPS)
  IF (ASSOCIATED(YL_ZSAV_UDAL)) CALL FIELD_DELETE(YL_ZSAV_UDAL)
  IF (ASSOCIATED(YL_ZSAV_UDOM)) CALL FIELD_DELETE(YL_ZSAV_UDOM)
  IF (ASSOCIATED(YL_ZSAV_UNEBH)) CALL FIELD_DELETE(YL_ZSAV_UNEBH)
  IF (ASSOCIATED(YL_ZSAV_DDAL)) CALL FIELD_DELETE(YL_ZSAV_DDAL)
  IF (ASSOCIATED(YL_ZSAV_GZ0F)) CALL FIELD_DELETE(YL_ZSAV_GZ0F)
  IF (ASSOCIATED(YL_ZSAV_DDOM)) CALL FIELD_DELETE(YL_ZSAV_DDOM)
  IF (ASSOCIATED(YL_ZSAV_UDGRO)) CALL FIELD_DELETE(YL_ZSAV_UDGRO)
  IF (ASSOCIATED(YL_ZTENHA)) CALL FIELD_DELETE(YL_ZTENHA)
  IF (ASSOCIATED(YL_ZLVT)) CALL FIELD_DELETE(YL_ZLVT)
  IF (ASSOCIATED(YL_ZCFBU)) CALL FIELD_DELETE(YL_ZCFBU)
  IF (ASSOCIATED(YL_ZSFSWDIR)) CALL FIELD_DELETE(YL_ZSFSWDIR)
  IF (ASSOCIATED(YL_ZCFATH)) CALL FIELD_DELETE(YL_ZCFATH)
  IF (ASSOCIATED(YL_ZAERINDS)) CALL FIELD_DELETE(YL_ZAERINDS)
  IF (ASSOCIATED(YL_ZSC_FEVN)) CALL FIELD_DELETE(YL_ZSC_FEVN)
  IF (ASSOCIATED(YL_ZCONDCVPPL)) CALL FIELD_DELETE(YL_ZCONDCVPPL)
  IF (ASSOCIATED(YL_ZNEB_CVPP)) CALL FIELD_DELETE(YL_ZNEB_CVPP)
  IF (ASSOCIATED(YL_ZCEMTR)) CALL FIELD_DELETE(YL_ZCEMTR)
  IF (ASSOCIATED(YL_ZUNEBH)) CALL FIELD_DELETE(YL_ZUNEBH)
  IF (ASSOCIATED(YL_ZKQROV)) CALL FIELD_DELETE(YL_ZKQROV)
  IF (ASSOCIATED(YL_ZEDMFQ)) CALL FIELD_DELETE(YL_ZEDMFQ)
  IF (ASSOCIATED(YL_ZTENQVA)) CALL FIELD_DELETE(YL_ZTENQVA)
  IF (ASSOCIATED(YL_ZCFAU)) CALL FIELD_DELETE(YL_ZCFAU)
  IF (ASSOCIATED(YL_ZXQRO)) CALL FIELD_DELETE(YL_ZXQRO)
  IF (ASSOCIATED(YL_ZXTRO)) CALL FIELD_DELETE(YL_ZXTRO)
  IF (ASSOCIATED(YL_ZCTRSO)) CALL FIELD_DELETE(YL_ZCTRSO)
  IF (ASSOCIATED(YL_ZNEBCH)) CALL FIELD_DELETE(YL_ZNEBCH)
  IF (ASSOCIATED(YL_ZSC_FEVI)) CALL FIELD_DELETE(YL_ZSC_FEVI)
  IF (ASSOCIATED(YL_ZALBP)) CALL FIELD_DELETE(YL_ZALBP)
  IF (ASSOCIATED(YL_ZTRSODIR)) CALL FIELD_DELETE(YL_ZTRSODIR)
  IF (ASSOCIATED(YL_ZAIPCMT)) CALL FIELD_DELETE(YL_ZAIPCMT)
  IF (ASSOCIATED(YL_ZQIC)) CALL FIELD_DELETE(YL_ZQIC)
  IF (ASSOCIATED(YL_ZSC_FCLL)) CALL FIELD_DELETE(YL_ZSC_FCLL)
  IF (ASSOCIATED(YL_ZTRSOD)) CALL FIELD_DELETE(YL_ZTRSOD)
  IF (ASSOCIATED(YL_ZTENT)) CALL FIELD_DELETE(YL_ZTENT)
  IF (ASSOCIATED(YL_ZXUROV)) CALL FIELD_DELETE(YL_ZXUROV)
  IF (ASSOCIATED(YL_ZEDMFS)) CALL FIELD_DELETE(YL_ZEDMFS)
  IF (ASSOCIATED(YL_ZMF_UP)) CALL FIELD_DELETE(YL_ZMF_UP)
  IF (ASSOCIATED(YL_ZQLI_CVPP)) CALL FIELD_DELETE(YL_ZQLI_CVPP)
  IF (ASSOCIATED(YL_ZKUROV)) CALL FIELD_DELETE(YL_ZKUROV)
  IF (ASSOCIATED(YL_ZCONDCVPPI)) CALL FIELD_DELETE(YL_ZCONDCVPPI)
  IF (ASSOCIATED(YL_ZTRSODIF)) CALL FIELD_DELETE(YL_ZTRSODIF)
  IF (ASSOCIATED(YL_INLAB_CVPP)) CALL FIELD_DELETE(YL_INLAB_CVPP)
  IF (ASSOCIATED(YL_ZQLI_CVP)) CALL FIELD_DELETE(YL_ZQLI_CVP)
  IF (ASSOCIATED(YL_ZQLIS0)) CALL FIELD_DELETE(YL_ZQLIS0)
  IF (ASSOCIATED(YL_ZEDMFV)) CALL FIELD_DELETE(YL_ZEDMFV)
  IF (ASSOCIATED(YL_ZEDMFU)) CALL FIELD_DELETE(YL_ZEDMFU)
  IF (ASSOCIATED(YL_ZKQLROV)) CALL FIELD_DELETE(YL_ZKQLROV)
  IF (ASSOCIATED(YL_ZDECRD)) CALL FIELD_DELETE(YL_ZDECRD)
  IF (ASSOCIATED(YL_ZDIFWS)) CALL FIELD_DELETE(YL_ZDIFWS)
  IF (ASSOCIATED(YL_ZCFBV)) CALL FIELD_DELETE(YL_ZCFBV)
  IF (ASSOCIATED(YL_ZXURO)) CALL FIELD_DELETE(YL_ZXURO)
  IF (ASSOCIATED(YL_ZPRODTH_CVPP)) CALL FIELD_DELETE(YL_ZPRODTH_CVPP)
  IF (ASSOCIATED(YL_ZQLC)) CALL FIELD_DELETE(YL_ZQLC)
  IF (ASSOCIATED(YL_ZALPHA1)) CALL FIELD_DELETE(YL_ZALPHA1)
  IF (ASSOCIATED(YL_ZCOEFA)) CALL FIELD_DELETE(YL_ZCOEFA)
  IF (ASSOCIATED(YL_ZNEBDIFF)) CALL FIELD_DELETE(YL_ZNEBDIFF)
  IF (ASSOCIATED(YL_ZSFSWDIF)) CALL FIELD_DELETE(YL_ZSFSWDIF)
  IF (ASSOCIATED(YL_ZCFBTH)) CALL FIELD_DELETE(YL_ZCFBTH)
  IF (ASSOCIATED(YL_ZNEBS0)) CALL FIELD_DELETE(YL_ZNEBS0)
  IF (ASSOCIATED(YL_ZDIFWQ)) CALL FIELD_DELETE(YL_ZDIFWQ)
  IF (ASSOCIATED(YL_ZALBD)) CALL FIELD_DELETE(YL_ZALBD)
  IF (ASSOCIATED(YL_ZKTROV)) CALL FIELD_DELETE(YL_ZKTROV)
  IF (ASSOCIATED(YL_ZNEBC0)) CALL FIELD_DELETE(YL_ZNEBC0)
  IF (ASSOCIATED(YL_ZPOID)) CALL FIELD_DELETE(YL_ZPOID)
  IF (ASSOCIATED(YL_ZAER)) CALL FIELD_DELETE(YL_ZAER)
  IF (ASSOCIATED(YL_ZSUDU)) CALL FIELD_DELETE(YL_ZSUDU)
  IF (ASSOCIATED(YL_ZQO3)) CALL FIELD_DELETE(YL_ZQO3)
  IF (ASSOCIATED(YL_ZQICE)) CALL FIELD_DELETE(YL_ZQICE)
  IF (ASSOCIATED(YL_ZQC_DET_PCMT)) CALL FIELD_DELETE(YL_ZQC_DET_PCMT)
  IF (ASSOCIATED(YL_ZXTROV)) CALL FIELD_DELETE(YL_ZXTROV)
  IF (ASSOCIATED(YL_ZSC_FCLN)) CALL FIELD_DELETE(YL_ZSC_FCLN)
  IF (ASSOCIATED(YL_ZSGROUPEL)) CALL FIELD_DELETE(YL_ZSGROUPEL)
  IF (ASSOCIATED(YL_ZSSNOW)) CALL FIELD_DELETE(YL_ZSSNOW)
  IF (ASSOCIATED(YL_ZTSN)) CALL FIELD_DELETE(YL_ZTSN)
  IF (ASSOCIATED(YL_ZSRAIN)) CALL FIELD_DELETE(YL_ZSRAIN)
  IF (ASSOCIATED(YL_ZCEROV)) CALL FIELD_DELETE(YL_ZCEROV)
  IF (ASSOCIATED(YL_ZCOEFN)) CALL FIELD_DELETE(YL_ZCOEFN)
  IF (ASSOCIATED(YL_ZHTR)) CALL FIELD_DELETE(YL_ZHTR)
  IF (ASSOCIATED(YL_ZWLMX)) CALL FIELD_DELETE(YL_ZWLMX)
  IF (ASSOCIATED(YL_ZDIFEXT)) CALL FIELD_DELETE(YL_ZDIFEXT)
  IF (LHOOK) CALL DR_HOOK('DELETE_TEMPORARIES', 1, ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE', 1, ZHOOK_HANDLE)
  
END SUBROUTINE APL_ARPEGE
