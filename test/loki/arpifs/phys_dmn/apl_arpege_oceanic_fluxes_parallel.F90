SUBROUTINE APL_ARPEGE_OCEANIC_FLUXES_PARALLEL (YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS, YDMF_PHYS_SURF,  &
& YDMODEL, LDHMT, YD_PCDROV, YD_PCEROV, YD_PCHROV, YD_PDPHIT, YD_PDPHIV, YD_PDSA_RS, YD_PFLU_CD, YD_PFLU_CDN, YD_PFLU_CH,  &
& YD_PFLU_QSATS)
  
  !**** *APL_ARPEGE_OCEANIC_FLUXES*
  
  !     Author.
  !     -------
  !      Philippe Marguinaud *METEO-FRANCE*
  !      Original : 28-04-2021
  
  USE ACPY_MOD
  USE STACK_MOD
  USE YOMPARALLELMETHOD
  USE FIELD_ACCESS_MODULE
  USE FIELD_FACTORY_MODULE
  USE FIELD_MODULE
#include "stack.h"
  USE YOMHOOK, ONLY: LHOOK, DR_HOOK, JPHOOK
  USE PARKIND1, ONLY: JPIM, JPRB
  
  USE GEOMETRY_MOD, ONLY: GEOMETRY
  USE MF_PHYS_BASE_STATE_TYPE_MOD, ONLY: MF_PHYS_BASE_STATE_TYPE
  USE CPG_OPTS_TYPE_MOD, ONLY: CPG_BNDS_TYPE, CPG_OPTS_TYPE
  USE MF_PHYS_TYPE_MOD, ONLY: MF_PHYS_TYPE
  USE MF_PHYS_SURFACE_TYPE_MOD, ONLY: MF_PHYS_SURF_TYPE
  USE TYPE_MODEL, ONLY: MODEL
  
  
  IMPLICIT NONE
  
  TYPE(MF_PHYS_BASE_STATE_TYPE), INTENT(IN) :: YDMF_PHYS_BASE_STATE
  TYPE(CPG_BNDS_TYPE), INTENT(IN) :: YDCPG_BNDS
  TYPE(CPG_OPTS_TYPE), INTENT(IN) :: YDCPG_OPTS
  TYPE(MF_PHYS_TYPE), INTENT(INOUT) :: YDMF_PHYS
  TYPE(MF_PHYS_SURF_TYPE), INTENT(INOUT) :: YDMF_PHYS_SURF
  TYPE(MODEL), INTENT(IN) :: YDMODEL
  LOGICAL, INTENT(IN) :: LDHMT
  CLASS(FIELD_2RB), POINTER :: YD_PCDROV
  REAL(KIND=JPRB), POINTER :: PCDROV(:, :)
  CLASS(FIELD_2RB), POINTER :: YD_PCEROV
  REAL(KIND=JPRB), POINTER :: PCEROV(:, :)
  CLASS(FIELD_2RB), POINTER :: YD_PCHROV
  REAL(KIND=JPRB), POINTER :: PCHROV(:, :)
  CLASS(FIELD_2RB), POINTER :: YD_PDPHIT
  REAL(KIND=JPRB), POINTER :: PDPHIT(:, :)
  CLASS(FIELD_2RB), POINTER :: YD_PDPHIV
  REAL(KIND=JPRB), POINTER :: PDPHIV(:, :)
  CLASS(FIELD_2RB), POINTER :: YD_PDSA_RS
  REAL(KIND=JPRB), POINTER :: PDSA_RS(:, :)
  CLASS(FIELD_2RB), POINTER :: YD_PFLU_CD
  REAL(KIND=JPRB), POINTER :: PFLU_CD(:, :)
  CLASS(FIELD_2RB), POINTER :: YD_PFLU_CDN
  REAL(KIND=JPRB), POINTER :: PFLU_CDN(:, :)
  CLASS(FIELD_2RB), POINTER :: YD_PFLU_CH
  REAL(KIND=JPRB), POINTER :: PFLU_CH(:, :)
  CLASS(FIELD_2RB), POINTER :: YD_PFLU_QSATS
  REAL(KIND=JPRB), POINTER :: PFLU_QSATS(:, :)
  
#include "acfluso.intfb.h"
#include "acfluso_openacc.intfb.h"
  
  CLASS(FIELD_2RB), POINTER :: YL_ZCE => NULL()
  REAL(KIND=JPRB), POINTER :: ZCE(:, :) => NULL()
  CLASS(FIELD_2RB), POINTER :: YL_ZCRTI => NULL()
  REAL(KIND=JPRB), POINTER :: ZCRTI(:, :) => NULL()
  INTEGER(KIND=JPIM) :: JLON
  
  REAL(KIND=JPHOOK) :: ZHOOK_HANDLE
  TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
  TYPE(STACK) :: YLSTACK
  INTEGER(KIND=JPIM) :: JBLK
  REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
  REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
  REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_Q(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_T(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_U(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_V(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_GZ0(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_QCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_RHCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_TCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_UCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_UGST(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VCLS(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VGST(:, :)
  REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, :)
  
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES', 0, ZHOOK_HANDLE)
  IF (LHOOK) CALL DR_HOOK('CREATE_TEMPORARIES', 0, ZHOOK_HANDLE_FIELD_API)
  
  CALL FIELD_NEW(YL_ZCE, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX /), LBOUNDS=(/ 1, YDCPG_OPTS%JBLKMIN /),  &
  & PERSISTENT=.true.)
  CALL FIELD_NEW(YL_ZCRTI, UBOUNDS=(/ YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX /), LBOUNDS=(/ 1, YDCPG_OPTS%JBLKMIN /),  &
  & PERSISTENT=.true.)
  IF (LHOOK) CALL DR_HOOK('CREATE_TEMPORARIES', 1, ZHOOK_HANDLE_FIELD_API)
  
  
  ! OCEANIC FLUXES COMPUTATION (IF NOT SURFEX)
  
  IF (.not.YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN
    
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO', 0, ZHOOK_HANDLE_PARALLEL)
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      PCDROV => GET_HOST_DATA_RDWR(YD_PCDROV)
      PCEROV => GET_HOST_DATA_RDWR(YD_PCEROV)
      PCHROV => GET_HOST_DATA_RDWR(YD_PCHROV)
      PDPHIT => GET_HOST_DATA_RDWR(YD_PDPHIT)
      PDPHIV => GET_HOST_DATA_RDWR(YD_PDPHIV)
      PDSA_RS => GET_HOST_DATA_RDWR(YD_PDSA_RS)
      PFLU_CD => GET_HOST_DATA_RDWR(YD_PFLU_CD)
      PFLU_CDN => GET_HOST_DATA_RDWR(YD_PFLU_CDN)
      PFLU_CH => GET_HOST_DATA_RDWR(YD_PFLU_CH)
      PFLU_QSATS => GET_HOST_DATA_RDWR(YD_PFLU_QSATS)
      ZCE => GET_HOST_DATA_RDWR(YL_ZCE)
      ZCRTI => GET_HOST_DATA_RDWR(YL_ZCRTI)
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
      Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
      Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
      Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON ) FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=YDCPG_OPTS%JBLKMIN,YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE(JBLK)
        
        DO JLON=YLCPG_BNDS%KIDIA,YLCPG_BNDS%KFDIA
          ZCRTI(JLON, JBLK) = 1.0_JPRB / (Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(JLON, JBLK)*PDSA_RS(JLON, JBLK))
        END DO
        CALL ACFLUSO(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
        & YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(:, :, JBLK),  &
        & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK),  &
        & PDPHIT(:, JBLK), PDPHIV(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK),  &
        & PFLU_QSATS(:, JBLK), ZCRTI(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), LDHMT, PFLU_CD(:, JBLK),  &
        & PFLU_CDN(:, JBLK), PCDROV(:, JBLK), ZCE(:, JBLK), PCEROV(:, JBLK), PFLU_CH(:, JBLK), PCHROV(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_QCLS(:, JBLK), Z_YDMF_PHYS_OUT_RHCLS(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_UCLS(:, JBLK), Z_YDMF_PHYS_OUT_VCLS(:, JBLK), Z_YDMF_PHYS_OUT_UGST(:, JBLK),  &
        & Z_YDMF_PHYS_OUT_VGST(:, JBLK))
        
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        PCDROV => GET_HOST_DATA_RDWR(YD_PCDROV)
        PCEROV => GET_HOST_DATA_RDWR(YD_PCEROV)
        PCHROV => GET_HOST_DATA_RDWR(YD_PCHROV)
        PDPHIT => GET_HOST_DATA_RDWR(YD_PDPHIT)
        PDPHIV => GET_HOST_DATA_RDWR(YD_PDPHIV)
        PDSA_RS => GET_HOST_DATA_RDWR(YD_PDSA_RS)
        PFLU_CD => GET_HOST_DATA_RDWR(YD_PFLU_CD)
        PFLU_CDN => GET_HOST_DATA_RDWR(YD_PFLU_CDN)
        PFLU_CH => GET_HOST_DATA_RDWR(YD_PFLU_CH)
        PFLU_QSATS => GET_HOST_DATA_RDWR(YD_PFLU_QSATS)
        ZCE => GET_HOST_DATA_RDWR(YL_ZCE)
        ZCRTI => GET_HOST_DATA_RDWR(YL_ZCRTI)
        Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
        Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
        Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
        Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
        Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
        Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
        Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
        Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      PCDROV => NULL()
      PCEROV => NULL()
      PCHROV => NULL()
      PDPHIT => NULL()
      PDPHIV => NULL()
      PDSA_RS => NULL()
      PFLU_CD => NULL()
      PFLU_CDN => NULL()
      PFLU_CH => NULL()
      PFLU_QSATS => NULL()
      ZCE => NULL()
      ZCRTI => NULL()
      Z_YDMF_PHYS_BASE_STATE_Q => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_OUT_GZ0 => NULL()
      Z_YDMF_PHYS_OUT_QCLS => NULL()
      Z_YDMF_PHYS_OUT_RHCLS => NULL()
      Z_YDMF_PHYS_OUT_TCLS => NULL()
      Z_YDMF_PHYS_OUT_UCLS => NULL()
      Z_YDMF_PHYS_OUT_UGST => NULL()
      Z_YDMF_PHYS_OUT_VCLS => NULL()
      Z_YDMF_PHYS_OUT_VGST => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENMPSINGLECOLUMN', 'APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      PCDROV => GET_HOST_DATA_RDWR(YD_PCDROV)
      PCEROV => GET_HOST_DATA_RDWR(YD_PCEROV)
      PCHROV => GET_HOST_DATA_RDWR(YD_PCHROV)
      PDPHIT => GET_HOST_DATA_RDWR(YD_PDPHIT)
      PDPHIV => GET_HOST_DATA_RDWR(YD_PDPHIV)
      PDSA_RS => GET_HOST_DATA_RDWR(YD_PDSA_RS)
      PFLU_CD => GET_HOST_DATA_RDWR(YD_PFLU_CD)
      PFLU_CDN => GET_HOST_DATA_RDWR(YD_PFLU_CDN)
      PFLU_CH => GET_HOST_DATA_RDWR(YD_PFLU_CH)
      PFLU_QSATS => GET_HOST_DATA_RDWR(YD_PFLU_QSATS)
      ZCE => GET_HOST_DATA_RDWR(YL_ZCE)
      ZCRTI => GET_HOST_DATA_RDWR(YL_ZCRTI)
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
      Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
      Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
      Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON, YLCPG_BNDS, YLSTACK )
      DO JBLK=YDCPG_OPTS%JBLKMIN,YDCPG_OPTS%JBLKMAX
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L8 = stack_l8(YSTACK, JBLK - YDCPG_OPTS%JBLKMIN + 1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U8 = stack_u8(YSTACK, JBLK - YDCPG_OPTS%JBLKMIN + 1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%L4 = stack_l4(YSTACK, JBLK - YDCPG_OPTS%JBLKMIN + 1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U4 = stack_u4(YSTACK, JBLK - YDCPG_OPTS%JBLKMIN + 1, YDCPG_OPTS%KGPBLKS)
          
          ZCRTI(JLON, JBLK) = 1.0_JPRB / (Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(JLON, JBLK)*PDSA_RS(JLON, JBLK))
          CALL ACFLUSO_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
          & YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), PDPHIT(:, JBLK), PDPHIV(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), PFLU_QSATS(:, JBLK), ZCRTI(:, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), LDHMT, PFLU_CD(:, JBLK), PFLU_CDN(:, JBLK), PCDROV(:, JBLK),  &
          & ZCE(:, JBLK), PCEROV(:, JBLK), PFLU_CH(:, JBLK), PCHROV(:, JBLK), Z_YDMF_PHYS_OUT_QCLS(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_RHCLS(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK), Z_YDMF_PHYS_OUT_UCLS(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_VCLS(:, JBLK), Z_YDMF_PHYS_OUT_UGST(:, JBLK), Z_YDMF_PHYS_OUT_VGST(:, JBLK), YDSTACK=YLSTACK)
          
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        PCDROV => GET_HOST_DATA_RDWR(YD_PCDROV)
        PCEROV => GET_HOST_DATA_RDWR(YD_PCEROV)
        PCHROV => GET_HOST_DATA_RDWR(YD_PCHROV)
        PDPHIT => GET_HOST_DATA_RDWR(YD_PDPHIT)
        PDPHIV => GET_HOST_DATA_RDWR(YD_PDPHIV)
        PDSA_RS => GET_HOST_DATA_RDWR(YD_PDSA_RS)
        PFLU_CD => GET_HOST_DATA_RDWR(YD_PFLU_CD)
        PFLU_CDN => GET_HOST_DATA_RDWR(YD_PFLU_CDN)
        PFLU_CH => GET_HOST_DATA_RDWR(YD_PFLU_CH)
        PFLU_QSATS => GET_HOST_DATA_RDWR(YD_PFLU_QSATS)
        ZCE => GET_HOST_DATA_RDWR(YL_ZCE)
        ZCRTI => GET_HOST_DATA_RDWR(YL_ZCRTI)
        Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
        Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
        Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
        Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
        Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
        Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
        Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
        Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      PCDROV => NULL()
      PCEROV => NULL()
      PCHROV => NULL()
      PDPHIT => NULL()
      PDPHIV => NULL()
      PDSA_RS => NULL()
      PFLU_CD => NULL()
      PFLU_CDN => NULL()
      PFLU_CH => NULL()
      PFLU_QSATS => NULL()
      ZCE => NULL()
      ZCRTI => NULL()
      Z_YDMF_PHYS_BASE_STATE_Q => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_OUT_GZ0 => NULL()
      Z_YDMF_PHYS_OUT_QCLS => NULL()
      Z_YDMF_PHYS_OUT_RHCLS => NULL()
      Z_YDMF_PHYS_OUT_TCLS => NULL()
      Z_YDMF_PHYS_OUT_UCLS => NULL()
      Z_YDMF_PHYS_OUT_UGST => NULL()
      Z_YDMF_PHYS_OUT_VCLS => NULL()
      Z_YDMF_PHYS_OUT_VGST => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    ELSE IF (LPARALLELMETHOD('OPENACCSINGLECOLUMN', 'APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      PCDROV => GET_DEVICE_DATA_RDWR(YD_PCDROV)
      PCEROV => GET_DEVICE_DATA_RDWR(YD_PCEROV)
      PCHROV => GET_DEVICE_DATA_RDWR(YD_PCHROV)
      PDPHIT => GET_DEVICE_DATA_RDWR(YD_PDPHIT)
      PDPHIV => GET_DEVICE_DATA_RDWR(YD_PDPHIV)
      PDSA_RS => GET_DEVICE_DATA_RDWR(YD_PDSA_RS)
      PFLU_CD => GET_DEVICE_DATA_RDWR(YD_PFLU_CD)
      PFLU_CDN => GET_DEVICE_DATA_RDWR(YD_PFLU_CDN)
      PFLU_CH => GET_DEVICE_DATA_RDWR(YD_PFLU_CH)
      PFLU_QSATS => GET_DEVICE_DATA_RDWR(YD_PFLU_QSATS)
      ZCE => GET_DEVICE_DATA_RDWR(YL_ZCE)
      ZCRTI => GET_DEVICE_DATA_RDWR(YL_ZCRTI)
      Z_YDMF_PHYS_BASE_STATE_Q => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
      Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_OUT_GZ0 => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
      Z_YDMF_PHYS_OUT_QCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
      Z_YDMF_PHYS_OUT_RHCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
      Z_YDMF_PHYS_OUT_TCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_OUT_UCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VCLS => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_VGST => GET_DEVICE_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_DEVICE_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
!$ACC PARALLEL LOOP GANG PRESENT( PCDROV, PCEROV, PCHROV, PDPHIT, PDPHIV, PDSA_RS, PFLU_CD, PFLU_CDN, PFLU_CH, PFLU_QSATS,  &
!$ACC & YDCPG_OPTS, YDMODEL, YSTACK, ZCE, ZCRTI, Z_YDMF_PHYS_BASE_STATE_Q, Z_YDMF_PHYS_BASE_STATE_T,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_U, Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD,  &
!$ACC & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_OUT_GZ0,  &
!$ACC & Z_YDMF_PHYS_OUT_QCLS, Z_YDMF_PHYS_OUT_RHCLS, Z_YDMF_PHYS_OUT_TCLS, Z_YDMF_PHYS_OUT_UCLS, Z_YDMF_PHYS_OUT_UGST,  &
!$ACC & Z_YDMF_PHYS_OUT_VCLS, Z_YDMF_PHYS_OUT_VGST, Z_YDMF_PHYS_SURF_GSD_VF_PLSM ) PRIVATE( JBLK ) VECTOR_LENGTH(  &
!$ACC & YDCPG_OPTS%KLON )
      DO JBLK=YDCPG_OPTS%JBLKMIN,YDCPG_OPTS%JBLKMAX
!$ACC LOOP VECTOR PRIVATE( JLON, YLCPG_BNDS, YLSTACK )
        DO JLON=1,MIN(YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1)*YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L8 = stack_l8(YSTACK, JBLK - YDCPG_OPTS%JBLKMIN + 1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U8 = stack_u8(YSTACK, JBLK - YDCPG_OPTS%JBLKMIN + 1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%L4 = stack_l4(YSTACK, JBLK - YDCPG_OPTS%JBLKMIN + 1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U4 = stack_u4(YSTACK, JBLK - YDCPG_OPTS%JBLKMIN + 1, YDCPG_OPTS%KGPBLKS)
          
          ZCRTI(JLON, JBLK) = 1.0_JPRB / (Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(JLON, JBLK)*PDSA_RS(JLON, JBLK))
          CALL ACFLUSO_OPENACC(YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,  &
          & YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_T(:, :, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:, :, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_V(:, :, JBLK), PDPHIT(:, JBLK), PDPHIV(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK),  &
          & Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), PFLU_QSATS(:, JBLK), ZCRTI(:, JBLK),  &
          & Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), LDHMT, PFLU_CD(:, JBLK), PFLU_CDN(:, JBLK), PCDROV(:, JBLK),  &
          & ZCE(:, JBLK), PCEROV(:, JBLK), PFLU_CH(:, JBLK), PCHROV(:, JBLK), Z_YDMF_PHYS_OUT_QCLS(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_RHCLS(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK), Z_YDMF_PHYS_OUT_UCLS(:, JBLK),  &
          & Z_YDMF_PHYS_OUT_VCLS(:, JBLK), Z_YDMF_PHYS_OUT_UGST(:, JBLK), Z_YDMF_PHYS_OUT_VGST(:, JBLK), YDSTACK=YLSTACK)
          
        END DO
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        PCDROV => GET_HOST_DATA_RDWR(YD_PCDROV)
        PCEROV => GET_HOST_DATA_RDWR(YD_PCEROV)
        PCHROV => GET_HOST_DATA_RDWR(YD_PCHROV)
        PDPHIT => GET_HOST_DATA_RDWR(YD_PDPHIT)
        PDPHIV => GET_HOST_DATA_RDWR(YD_PDPHIV)
        PDSA_RS => GET_HOST_DATA_RDWR(YD_PDSA_RS)
        PFLU_CD => GET_HOST_DATA_RDWR(YD_PFLU_CD)
        PFLU_CDN => GET_HOST_DATA_RDWR(YD_PFLU_CDN)
        PFLU_CH => GET_HOST_DATA_RDWR(YD_PFLU_CH)
        PFLU_QSATS => GET_HOST_DATA_RDWR(YD_PFLU_QSATS)
        ZCE => GET_HOST_DATA_RDWR(YL_ZCE)
        ZCRTI => GET_HOST_DATA_RDWR(YL_ZCRTI)
        Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_Q)
        Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_T)
        Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_U)
        Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%F_V)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
        Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR(YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
        Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_GZ0)
        Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_QCLS)
        Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_RHCLS)
        Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_TCLS)
        Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UCLS)
        Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_UGST)
        Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VCLS)
        Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR(YDMF_PHYS%OUT%F_VGST)
        Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR(YDMF_PHYS_SURF%GSD_VF%F_LSM)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      PCDROV => NULL()
      PCEROV => NULL()
      PCHROV => NULL()
      PDPHIT => NULL()
      PDPHIV => NULL()
      PDSA_RS => NULL()
      PFLU_CD => NULL()
      PFLU_CDN => NULL()
      PFLU_CH => NULL()
      PFLU_QSATS => NULL()
      ZCE => NULL()
      ZCRTI => NULL()
      Z_YDMF_PHYS_BASE_STATE_Q => NULL()
      Z_YDMF_PHYS_BASE_STATE_T => NULL()
      Z_YDMF_PHYS_BASE_STATE_U => NULL()
      Z_YDMF_PHYS_BASE_STATE_V => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL()
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL()
      Z_YDMF_PHYS_OUT_GZ0 => NULL()
      Z_YDMF_PHYS_OUT_QCLS => NULL()
      Z_YDMF_PHYS_OUT_RHCLS => NULL()
      Z_YDMF_PHYS_OUT_TCLS => NULL()
      Z_YDMF_PHYS_OUT_UCLS => NULL()
      Z_YDMF_PHYS_OUT_UGST => NULL()
      Z_YDMF_PHYS_OUT_VCLS => NULL()
      Z_YDMF_PHYS_OUT_VGST => NULL()
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:ACFLUSO', 1, ZHOOK_HANDLE_PARALLEL)
    
  ELSE
    
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:0', 0, ZHOOK_HANDLE_PARALLEL)
    IF (LPARALLELMETHOD('OPENMP', 'APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:0')) THEN
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:0:GET_DATA', 0, ZHOOK_HANDLE_FIELD_API)
      PCEROV => GET_HOST_DATA_RDWR(YD_PCEROV)
      PCHROV => GET_HOST_DATA_RDWR(YD_PCHROV)
      PFLU_CH => GET_HOST_DATA_RDWR(YD_PFLU_CH)
      ZCE => GET_HOST_DATA_RDWR(YL_ZCE)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:0:GET_DATA', 1, ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:0:COMPUTE', 0, ZHOOK_HANDLE_COMPUTE)
      CALL YLCPG_BNDS%INIT(YDCPG_OPTS)
!$OMP PARALLEL DO PRIVATE( JBLK, JLON ) FIRSTPRIVATE( YLCPG_BNDS )
      DO JBLK=YDCPG_OPTS%JBLKMIN,YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE(JBLK)
        
        DO JLON=YLCPG_BNDS%KIDIA,YLCPG_BNDS%KFDIA
          ZCE(JLON, JBLK) = PFLU_CH(JLON, JBLK)
          PCEROV(JLON, JBLK) = PCHROV(JLON, JBLK)
        END DO
        
      END DO
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:0:COMPUTE', 1, ZHOOK_HANDLE_COMPUTE)
      IF (LSYNCHOST('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:0')) THEN
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:0:SYNCHOST', 0, ZHOOK_HANDLE_FIELD_API)
        PCEROV => GET_HOST_DATA_RDWR(YD_PCEROV)
        PCHROV => GET_HOST_DATA_RDWR(YD_PCHROV)
        PFLU_CH => GET_HOST_DATA_RDWR(YD_PFLU_CH)
        ZCE => GET_HOST_DATA_RDWR(YL_ZCE)
        IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:0:SYNCHOST', 1, ZHOOK_HANDLE_FIELD_API)
      END IF
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:0:NULLIFY', 0, ZHOOK_HANDLE_FIELD_API)
      PCEROV => NULL()
      PCHROV => NULL()
      PFLU_CH => NULL()
      ZCE => NULL()
      IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:0:NULLIFY', 1, ZHOOK_HANDLE_FIELD_API)
    END IF
    IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES_PARALLEL:0', 1, ZHOOK_HANDLE_PARALLEL)
    
  END IF
  
  
  IF (LHOOK) CALL DR_HOOK('DELETE_TEMPORARIES', 0, ZHOOK_HANDLE_FIELD_API)
  
  IF (ASSOCIATED(YL_ZCE)) CALL FIELD_DELETE(YL_ZCE)
  IF (ASSOCIATED(YL_ZCRTI)) CALL FIELD_DELETE(YL_ZCRTI)
  IF (LHOOK) CALL DR_HOOK('DELETE_TEMPORARIES', 1, ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK('APL_ARPEGE_OCEANIC_FLUXES', 1, ZHOOK_HANDLE)
  
END SUBROUTINE APL_ARPEGE_OCEANIC_FLUXES_PARALLEL
